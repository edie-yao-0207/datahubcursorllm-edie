[
  {
    "Name": "linear-pipeline",
    "Values": [
      [
        "{",
        "  'StartAt': 'parallel_sf_wrapper',",
        "  'States': {",
        "    'parallel_sf_wrapper': {",
        "      'Type': 'Parallel',",
        "      'End': true,",
        "      'Branches': [",
        "        {",
        "          'StartAt': 'node4_0_dependencies',",
        "          'States': {",
        "            'node4_0': {",
        "              'Type': 'Task',",
        "              'Next': 'node4_0-metrics_logger',",
        "              'Parameters': {",
        "                'Input': {",
        "                  'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                  'backfill_start_date': '',",
        "                  'children': [],",
        "                  'databricks_owner_group': 'data-platform-group',",
        "                  'end_date.$': '$.end_date',",
        "                  'execution_id.$': '$.execution_id',",
        "                  'geospark': false,",
        "                  'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node4\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                  'node_id': 'node4',",
        "                  'parents': [",
        "                    'node3'",
        "                  ],",
        "                  'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                  'product_group': 'AIAndData',",
        "                  's3_expectation_path': '',",
        "                  's3_json_metadata_path': '',",
        "                  's3_sql_path': '',",
        "                  'start_date.$': '$.start_date',",
        "                  'team': 'dataplatform',",
        "                  'transformation_name': 'node4'",
        "                },",
        "                'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node4'",
        "              },",
        "              'Catch': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'States.ALL'",
        "                  ],",
        "                  'Next': 'node4_0-FAILED_metrics_logger',",
        "                  'ResultPath': '$.error'",
        "                }",
        "              ],",
        "              'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'StepFunctions.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0-FAILED': {",
        "              'Type': 'Fail',",
        "              'Comment': 'node4_0 failed'",
        "            },",
        "            'node4_0-FAILED_metrics_logger': {",
        "              'Type': 'Task',",
        "              'Comment': 'Log result of transformation to datadog',",
        "              'Next': 'node4_0-FAILED',",
        "              'Parameters': {",
        "                'FunctionName': 'metrics_logger',",
        "                'InvocationType': 'Event',",
        "                'Payload': {",
        "                  'Output.$': '$.error.Cause'",
        "                }",
        "              },",
        "              'ResultPath': null,",
        "              'Resource': 'arn:aws:states:::lambda:invoke',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'Lambda.Unknown',",
        "                    'Lambda.ServiceException',",
        "                    'Lambda.AWSLambdaException',",
        "                    'Lambda.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                },",
        "                {",
        "                  'ErrorEquals': [",
        "                    'TransientFailureException'",
        "                  ],",
        "                  'IntervalSeconds': 60,",
        "                  'MaxAttempts': 4,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0-metrics_logger': {",
        "              'Type': 'Task',",
        "              'Comment': 'Log result of transformation to datadog',",
        "              'End': true,",
        "              'Parameters': {",
        "                'FunctionName': 'metrics_logger',",
        "                'InvocationType': 'Event',",
        "                'Payload': {",
        "                  'Output.$': '$.Output'",
        "                }",
        "              },",
        "              'Resource': 'arn:aws:states:::lambda:invoke',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'Lambda.Unknown',",
        "                    'Lambda.ServiceException',",
        "                    'Lambda.AWSLambdaException',",
        "                    'Lambda.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                },",
        "                {",
        "                  'ErrorEquals': [",
        "                    'TransientFailureException'",
        "                  ],",
        "                  'IntervalSeconds': 60,",
        "                  'MaxAttempts': 4,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0_dependencies': {",
        "              'Type': 'Parallel',",
        "              'Comment': 'node4_0 dependencies',",
        "              'Next': 'node4_0',",
        "              'Branches': [",
        "                {",
        "                  'StartAt': 'RunBranches_node4_0_dependencies',",
        "                  'States': {",
        "                    'CheckFailures_node4_0_dependencies': {",
        "                      'Type': 'Choice',",
        "                      'Choices': [",
        "                        {",
        "                          'Variable': '$.Errors[0]',",
        "                          'Next': 'Failed_node4_0_dependencies',",
        "                          'IsPresent': true",
        "                        }",
        "                      ],",
        "                      'Default': 'Success_node4_0_dependencies'",
        "                    },",
        "                    'Failed_node4_0_dependencies': {",
        "                      'Type': 'Fail'",
        "                    },",
        "                    'ProcessBranchOutput_node4_0_dependencies': {",
        "                      'Type': 'Pass',",
        "                      'Next': 'CheckFailures_node4_0_dependencies',",
        "                      'Parameters': {",
        "                        'Errors.$': '$.Errors.*.Error'",
        "                      }",
        "                    },",
        "                    'RunBranches_node4_0_dependencies': {",
        "                      'Type': 'Parallel',",
        "                      'Next': 'ProcessBranchOutput_node4_0_dependencies',",
        "                      'Branches': [",
        "                        {",
        "                          'StartAt': 'CatchWrapper_node4_0_dependencies_0',",
        "                          'States': {",
        "                            'CatchWrapper_node4_0_dependencies_0': {",
        "                              'Type': 'Parallel',",
        "                              'End': true,",
        "                              'Catch': [",
        "                                {",
        "                                  'ErrorEquals': [",
        "                                    'States.ALL'",
        "                                  ],",
        "                                  'Next': 'HasError_node4_0_dependencies_0'",
        "                                }",
        "                              ],",
        "                              'Branches': [",
        "                                {",
        "                                  'StartAt': 'node3_0_dependencies',",
        "                                  'States': {",
        "                                    'node3_0': {",
        "                                      'Type': 'Task',",
        "                                      'Next': 'node3_0-metrics_logger',",
        "                                      'Parameters': {",
        "                                        'Input': {",
        "                                          'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                          'backfill_start_date': '',",
        "                                          'children': [",
        "                                            'node4'",
        "                                          ],",
        "                                          'databricks_owner_group': 'data-platform-group',",
        "                                          'end_date.$': '$.end_date',",
        "                                          'execution_id.$': '$.execution_id',",
        "                                          'geospark': false,",
        "                                          'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node3\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                          'node_id': 'node3',",
        "                                          'parents': [",
        "                                            'node2'",
        "                                          ],",
        "                                          'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                          'product_group': 'AIAndData',",
        "                                          's3_expectation_path': '',",
        "                                          's3_json_metadata_path': '',",
        "                                          's3_sql_path': '',",
        "                                          'start_date.$': '$.start_date',",
        "                                          'team': 'dataplatform',",
        "                                          'transformation_name': 'node3'",
        "                                        },",
        "                                        'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node3'",
        "                                      },",
        "                                      'Catch': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'States.ALL'",
        "                                          ],",
        "                                          'Next': 'node3_0-FAILED_metrics_logger',",
        "                                          'ResultPath': '$.error'",
        "                                        }",
        "                                      ],",
        "                                      'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'StepFunctions.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0-FAILED': {",
        "                                      'Type': 'Fail',",
        "                                      'Comment': 'node3_0 failed'",
        "                                    },",
        "                                    'node3_0-FAILED_metrics_logger': {",
        "                                      'Type': 'Task',",
        "                                      'Comment': 'Log result of transformation to datadog',",
        "                                      'Next': 'node3_0-FAILED',",
        "                                      'Parameters': {",
        "                                        'FunctionName': 'metrics_logger',",
        "                                        'InvocationType': 'Event',",
        "                                        'Payload': {",
        "                                          'Output.$': '$.error.Cause'",
        "                                        }",
        "                                      },",
        "                                      'ResultPath': null,",
        "                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'Lambda.Unknown',",
        "                                            'Lambda.ServiceException',",
        "                                            'Lambda.AWSLambdaException',",
        "                                            'Lambda.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        },",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'TransientFailureException'",
        "                                          ],",
        "                                          'IntervalSeconds': 60,",
        "                                          'MaxAttempts': 4,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0-metrics_logger': {",
        "                                      'Type': 'Task',",
        "                                      'Comment': 'Log result of transformation to datadog',",
        "                                      'End': true,",
        "                                      'Parameters': {",
        "                                        'FunctionName': 'metrics_logger',",
        "                                        'InvocationType': 'Event',",
        "                                        'Payload': {",
        "                                          'Output.$': '$.Output'",
        "                                        }",
        "                                      },",
        "                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'Lambda.Unknown',",
        "                                            'Lambda.ServiceException',",
        "                                            'Lambda.AWSLambdaException',",
        "                                            'Lambda.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        },",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'TransientFailureException'",
        "                                          ],",
        "                                          'IntervalSeconds': 60,",
        "                                          'MaxAttempts': 4,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0_dependencies': {",
        "                                      'Type': 'Parallel',",
        "                                      'Comment': 'node3_0 dependencies',",
        "                                      'Next': 'node3_0',",
        "                                      'Branches': [",
        "                                        {",
        "                                          'StartAt': 'RunBranches_node3_0_dependencies',",
        "                                          'States': {",
        "                                            'CheckFailures_node3_0_dependencies': {",
        "                                              'Type': 'Choice',",
        "                                              'Choices': [",
        "                                                {",
        "                                                  'Variable': '$.Errors[0]',",
        "                                                  'Next': 'Failed_node3_0_dependencies',",
        "                                                  'IsPresent': true",
        "                                                }",
        "                                              ],",
        "                                              'Default': 'Success_node3_0_dependencies'",
        "                                            },",
        "                                            'Failed_node3_0_dependencies': {",
        "                                              'Type': 'Fail'",
        "                                            },",
        "                                            'ProcessBranchOutput_node3_0_dependencies': {",
        "                                              'Type': 'Pass',",
        "                                              'Next': 'CheckFailures_node3_0_dependencies',",
        "                                              'Parameters': {",
        "                                                'Errors.$': '$.Errors.*.Error'",
        "                                              }",
        "                                            },",
        "                                            'RunBranches_node3_0_dependencies': {",
        "                                              'Type': 'Parallel',",
        "                                              'Next': 'ProcessBranchOutput_node3_0_dependencies',",
        "                                              'Branches': [",
        "                                                {",
        "                                                  'StartAt': 'CatchWrapper_node3_0_dependencies_0',",
        "                                                  'States': {",
        "                                                    'CatchWrapper_node3_0_dependencies_0': {",
        "                                                      'Type': 'Parallel',",
        "                                                      'End': true,",
        "                                                      'Catch': [",
        "                                                        {",
        "                                                          'ErrorEquals': [",
        "                                                            'States.ALL'",
        "                                                          ],",
        "                                                          'Next': 'HasError_node3_0_dependencies_0'",
        "                                                        }",
        "                                                      ],",
        "                                                      'Branches': [",
        "                                                        {",
        "                                                          'StartAt': 'node2_0_dependencies',",
        "                                                          'States': {",
        "                                                            'node2_0': {",
        "                                                              'Type': 'Task',",
        "                                                              'Next': 'node2_0-metrics_logger',",
        "                                                              'Parameters': {",
        "                                                                'Input': {",
        "                                                                  'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                                                  'backfill_start_date': '',",
        "                                                                  'children': [",
        "                                                                    'node3'",
        "                                                                  ],",
        "                                                                  'databricks_owner_group': 'data-platform-group',",
        "                                                                  'end_date.$': '$.end_date',",
        "                                                                  'execution_id.$': '$.execution_id',",
        "                                                                  'geospark': false,",
        "                                                                  'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node2\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                                                  'node_id': 'node2',",
        "                                                                  'parents': [",
        "                                                                    'node1'",
        "                                                                  ],",
        "                                                                  'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                                                  'product_group': 'AIAndData',",
        "                                                                  's3_expectation_path': '',",
        "                                                                  's3_json_metadata_path': '',",
        "                                                                  's3_sql_path': '',",
        "                                                                  'start_date.$': '$.start_date',",
        "                                                                  'team': 'dataplatform',",
        "                                                                  'transformation_name': 'node2'",
        "                                                                },",
        "                                                                'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node2'",
        "                                                              },",
        "                                                              'Catch': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'States.ALL'",
        "                                                                  ],",
        "                                                                  'Next': 'node2_0-FAILED_metrics_logger',",
        "                                                                  'ResultPath': '$.error'",
        "                                                                }",
        "                                                              ],",
        "                                                              'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'StepFunctions.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node2_0-FAILED': {",
        "                                                              'Type': 'Fail',",
        "                                                              'Comment': 'node2_0 failed'",
        "                                                            },",
        "                                                            'node2_0-FAILED_metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'Next': 'node2_0-FAILED',",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.error.Cause'",
        "                                                                }",
        "                                                              },",
        "                                                              'ResultPath': null,",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node2_0-metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'End': true,",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.Output'",
        "                                                                }",
        "                                                              },",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node2_0_dependencies': {",
        "                                                              'Type': 'Parallel',",
        "                                                              'Comment': 'node2_0 dependencies',",
        "                                                              'Next': 'node2_0',",
        "                                                              'Branches': [",
        "                                                                {",
        "                                                                  'StartAt': 'RunBranches_node2_0_dependencies',",
        "                                                                  'States': {",
        "                                                                    'CheckFailures_node2_0_dependencies': {",
        "                                                                      'Type': 'Choice',",
        "                                                                      'Choices': [",
        "                                                                        {",
        "                                                                          'Variable': '$.Errors[0]',",
        "                                                                          'Next': 'Failed_node2_0_dependencies',",
        "                                                                          'IsPresent': true",
        "                                                                        }",
        "                                                                      ],",
        "                                                                      'Default': 'Success_node2_0_dependencies'",
        "                                                                    },",
        "                                                                    'Failed_node2_0_dependencies': {",
        "                                                                      'Type': 'Fail'",
        "                                                                    },",
        "                                                                    'ProcessBranchOutput_node2_0_dependencies': {",
        "                                                                      'Type': 'Pass',",
        "                                                                      'Next': 'CheckFailures_node2_0_dependencies',",
        "                                                                      'Parameters': {",
        "                                                                        'Errors.$': '$.Errors.*.Error'",
        "                                                                      }",
        "                                                                    },",
        "                                                                    'RunBranches_node2_0_dependencies': {",
        "                                                                      'Type': 'Parallel',",
        "                                                                      'Next': 'ProcessBranchOutput_node2_0_dependencies',",
        "                                                                      'Branches': [",
        "                                                                        {",
        "                                                                          'StartAt': 'CatchWrapper_node2_0_dependencies_0',",
        "                                                                          'States': {",
        "                                                                            'CatchWrapper_node2_0_dependencies_0': {",
        "                                                                              'Type': 'Parallel',",
        "                                                                              'End': true,",
        "                                                                              'Catch': [",
        "                                                                                {",
        "                                                                                  'ErrorEquals': [",
        "                                                                                    'States.ALL'",
        "                                                                                  ],",
        "                                                                                  'Next': 'HasError_node2_0_dependencies_0'",
        "                                                                                }",
        "                                                                              ],",
        "                                                                              'Branches': [",
        "                                                                                {",
        "                                                                                  'StartAt': 'node1_0',",
        "                                                                                  'States': {",
        "                                                                                    'node1_0': {",
        "                                                                                      'Type': 'Task',",
        "                                                                                      'Next': 'node1_0-metrics_logger',",
        "                                                                                      'Parameters': {",
        "                                                                                        'Input': {",
        "                                                                                          'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                                                                          'backfill_start_date': '',",
        "                                                                                          'children': [",
        "                                                                                            'node2'",
        "                                                                                          ],",
        "                                                                                          'databricks_owner_group': 'data-platform-group',",
        "                                                                                          'end_date.$': '$.end_date',",
        "                                                                                          'execution_id.$': '$.execution_id',",
        "                                                                                          'geospark': false,",
        "                                                                                          'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node1\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                                                                          'node_id': 'node1',",
        "                                                                                          'parents': [],",
        "                                                                                          'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                                                                          'product_group': 'AIAndData',",
        "                                                                                          's3_expectation_path': '',",
        "                                                                                          's3_json_metadata_path': '',",
        "                                                                                          's3_sql_path': '',",
        "                                                                                          'start_date.$': '$.start_date',",
        "                                                                                          'team': 'dataplatform',",
        "                                                                                          'transformation_name': 'node1'",
        "                                                                                        },",
        "                                                                                        'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node1'",
        "                                                                                      },",
        "                                                                                      'Catch': [",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'States.ALL'",
        "                                                                                          ],",
        "                                                                                          'Next': 'node1_0-FAILED_metrics_logger',",
        "                                                                                          'ResultPath': '$.error'",
        "                                                                                        }",
        "                                                                                      ],",
        "                                                                                      'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                                                                      'Retry': [",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'StepFunctions.SdkClientException'",
        "                                                                                          ],",
        "                                                                                          'IntervalSeconds': 2,",
        "                                                                                          'MaxAttempts': 2,",
        "                                                                                          'BackoffRate': 2",
        "                                                                                        }",
        "                                                                                      ]",
        "                                                                                    },",
        "                                                                                    'node1_0-FAILED': {",
        "                                                                                      'Type': 'Fail',",
        "                                                                                      'Comment': 'node1_0 failed'",
        "                                                                                    },",
        "                                                                                    'node1_0-FAILED_metrics_logger': {",
        "                                                                                      'Type': 'Task',",
        "                                                                                      'Comment': 'Log result of transformation to datadog',",
        "                                                                                      'Next': 'node1_0-FAILED',",
        "                                                                                      'Parameters': {",
        "                                                                                        'FunctionName': 'metrics_logger',",
        "                                                                                        'InvocationType': 'Event',",
        "                                                                                        'Payload': {",
        "                                                                                          'Output.$': '$.error.Cause'",
        "                                                                                        }",
        "                                                                                      },",
        "                                                                                      'ResultPath': null,",
        "                                                                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                                                      'Retry': [",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'Lambda.Unknown',",
        "                                                                                            'Lambda.ServiceException',",
        "                                                                                            'Lambda.AWSLambdaException',",
        "                                                                                            'Lambda.SdkClientException'",
        "                                                                                          ],",
        "                                                                                          'IntervalSeconds': 2,",
        "                                                                                          'MaxAttempts': 2,",
        "                                                                                          'BackoffRate': 2",
        "                                                                                        },",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'TransientFailureException'",
        "                                                                                          ],",
        "                                                                                          'IntervalSeconds': 60,",
        "                                                                                          'MaxAttempts': 4,",
        "                                                                                          'BackoffRate': 2",
        "                                                                                        }",
        "                                                                                      ]",
        "                                                                                    },",
        "                                                                                    'node1_0-metrics_logger': {",
        "                                                                                      'Type': 'Task',",
        "                                                                                      'Comment': 'Log result of transformation to datadog',",
        "                                                                                      'End': true,",
        "                                                                                      'Parameters': {",
        "                                                                                        'FunctionName': 'metrics_logger',",
        "                                                                                        'InvocationType': 'Event',",
        "                                                                                        'Payload': {",
        "                                                                                          'Output.$': '$.Output'",
        "                                                                                        }",
        "                                                                                      },",
        "                                                                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                                                      'Retry': [",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'Lambda.Unknown',",
        "                                                                                            'Lambda.ServiceException',",
        "                                                                                            'Lambda.AWSLambdaException',",
        "                                                                                            'Lambda.SdkClientException'",
        "                                                                                          ],",
        "                                                                                          'IntervalSeconds': 2,",
        "                                                                                          'MaxAttempts': 2,",
        "                                                                                          'BackoffRate': 2",
        "                                                                                        },",
        "                                                                                        {",
        "                                                                                          'ErrorEquals': [",
        "                                                                                            'TransientFailureException'",
        "                                                                                          ],",
        "                                                                                          'IntervalSeconds': 60,",
        "                                                                                          'MaxAttempts': 4,",
        "                                                                                          'BackoffRate': 2",
        "                                                                                        }",
        "                                                                                      ]",
        "                                                                                    }",
        "                                                                                  }",
        "                                                                                }",
        "                                                                              ],",
        "                                                                              'ResultPath': null",
        "                                                                            },",
        "                                                                            'HasError_node2_0_dependencies_0': {",
        "                                                                              'Type': 'Pass',",
        "                                                                              'End': true,",
        "                                                                              'ResultPath': '$.Error',",
        "                                                                              'Result': 'node1_0'",
        "                                                                            }",
        "                                                                          }",
        "                                                                        }",
        "                                                                      ],",
        "                                                                      'ResultPath': '$.Errors'",
        "                                                                    },",
        "                                                                    'Success_node2_0_dependencies': {",
        "                                                                      'Type': 'Succeed'",
        "                                                                    }",
        "                                                                  }",
        "                                                                }",
        "                                                              ],",
        "                                                              'ResultPath': null",
        "                                                            }",
        "                                                          }",
        "                                                        }",
        "                                                      ],",
        "                                                      'ResultPath': null",
        "                                                    },",
        "                                                    'HasError_node3_0_dependencies_0': {",
        "                                                      'Type': 'Pass',",
        "                                                      'End': true,",
        "                                                      'ResultPath': '$.Error',",
        "                                                      'Result': 'node2_0_dependencies'",
        "                                                    }",
        "                                                  }",
        "                                                }",
        "                                              ],",
        "                                              'ResultPath': '$.Errors'",
        "                                            },",
        "                                            'Success_node3_0_dependencies': {",
        "                                              'Type': 'Succeed'",
        "                                            }",
        "                                          }",
        "                                        }",
        "                                      ],",
        "                                      'ResultPath': null",
        "                                    }",
        "                                  }",
        "                                }",
        "                              ],",
        "                              'ResultPath': null",
        "                            },",
        "                            'HasError_node4_0_dependencies_0': {",
        "                              'Type': 'Pass',",
        "                              'End': true,",
        "                              'ResultPath': '$.Error',",
        "                              'Result': 'node3_0_dependencies'",
        "                            }",
        "                          }",
        "                        }",
        "                      ],",
        "                      'ResultPath': '$.Errors'",
        "                    },",
        "                    'Success_node4_0_dependencies': {",
        "                      'Type': 'Succeed'",
        "                    }",
        "                  }",
        "                }",
        "              ],",
        "              'ResultPath': null",
        "            }",
        "          }",
        "        }",
        "      ],",
        "      'ResultPath': null",
        "    }",
        "  }",
        "}"
      ]
    ]
  },
  {
    "Name": "parallel-pipeline",
    "Values": [
      [
        "{",
        "  'StartAt': 'parallel_sf_wrapper',",
        "  'States': {",
        "    'parallel_sf_wrapper': {",
        "      'Type': 'Parallel',",
        "      'End': true,",
        "      'Branches': [",
        "        {",
        "          'StartAt': 'node4_0_dependencies',",
        "          'States': {",
        "            'node4_0': {",
        "              'Type': 'Task',",
        "              'Next': 'node4_0-metrics_logger',",
        "              'Parameters': {",
        "                'Input': {",
        "                  'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                  'backfill_start_date': '',",
        "                  'children': [],",
        "                  'databricks_owner_group': 'data-platform-group',",
        "                  'end_date.$': '$.end_date',",
        "                  'execution_id.$': '$.execution_id',",
        "                  'geospark': false,",
        "                  'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node4\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                  'node_id': 'node4',",
        "                  'parents': [",
        "                    'node3'",
        "                  ],",
        "                  'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                  'product_group': 'AIAndData',",
        "                  's3_expectation_path': '',",
        "                  's3_json_metadata_path': '',",
        "                  's3_sql_path': '',",
        "                  'start_date.$': '$.start_date',",
        "                  'team': 'dataplatform',",
        "                  'transformation_name': 'node4'",
        "                },",
        "                'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node4'",
        "              },",
        "              'Catch': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'States.ALL'",
        "                  ],",
        "                  'Next': 'node4_0-FAILED_metrics_logger',",
        "                  'ResultPath': '$.error'",
        "                }",
        "              ],",
        "              'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'StepFunctions.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0-FAILED': {",
        "              'Type': 'Fail',",
        "              'Comment': 'node4_0 failed'",
        "            },",
        "            'node4_0-FAILED_metrics_logger': {",
        "              'Type': 'Task',",
        "              'Comment': 'Log result of transformation to datadog',",
        "              'Next': 'node4_0-FAILED',",
        "              'Parameters': {",
        "                'FunctionName': 'metrics_logger',",
        "                'InvocationType': 'Event',",
        "                'Payload': {",
        "                  'Output.$': '$.error.Cause'",
        "                }",
        "              },",
        "              'ResultPath': null,",
        "              'Resource': 'arn:aws:states:::lambda:invoke',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'Lambda.Unknown',",
        "                    'Lambda.ServiceException',",
        "                    'Lambda.AWSLambdaException',",
        "                    'Lambda.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                },",
        "                {",
        "                  'ErrorEquals': [",
        "                    'TransientFailureException'",
        "                  ],",
        "                  'IntervalSeconds': 60,",
        "                  'MaxAttempts': 4,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0-metrics_logger': {",
        "              'Type': 'Task',",
        "              'Comment': 'Log result of transformation to datadog',",
        "              'End': true,",
        "              'Parameters': {",
        "                'FunctionName': 'metrics_logger',",
        "                'InvocationType': 'Event',",
        "                'Payload': {",
        "                  'Output.$': '$.Output'",
        "                }",
        "              },",
        "              'Resource': 'arn:aws:states:::lambda:invoke',",
        "              'Retry': [",
        "                {",
        "                  'ErrorEquals': [",
        "                    'Lambda.Unknown',",
        "                    'Lambda.ServiceException',",
        "                    'Lambda.AWSLambdaException',",
        "                    'Lambda.SdkClientException'",
        "                  ],",
        "                  'IntervalSeconds': 2,",
        "                  'MaxAttempts': 2,",
        "                  'BackoffRate': 2",
        "                },",
        "                {",
        "                  'ErrorEquals': [",
        "                    'TransientFailureException'",
        "                  ],",
        "                  'IntervalSeconds': 60,",
        "                  'MaxAttempts': 4,",
        "                  'BackoffRate': 2",
        "                }",
        "              ]",
        "            },",
        "            'node4_0_dependencies': {",
        "              'Type': 'Parallel',",
        "              'Comment': 'node4_0 dependencies',",
        "              'Next': 'node4_0',",
        "              'Branches': [",
        "                {",
        "                  'StartAt': 'RunBranches_node4_0_dependencies',",
        "                  'States': {",
        "                    'CheckFailures_node4_0_dependencies': {",
        "                      'Type': 'Choice',",
        "                      'Choices': [",
        "                        {",
        "                          'Variable': '$.Errors[0]',",
        "                          'Next': 'Failed_node4_0_dependencies',",
        "                          'IsPresent': true",
        "                        }",
        "                      ],",
        "                      'Default': 'Success_node4_0_dependencies'",
        "                    },",
        "                    'Failed_node4_0_dependencies': {",
        "                      'Type': 'Fail'",
        "                    },",
        "                    'ProcessBranchOutput_node4_0_dependencies': {",
        "                      'Type': 'Pass',",
        "                      'Next': 'CheckFailures_node4_0_dependencies',",
        "                      'Parameters': {",
        "                        'Errors.$': '$.Errors.*.Error'",
        "                      }",
        "                    },",
        "                    'RunBranches_node4_0_dependencies': {",
        "                      'Type': 'Parallel',",
        "                      'Next': 'ProcessBranchOutput_node4_0_dependencies',",
        "                      'Branches': [",
        "                        {",
        "                          'StartAt': 'CatchWrapper_node4_0_dependencies_0',",
        "                          'States': {",
        "                            'CatchWrapper_node4_0_dependencies_0': {",
        "                              'Type': 'Parallel',",
        "                              'End': true,",
        "                              'Catch': [",
        "                                {",
        "                                  'ErrorEquals': [",
        "                                    'States.ALL'",
        "                                  ],",
        "                                  'Next': 'HasError_node4_0_dependencies_0'",
        "                                }",
        "                              ],",
        "                              'Branches': [",
        "                                {",
        "                                  'StartAt': 'node3_0_dependencies',",
        "                                  'States': {",
        "                                    'node3_0': {",
        "                                      'Type': 'Task',",
        "                                      'Next': 'node3_0-metrics_logger',",
        "                                      'Parameters': {",
        "                                        'Input': {",
        "                                          'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                          'backfill_start_date': '',",
        "                                          'children': [",
        "                                            'node4'",
        "                                          ],",
        "                                          'databricks_owner_group': 'data-platform-group',",
        "                                          'end_date.$': '$.end_date',",
        "                                          'execution_id.$': '$.execution_id',",
        "                                          'geospark': false,",
        "                                          'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node3\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                          'node_id': 'node3',",
        "                                          'parents': [",
        "                                            'node1',",
        "                                            'node2'",
        "                                          ],",
        "                                          'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                          'product_group': 'AIAndData',",
        "                                          's3_expectation_path': '',",
        "                                          's3_json_metadata_path': '',",
        "                                          's3_sql_path': '',",
        "                                          'start_date.$': '$.start_date',",
        "                                          'team': 'dataplatform',",
        "                                          'transformation_name': 'node3'",
        "                                        },",
        "                                        'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node3'",
        "                                      },",
        "                                      'Catch': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'States.ALL'",
        "                                          ],",
        "                                          'Next': 'node3_0-FAILED_metrics_logger',",
        "                                          'ResultPath': '$.error'",
        "                                        }",
        "                                      ],",
        "                                      'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'StepFunctions.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0-FAILED': {",
        "                                      'Type': 'Fail',",
        "                                      'Comment': 'node3_0 failed'",
        "                                    },",
        "                                    'node3_0-FAILED_metrics_logger': {",
        "                                      'Type': 'Task',",
        "                                      'Comment': 'Log result of transformation to datadog',",
        "                                      'Next': 'node3_0-FAILED',",
        "                                      'Parameters': {",
        "                                        'FunctionName': 'metrics_logger',",
        "                                        'InvocationType': 'Event',",
        "                                        'Payload': {",
        "                                          'Output.$': '$.error.Cause'",
        "                                        }",
        "                                      },",
        "                                      'ResultPath': null,",
        "                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'Lambda.Unknown',",
        "                                            'Lambda.ServiceException',",
        "                                            'Lambda.AWSLambdaException',",
        "                                            'Lambda.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        },",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'TransientFailureException'",
        "                                          ],",
        "                                          'IntervalSeconds': 60,",
        "                                          'MaxAttempts': 4,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0-metrics_logger': {",
        "                                      'Type': 'Task',",
        "                                      'Comment': 'Log result of transformation to datadog',",
        "                                      'End': true,",
        "                                      'Parameters': {",
        "                                        'FunctionName': 'metrics_logger',",
        "                                        'InvocationType': 'Event',",
        "                                        'Payload': {",
        "                                          'Output.$': '$.Output'",
        "                                        }",
        "                                      },",
        "                                      'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                      'Retry': [",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'Lambda.Unknown',",
        "                                            'Lambda.ServiceException',",
        "                                            'Lambda.AWSLambdaException',",
        "                                            'Lambda.SdkClientException'",
        "                                          ],",
        "                                          'IntervalSeconds': 2,",
        "                                          'MaxAttempts': 2,",
        "                                          'BackoffRate': 2",
        "                                        },",
        "                                        {",
        "                                          'ErrorEquals': [",
        "                                            'TransientFailureException'",
        "                                          ],",
        "                                          'IntervalSeconds': 60,",
        "                                          'MaxAttempts': 4,",
        "                                          'BackoffRate': 2",
        "                                        }",
        "                                      ]",
        "                                    },",
        "                                    'node3_0_dependencies': {",
        "                                      'Type': 'Parallel',",
        "                                      'Comment': 'node3_0 dependencies',",
        "                                      'Next': 'node3_0',",
        "                                      'Branches': [",
        "                                        {",
        "                                          'StartAt': 'RunBranches_node3_0_dependencies',",
        "                                          'States': {",
        "                                            'CheckFailures_node3_0_dependencies': {",
        "                                              'Type': 'Choice',",
        "                                              'Choices': [",
        "                                                {",
        "                                                  'Variable': '$.Errors[0]',",
        "                                                  'Next': 'Failed_node3_0_dependencies',",
        "                                                  'IsPresent': true",
        "                                                }",
        "                                              ],",
        "                                              'Default': 'Success_node3_0_dependencies'",
        "                                            },",
        "                                            'Failed_node3_0_dependencies': {",
        "                                              'Type': 'Fail'",
        "                                            },",
        "                                            'ProcessBranchOutput_node3_0_dependencies': {",
        "                                              'Type': 'Pass',",
        "                                              'Next': 'CheckFailures_node3_0_dependencies',",
        "                                              'Parameters': {",
        "                                                'Errors.$': '$.Errors.*.Error'",
        "                                              }",
        "                                            },",
        "                                            'RunBranches_node3_0_dependencies': {",
        "                                              'Type': 'Parallel',",
        "                                              'Next': 'ProcessBranchOutput_node3_0_dependencies',",
        "                                              'Branches': [",
        "                                                {",
        "                                                  'StartAt': 'CatchWrapper_node3_0_dependencies_0',",
        "                                                  'States': {",
        "                                                    'CatchWrapper_node3_0_dependencies_0': {",
        "                                                      'Type': 'Parallel',",
        "                                                      'End': true,",
        "                                                      'Catch': [",
        "                                                        {",
        "                                                          'ErrorEquals': [",
        "                                                            'States.ALL'",
        "                                                          ],",
        "                                                          'Next': 'HasError_node3_0_dependencies_0'",
        "                                                        }",
        "                                                      ],",
        "                                                      'Branches': [",
        "                                                        {",
        "                                                          'StartAt': 'node1_0',",
        "                                                          'States': {",
        "                                                            'node1_0': {",
        "                                                              'Type': 'Task',",
        "                                                              'Next': 'node1_0-metrics_logger',",
        "                                                              'Parameters': {",
        "                                                                'Input': {",
        "                                                                  'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                                                  'backfill_start_date': '',",
        "                                                                  'children': [",
        "                                                                    'node3'",
        "                                                                  ],",
        "                                                                  'databricks_owner_group': 'data-platform-group',",
        "                                                                  'end_date.$': '$.end_date',",
        "                                                                  'execution_id.$': '$.execution_id',",
        "                                                                  'geospark': false,",
        "                                                                  'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node1\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                                                  'node_id': 'node1',",
        "                                                                  'parents': [],",
        "                                                                  'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                                                  'product_group': 'AIAndData',",
        "                                                                  's3_expectation_path': '',",
        "                                                                  's3_json_metadata_path': '',",
        "                                                                  's3_sql_path': '',",
        "                                                                  'start_date.$': '$.start_date',",
        "                                                                  'team': 'dataplatform',",
        "                                                                  'transformation_name': 'node1'",
        "                                                                },",
        "                                                                'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node1'",
        "                                                              },",
        "                                                              'Catch': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'States.ALL'",
        "                                                                  ],",
        "                                                                  'Next': 'node1_0-FAILED_metrics_logger',",
        "                                                                  'ResultPath': '$.error'",
        "                                                                }",
        "                                                              ],",
        "                                                              'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'StepFunctions.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node1_0-FAILED': {",
        "                                                              'Type': 'Fail',",
        "                                                              'Comment': 'node1_0 failed'",
        "                                                            },",
        "                                                            'node1_0-FAILED_metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'Next': 'node1_0-FAILED',",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.error.Cause'",
        "                                                                }",
        "                                                              },",
        "                                                              'ResultPath': null,",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node1_0-metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'End': true,",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.Output'",
        "                                                                }",
        "                                                              },",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            }",
        "                                                          }",
        "                                                        }",
        "                                                      ],",
        "                                                      'ResultPath': null",
        "                                                    },",
        "                                                    'HasError_node3_0_dependencies_0': {",
        "                                                      'Type': 'Pass',",
        "                                                      'End': true,",
        "                                                      'ResultPath': '$.Error',",
        "                                                      'Result': 'node1_0'",
        "                                                    }",
        "                                                  }",
        "                                                },",
        "                                                {",
        "                                                  'StartAt': 'CatchWrapper_node3_0_dependencies_1',",
        "                                                  'States': {",
        "                                                    'CatchWrapper_node3_0_dependencies_1': {",
        "                                                      'Type': 'Parallel',",
        "                                                      'End': true,",
        "                                                      'Catch': [",
        "                                                        {",
        "                                                          'ErrorEquals': [",
        "                                                            'States.ALL'",
        "                                                          ],",
        "                                                          'Next': 'HasError_node3_0_dependencies_1'",
        "                                                        }",
        "                                                      ],",
        "                                                      'Branches': [",
        "                                                        {",
        "                                                          'StartAt': 'node2_0',",
        "                                                          'States': {",
        "                                                            'node2_0': {",
        "                                                              'Type': 'Task',",
        "                                                              'Next': 'node2_0-metrics_logger',",
        "                                                              'Parameters': {",
        "                                                                'Input': {",
        "                                                                  'AWS_STEP_FUNCTIONS_STARTED_BY_EXECUTION_ID.$': '$$.Execution.Id',",
        "                                                                  'backfill_start_date': '',",
        "                                                                  'children': [",
        "                                                                    'node3'",
        "                                                                  ],",
        "                                                                  'databricks_owner_group': 'data-platform-group',",
        "                                                                  'end_date.$': '$.end_date',",
        "                                                                  'execution_id.$': '$.execution_id',",
        "                                                                  'geospark': false,",
        "                                                                  'node_execution_environment': '{\\n  \\'cluster_log_conf\\': {\\n    \\'s3\\': {\\n      \\'destination\\': \\'s3://samsara-databricks-cluster-logs/datapipelines/node2\\',\\n      \\'region\\': \\'us-west-2\\'\\n    }\\n  },\\n  \\'data_security_mode\\': \\'SINGLE_USER\\',\\n  \\'libraries\\': [\\n    {\\n      \\'pypi\\': {\\n        \\'package\\': \\'datadog==0.42.0\\'\\n      }\\n    }\\n  ],\\n  \\'single_user_name\\': \\'94266402-8dc8-44d7-8a4c-1439cb051aac\\',\\n  \\'spark_conf\\': {\\n    \\'databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.databricks.aggressiveWindowDownS\\': \\'300\\',\\n    \\'spark.databricks.delta.autoCompact.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.formatCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.delta.history.metricsEnabled\\': \\'true\\',\\n    \\'spark.databricks.delta.optimizeWrite.enabled\\': \\'true\\',\\n    \\'spark.databricks.delta.properties.defaults.checkpointRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.delta.properties.defaults.logRetentionDuration\\': \\'INTERVAL 30 DAYS\\',\\n    \\'spark.databricks.hive.metastore.client.pool.size\\': \\'3\\',\\n    \\'spark.databricks.hive.metastore.glueCatalog.enabled\\': \\'true\\',\\n    \\'spark.databricks.io.cache.enabled\\': \\'true\\',\\n    \\'spark.databricks.queryWatchdog.enabled\\': \\'false\\',\\n    \\'spark.databricks.scan.modTimeCheck.enabled\\': \\'false\\',\\n    \\'spark.databricks.sql.initial.catalog.name\\': \\'default\\',\\n    \\'spark.decommission.enabled\\': \\'true\\',\\n    \\'spark.hadoop.aws.glue.max-error-retries\\': \\'10\\',\\n    \\'spark.hadoop.aws.glue.partition.num.segments\\': \\'1\\',\\n    \\'spark.hadoop.databricks.loki.fileStatusCache.enabled\\': \\'false\\',\\n    \\'spark.hadoop.fs.s3a.acl.default\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.hadoop.fs.s3a.canned.acl\\': \\'BucketOwnerFullControl\\',\\n    \\'spark.network.timeout\\': \\'320\\',\\n    \\'spark.sql.shuffle.partitions\\': \\'4096\\',\\n    \\'spark.storage.decommission.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.rddBlocks.enabled\\': \\'true\\',\\n    \\'spark.storage.decommission.shuffleBlocks.enabled\\': \\'true\\'\\n  },\\n  \\'spark_env_vars\\': {\\n    \\'AWS_DEFAULT_REGION\\': \\'us-west-2\\',\\n    \\'AWS_REGION\\': \\'us-west-2\\',\\n    \\'DATABRICKS_DEFAULT_SERVICE_CREDENTIAL_NAME\\': \\'data-pipelines-replication\\',\\n    \\'GOOGLE_APPLICATION_CREDENTIALS\\': \\'/databricks/samsara-data-5142c7cd3ba2.json\\',\\n    \\'GOOGLE_CLOUD_PROJECT\\': \\'samsara-data\\'\\n  },\\n  \\'spark_version\\': \\'15.4.x-scala2.12\\'\\n}',",
        "                                                                  'node_id': 'node2',",
        "                                                                  'parents': [],",
        "                                                                  'pipeline_execution_time.$': '$.pipeline_execution_time',",
        "                                                                  'product_group': 'AIAndData',",
        "                                                                  's3_expectation_path': '',",
        "                                                                  's3_json_metadata_path': '',",
        "                                                                  's3_sql_path': '',",
        "                                                                  'start_date.$': '$.start_date',",
        "                                                                  'team': 'dataplatform',",
        "                                                                  'transformation_name': 'node2'",
        "                                                                },",
        "                                                                'StateMachineArn': 'arn:aws:states:us-west-2:492164655156:stateMachine:nesf-node2'",
        "                                                              },",
        "                                                              'Catch': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'States.ALL'",
        "                                                                  ],",
        "                                                                  'Next': 'node2_0-FAILED_metrics_logger',",
        "                                                                  'ResultPath': '$.error'",
        "                                                                }",
        "                                                              ],",
        "                                                              'Resource': 'arn:aws:states:::states:startExecution.sync',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'StepFunctions.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node2_0-FAILED': {",
        "                                                              'Type': 'Fail',",
        "                                                              'Comment': 'node2_0 failed'",
        "                                                            },",
        "                                                            'node2_0-FAILED_metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'Next': 'node2_0-FAILED',",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.error.Cause'",
        "                                                                }",
        "                                                              },",
        "                                                              'ResultPath': null,",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            },",
        "                                                            'node2_0-metrics_logger': {",
        "                                                              'Type': 'Task',",
        "                                                              'Comment': 'Log result of transformation to datadog',",
        "                                                              'End': true,",
        "                                                              'Parameters': {",
        "                                                                'FunctionName': 'metrics_logger',",
        "                                                                'InvocationType': 'Event',",
        "                                                                'Payload': {",
        "                                                                  'Output.$': '$.Output'",
        "                                                                }",
        "                                                              },",
        "                                                              'Resource': 'arn:aws:states:::lambda:invoke',",
        "                                                              'Retry': [",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'Lambda.Unknown',",
        "                                                                    'Lambda.ServiceException',",
        "                                                                    'Lambda.AWSLambdaException',",
        "                                                                    'Lambda.SdkClientException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 2,",
        "                                                                  'MaxAttempts': 2,",
        "                                                                  'BackoffRate': 2",
        "                                                                },",
        "                                                                {",
        "                                                                  'ErrorEquals': [",
        "                                                                    'TransientFailureException'",
        "                                                                  ],",
        "                                                                  'IntervalSeconds': 60,",
        "                                                                  'MaxAttempts': 4,",
        "                                                                  'BackoffRate': 2",
        "                                                                }",
        "                                                              ]",
        "                                                            }",
        "                                                          }",
        "                                                        }",
        "                                                      ],",
        "                                                      'ResultPath': null",
        "                                                    },",
        "                                                    'HasError_node3_0_dependencies_1': {",
        "                                                      'Type': 'Pass',",
        "                                                      'End': true,",
        "                                                      'ResultPath': '$.Error',",
        "                                                      'Result': 'node2_0'",
        "                                                    }",
        "                                                  }",
        "                                                }",
        "                                              ],",
        "                                              'ResultPath': '$.Errors'",
        "                                            },",
        "                                            'Success_node3_0_dependencies': {",
        "                                              'Type': 'Succeed'",
        "                                            }",
        "                                          }",
        "                                        }",
        "                                      ],",
        "                                      'ResultPath': null",
        "                                    }",
        "                                  }",
        "                                }",
        "                              ],",
        "                              'ResultPath': null",
        "                            },",
        "                            'HasError_node4_0_dependencies_0': {",
        "                              'Type': 'Pass',",
        "                              'End': true,",
        "                              'ResultPath': '$.Error',",
        "                              'Result': 'node3_0_dependencies'",
        "                            }",
        "                          }",
        "                        }",
        "                      ],",
        "                      'ResultPath': '$.Errors'",
        "                    },",
        "                    'Success_node4_0_dependencies': {",
        "                      'Type': 'Succeed'",
        "                    }",
        "                  }",
        "                }",
        "              ],",
        "              'ResultPath': null",
        "            }",
        "          }",
        "        }",
        "      ],",
        "      'ResultPath': null",
        "    }",
        "  }",
        "}"
      ]
    ]
  }
]
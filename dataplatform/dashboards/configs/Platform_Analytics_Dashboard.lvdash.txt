{
  "datasets": [
    {
      "name": "edc83baf",
      "displayName": "queries.cost.overview.top_cost_summary",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Overview\n",
        "-- View: Top Cost Summary\n",
        "-- =============================================================================\n",
        "-- Visualization: Counter (4 separate counters in a row)\n",
        "-- Title: \"FirmwareVDP Platform Cost Summary\"\n",
        "-- Description: Executive-level KPIs showing current month costs, growth trends, \n",
        "--              and critical anomaly count. Updates daily.\n",
        "--\n",
        "-- Counters:\n",
        "--   1. Total Monthly Cost (USD)\n",
        "--   2. Month-over-Month Growth (USD)\n",
        "--   3. MoM Growth % (%)\n",
        "--   4. Critical Anomalies (count)\n",
        "-- =============================================================================\n",
        "\n",
        "WITH latest_date AS (\n",
        "  SELECT MAX(c.date) AS max_date\n",
        "  FROM product_analytics_staging.agg_costs_rolling c\n",
        "  WHERE c.date BETWEEN :date.min AND :date.max\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  'Total Monthly Cost' AS metric,\n",
        "  MAX(c.monthly.cost) AS value,\n",
        "  'USD' AS unit\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date = DATE_SUB((SELECT max_date FROM latest_date), 1)\n",
        "\n",
        "UNION ALL\n",
        "\n",
        "SELECT \n",
        "  'Month-over-Month Growth' AS metric,\n",
        "  MAX(c.monthly.delta) AS value,\n",
        "  'USD' AS unit\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date = DATE_SUB((SELECT max_date FROM latest_date), 1)\n",
        "\n",
        "UNION ALL\n",
        "\n",
        "SELECT \n",
        "  'MoM Growth %' AS metric,\n",
        "  MAX(c.monthly.delta) / NULLIF(MAX(c.monthly.cost - c.monthly.delta), 0) AS value,\n",
        "  '%' AS unit\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date = DATE_SUB((SELECT max_date FROM latest_date), 1)\n",
        "\n",
        "UNION ALL\n",
        "\n",
        "SELECT \n",
        "  'Critical Anomalies' AS metric,\n",
        "  COUNT(*) AS value,\n",
        "  'services' AS unit\n",
        "FROM product_analytics_staging.fct_table_cost_anomalies a\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'region.team.product_group.dataplatform_feature.service'\n",
        "  AND h.team = :team\n",
        "  AND a.date = DATE_SUB((SELECT max_date FROM latest_date), 1)\n",
        "  AND a.daily.status IN ('critical_increase', 'critical_decrease')\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "b045a54d",
      "displayName": "queries.usage.overview.usage_snapshot",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage Overview\n",
        "-- View: Usage Snapshot\n",
        "-- =============================================================================\n",
        "-- Visualization: Scorecards (4-6 cards)\n",
        "-- Title: \"Usage At-a-Glance\"\n",
        "-- Purpose: Quick health check - how are users engaging with our data?\n",
        "--\n",
        "-- Scorecards:\n",
        "--   1. \"Monthly Active Users\" - monthly_active_users (count)\n",
        "--   2. \"Monthly Queries\" - monthly_queries (count, formatted as K/M)\n",
        "--   3. \"Tables Accessed\" - unique_tables_monthly (count)\n",
        "--   4. \"Queries/User\" - avg_queries_per_user (ratio)\n",
        "--   5. \"User Growth\" - user_growth_pct (%, green if positive)\n",
        "--   6. \"Query Growth\" - query_growth_pct (%, green if positive)\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Show delta vs previous period\n",
        "--   - Color code growth metrics (green positive, red negative)\n",
        "-- =============================================================================\n",
        "\n",
        "-- Latest day snapshot for scorecards\n",
        "WITH latest_data AS (\n",
        "  SELECT \n",
        "    u.date,\n",
        "    u.monthly.unique_users AS monthly_active_users,\n",
        "    u.monthly.total_queries AS monthly_queries,\n",
        "    u.monthly.unique_tables AS unique_tables_monthly,\n",
        "    u.monthly.avg_queries_per_user AS avg_queries_per_user,\n",
        "    u.monthly.delta_unique_users AS user_change,\n",
        "    LAG(u.monthly.unique_users) OVER (ORDER BY u.date) AS prev_users,\n",
        "    LAG(u.monthly.total_queries) OVER (ORDER BY u.date) AS prev_queries\n",
        "  FROM product_analytics_staging.agg_table_usage_rolling u\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE h.grouping_columns = 'team'\n",
        "    AND h.team = :team\n",
        "    AND u.date BETWEEN :date.min AND :date.max\n",
        ")\n",
        "SELECT \n",
        "  CAST(date AS DATE) AS date,\n",
        "  \n",
        "  -- Core metrics\n",
        "  monthly_active_users,\n",
        "  monthly_queries,\n",
        "  unique_tables_monthly,\n",
        "  ROUND(avg_queries_per_user, 1) AS avg_queries_per_user,\n",
        "  \n",
        "  -- Growth metrics (0-1 range for UI percent formatting)\n",
        "  user_change,\n",
        "  ROUND(user_change * 1.0 / NULLIF(monthly_active_users - user_change, 0), 4) AS user_growth_pct,\n",
        "  ROUND((monthly_queries - prev_queries) * 1.0 / NULLIF(prev_queries, 0), 4) AS query_growth_pct\n",
        "\n",
        "FROM latest_data\n",
        "ORDER BY date DESC\n",
        "LIMIT 1\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ea5a03bc",
      "displayName": "queries.cost.overview.monthly_cost_trend",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Overview\n",
        "-- View: Monthly Cost Trend\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart (multi-series)\n",
        "-- Title: \"Monthly Cost Trend & Budget Status\"\n",
        "-- Description: 30-day rolling cost over time with MoM growth rate. Track monthly\n",
        "--              spending trajectory against budget thresholds.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axes: \n",
        "--   - Primary (left): current_monthly_cost, trailing_12m_cost (USD)\n",
        "--   - Secondary (right): mom_growth_pct (0-1 scale, format as %)\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at $15,000 on left Y-axis (label: \"Budget Upper Limit\", color: red)\n",
        "--   - Horizontal line at $12,000 on left Y-axis (label: \"Warning Threshold\", color: yellow)\n",
        "--   - Horizontal line at 0% on right Y-axis (label: \"Zero Growth\", style: dashed)\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(c.date AS DATE) AS date,\n",
        "  h.team,\n",
        "  c.monthly.cost AS current_monthly_cost,\n",
        "  c.monthly.delta AS month_over_month_change,\n",
        "  c.monthly.delta / NULLIF(c.monthly.cost - c.monthly.delta, 0) AS mom_growth_pct,\n",
        "  c.yearly.cost AS trailing_12m_cost,\n",
        "  CASE \n",
        "    WHEN c.monthly.cost > 15000 THEN '\ud83d\udd34 BREACH'  -- Over upper band\n",
        "    WHEN c.monthly.cost > 12000 THEN '\ud83d\udfe1 WARNING'  -- 80-100% of upper band\n",
        "    ELSE '\ud83d\udfe2 OK'\n",
        "  END AS budget_status\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date BETWEEN :date.min AND :date.max\n",
        "ORDER BY c.date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "1ba1f227",
      "displayName": "queries.usage.overview.usage_summary",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage Overview\n",
        "-- View: Usage Summary (2 charts)\n",
        "-- =============================================================================\n",
        "-- \n",
        "-- CHART 1: Active Users Summary\n",
        "-- Visualization: Combination Chart (Bar + Line)\n",
        "-- Title: \"FirmwareVDP Active Users: Daily, Weekly, Monthly\"\n",
        "-- Description: Track DAU, WAU, and MAU trends to understand engagement patterns.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axis: user_count\n",
        "-- Series:\n",
        "--   - daily_users (bar, light blue)\n",
        "--   - weekly_active_users (line, blue, medium weight)\n",
        "--   - monthly_active_users (line, dark blue, heavy weight)\n",
        "--\n",
        "-- CHART 2: Query Volume Summary\n",
        "-- Visualization: Combination Chart (Bar + Line)\n",
        "-- Title: \"FirmwareVDP Query Volume: Daily, Weekly, Monthly\"\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(u.date AS DATE) AS date,\n",
        "  u.daily.unique_users AS daily_users,\n",
        "  u.daily.total_queries AS daily_queries,\n",
        "  u.daily.unique_tables AS tables_accessed_today,\n",
        "  u.weekly.unique_users AS weekly_active_users,\n",
        "  u.weekly.total_queries AS weekly_queries,\n",
        "  u.monthly.unique_users AS monthly_active_users,\n",
        "  u.monthly.total_queries AS monthly_queries,\n",
        "  u.monthly.unique_tables AS unique_tables_accessed_monthly,\n",
        "  u.monthly.avg_queries_per_user AS avg_queries_per_user,\n",
        "  u.monthly.avg_queries_per_table AS avg_queries_per_table\n",
        "FROM product_analytics_staging.agg_table_usage_rolling u\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND u.date BETWEEN :date.min AND :date.max\n",
        "ORDER BY u.date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "844c9d3f",
      "displayName": "queries.cost.anomalies.anomaly_summary",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Anomalies\n",
        "-- View: Anomaly Summary\n",
        "-- =============================================================================\n",
        "-- Visualization: 3 Stacked Bar Charts (or 1 chart with time_horizon filter)\n",
        "-- Title: \"Anomaly Count by Severity & Time Horizon\"\n",
        "-- Description: Count of warnings, anomalous, and critical cost deviations.\n",
        "--              Unpivoted for easy charting - filter by time_horizon for separate views.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axis: count (stacked)\n",
        "-- Series (3 only): warnings, anomalous, critical\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at 5 on Y-axis (label: \"Alert Threshold\", color: yellow)\n",
        "--     (More than 5 anomalies/day warrants investigation)\n",
        "--   - Horizontal line at 10 on Y-axis (label: \"Critical Threshold\", color: red)\n",
        "--     (More than 10 anomalies/day requires immediate action)\n",
        "-- =============================================================================\n",
        "\n",
        "WITH base_data AS (\n",
        "  SELECT \n",
        "    a.date,\n",
        "    h.team,\n",
        "    h.grouping_columns,\n",
        "    a.daily,\n",
        "    a.weekly,\n",
        "    a.monthly\n",
        "  FROM product_analytics_staging.fct_table_cost_anomalies a\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE a.date BETWEEN :date.min AND :date.max\n",
        "    AND h.grouping_columns = 'region.team.product_group.dataplatform_feature.service'\n",
        "    AND h.team = :team\n",
        "),\n",
        "unpivoted AS (\n",
        "  SELECT \n",
        "    date,\n",
        "    team,\n",
        "    grouping_columns,\n",
        "    'daily' AS time_horizon,\n",
        "    CASE WHEN daily.status = 'warning' THEN 1 ELSE 0 END AS warnings,\n",
        "    CASE WHEN daily.status IN ('anomalous_increase', 'anomalous_decrease') THEN 1 ELSE 0 END AS anomalous,\n",
        "    CASE WHEN daily.status IN ('critical_increase', 'critical_decrease') THEN 1 ELSE 0 END AS critical,\n",
        "    daily.cost AS cost\n",
        "  FROM base_data\n",
        "  \n",
        "  UNION ALL\n",
        "  \n",
        "  SELECT \n",
        "    date,\n",
        "    team,\n",
        "    grouping_columns,\n",
        "    'weekly' AS time_horizon,\n",
        "    CASE WHEN weekly.status = 'warning' THEN 1 ELSE 0 END AS warnings,\n",
        "    CASE WHEN weekly.status IN ('anomalous_increase', 'anomalous_decrease') THEN 1 ELSE 0 END AS anomalous,\n",
        "    CASE WHEN weekly.status IN ('critical_increase', 'critical_decrease') THEN 1 ELSE 0 END AS critical,\n",
        "    weekly.cost AS cost\n",
        "  FROM base_data\n",
        "  \n",
        "  UNION ALL\n",
        "  \n",
        "  SELECT \n",
        "    date,\n",
        "    team,\n",
        "    grouping_columns,\n",
        "    'monthly' AS time_horizon,\n",
        "    CASE WHEN monthly.status = 'warning' THEN 1 ELSE 0 END AS warnings,\n",
        "    CASE WHEN monthly.status IN ('anomalous_increase', 'anomalous_decrease') THEN 1 ELSE 0 END AS anomalous,\n",
        "    CASE WHEN monthly.status IN ('critical_increase', 'critical_decrease') THEN 1 ELSE 0 END AS critical,\n",
        "    monthly.cost AS cost\n",
        "  FROM base_data\n",
        ")\n",
        "SELECT \n",
        "  CAST(date AS DATE) AS date,\n",
        "  time_horizon,\n",
        "  SUM(warnings) AS warnings,\n",
        "  SUM(anomalous) AS anomalous,\n",
        "  SUM(critical) AS critical,\n",
        "  SUM(warnings) + SUM(anomalous) + SUM(critical) AS total_anomalies\n",
        "FROM unpivoted\n",
        "WHERE time_horizon = 'daily'  -- Filter to daily for the dashboard chart\n",
        "GROUP BY date, time_horizon\n",
        "ORDER BY date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ab9c2215",
      "displayName": "queries.cost.overview.cost_by_time_window",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Overview\n",
        "-- View: Cost by Time Window\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart (multi-series)\n",
        "-- Title: \"Cost Across Time Horizons\"\n",
        "-- Description: Compare daily, weekly (7d), monthly (30d), quarterly (90d), and\n",
        "--              yearly (365d) rolling costs to understand spend patterns.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axis (left): daily_cost, rolling_7d_cost, rolling_30d_cost, rolling_90d_cost, rolling_365d_cost (USD)\n",
        "-- Y-Axis (right): daily_change, weekly_change, monthly_change, yearly_change (USD)\n",
        "-- Series: One line per time window\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at $0 on right Y-axis (label: \"Zero Change\", style: dashed)\n",
        "--   - Horizontal line at $500/day on daily_cost (label: \"Daily Budget\", color: yellow)\n",
        "--   - Horizontal line at $12,000 on rolling_30d_cost (label: \"Monthly Budget\", color: yellow)\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(c.date AS DATE) AS date,\n",
        "  c.daily.cost AS daily_cost,\n",
        "  c.weekly.cost AS rolling_7d_cost,\n",
        "  c.monthly.cost AS rolling_30d_cost,\n",
        "  c.quarterly.cost AS rolling_90d_cost,\n",
        "  c.yearly.cost AS rolling_365d_cost,\n",
        "  c.daily.delta AS daily_change,\n",
        "  c.weekly.delta AS weekly_change,\n",
        "  c.monthly.delta AS monthly_change,\n",
        "  c.yearly.delta AS yearly_change\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date BETWEEN :date.min AND :date.max\n",
        "ORDER BY c.date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "421a0f5e",
      "displayName": "queries.cost.efficiency.cost_per_user",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Efficiency\n",
        "-- View: Cost per User\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart (dual-axis)\n",
        "-- Title: \"Cost Efficiency: $ per User & $ per 1K Queries\"\n",
        "-- Description: Track unit economics over time. Monitor cost efficiency relative\n",
        "--              to user count and query volume.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axis (left): cost_per_user (USD)\n",
        "-- Y-Axis (right): cost_per_1k_queries (USD)\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at $100 on left Y-axis (label: \"High Cost Threshold\", color: red)\n",
        "--   - Horizontal line at $50 on left Y-axis (label: \"Target Cost/User\", color: green)\n",
        "--   - Horizontal line at $1.00 on right Y-axis (label: \"Target Cost/1K Queries\", color: green)\n",
        "--   - Optional: Shaded band $50-$100 as \"Acceptable Range\" on left axis\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(c.date AS DATE) AS date,\n",
        "  c.monthly.cost AS total_monthly_cost,\n",
        "  u.monthly.unique_users AS active_users,\n",
        "  c.monthly.cost / NULLIF(u.monthly.unique_users, 0) AS cost_per_user,\n",
        "  u.monthly.total_queries AS total_queries,\n",
        "  (c.monthly.cost / NULLIF(u.monthly.total_queries, 0)) * 1000 AS cost_per_1k_queries,\n",
        "  CASE \n",
        "    WHEN c.monthly.cost / NULLIF(u.monthly.unique_users, 0) > 100 THEN '\ud83d\udd34 HIGH'\n",
        "    WHEN c.monthly.cost / NULLIF(u.monthly.unique_users, 0) > 50 THEN '\ud83d\udfe1 MEDIUM'\n",
        "    ELSE '\ud83d\udfe2 GOOD'\n",
        "  END AS efficiency_status\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.agg_table_usage_rolling u\n",
        "  USING (date, cost_hierarchy_id)\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND c.date BETWEEN :date.min AND :date.max\n",
        "ORDER BY c.date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "220b8832",
      "displayName": "queries.cost.attribution.cost_by_team",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Attribution\n",
        "-- View: Cost by Product Group\n",
        "-- =============================================================================\n",
        "-- Visualization: Stacked Area Chart\n",
        "-- Title: \"Monthly Cost by Product Group & Feature\"\n",
        "-- Description: Time-series view of how costs are distributed across product \n",
        "--              groups and dataplatform features within FirmwareVDP.\n",
        "--\n",
        "-- X-Axis: date\n",
        "-- Y-Axis: monthly_cost (USD, stacked)\n",
        "-- Stack by: product_group, then dataplatform_feature\n",
        "-- Tooltip: monthly_change, percent_of_firmwarevdp_total\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at $12,000 total (label: \"Monthly Budget\", color: yellow)\n",
        "--   - Horizontal line at $15,000 total (label: \"Budget Limit\", color: red)\n",
        "--   - Stacked total line overlay to show overall trend vs budget\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(c.date AS DATE) AS date,\n",
        "  h.product_group,\n",
        "  c.monthly.cost AS monthly_cost,\n",
        "  c.monthly.delta AS monthly_change,\n",
        "  c.monthly.cost / SUM(c.monthly.cost) OVER (PARTITION BY c.date) AS percent_of_firmwarevdp_total\n",
        "FROM product_analytics_staging.agg_costs_rolling c\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team.product_group'\n",
        "  AND h.team = :team\n",
        "  AND c.date BETWEEN :date.min AND :date.max\n",
        "  AND h.product_group IS NOT NULL\n",
        "ORDER BY c.date DESC, monthly_cost DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "a5f2e9e3",
      "displayName": "queries.cost.attribution.top_tables_by_cost",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Attribution\n",
        "-- View: Top Services by Cost\n",
        "-- =============================================================================\n",
        "-- Visualization: Bar Chart (horizontal) + Table\n",
        "-- Title: \"Top Services by Cost\"\n",
        "-- Description: Identify the highest-cost services for optimization. Shows monthly \n",
        "--              cost, recent trend, and percent of total FirmwareVDP spending.\n",
        "--\n",
        "-- Parameters:\n",
        "--   :limit (Number) - Max rows to return (default: 50, use 0 for no limit)\n",
        "--\n",
        "-- Chart: Horizontal bar chart of monthly_cost by service\n",
        "-- Table Columns:\n",
        "--   - date, region, team, service, product_group, dataplatform_feature\n",
        "--   - monthly_cost, monthly_change, yesterday_cost, percent_of_total\n",
        "-- Sort: monthly_cost DESC\n",
        "-- =============================================================================\n",
        "\n",
        "-- Look at last 30 days and take most recent metrics for each service\n",
        "WITH recent_costs AS (\n",
        "  SELECT \n",
        "    c.date,\n",
        "    h.region,\n",
        "    h.team,\n",
        "    h.service,\n",
        "    h.product_group,\n",
        "    h.dataplatform_feature,\n",
        "    c.monthly.cost AS monthly_cost,\n",
        "    c.monthly.delta AS monthly_change,\n",
        "    c.daily.cost AS yesterday_cost,\n",
        "    ROW_NUMBER() OVER (PARTITION BY h.service ORDER BY c.date DESC) AS rn\n",
        "  FROM product_analytics_staging.agg_costs_rolling c\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE h.service IS NOT NULL  -- Service-level groupings only\n",
        "    AND h.team = :team\n",
        "    -- Look at last 30 days to capture all recent services\n",
        "    AND c.date >= DATE_SUB((SELECT MAX(date) FROM product_analytics_staging.agg_costs_rolling WHERE date BETWEEN :date.min AND :date.max), 29)\n",
        ")\n",
        "SELECT \n",
        "  CAST(date AS DATE) AS date,\n",
        "  region,\n",
        "  team,\n",
        "  service,\n",
        "  product_group,\n",
        "  dataplatform_feature,\n",
        "  monthly_cost,\n",
        "  monthly_change,\n",
        "  yesterday_cost,\n",
        "  monthly_cost / SUM(monthly_cost) OVER () AS percent_of_total,\n",
        "  -- Quick navigation links (service = database.table format)\n",
        "  CONCAT('https://datahub.internal.samsara.com/dataset/urn:li:dataset:(urn:li:dataPlatform:databricks,', service, ',PROD)/Schema') AS datahub_url,\n",
        "  CONCAT('https://dagster.internal.samsara.com/assets/', region, '/', REPLACE(service, '.', '/')) AS dagster_url\n",
        "FROM recent_costs\n",
        "WHERE rn = 1  -- Take most recent row for each service\n",
        "ORDER BY monthly_cost DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        },
        {
          "displayName": "li",
          "keyword": "li",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataset",
          "keyword": "dataset",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataPlatform",
          "keyword": "dataPlatform",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "databricks",
          "keyword": "databricks",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "1a1916c2",
      "displayName": "queries.cost.efficiency.idle_table_cost",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Efficiency\n",
        "-- View: Idle Service Costs\n",
        "-- =============================================================================\n",
        "-- Visualization: Bar Chart + Table\n",
        "-- Title: \"Idle & Low-Usage Services (>$10/month)\"\n",
        "-- Description: Services costing >$10/month with <3 users. Deprecation candidates.\n",
        "--              Target SLO: Idle cost < 5% of total team budget.\n",
        "--\n",
        "-- Chart: Horizontal bar of monthly_cost by service (top 20)\n",
        "-- Table Columns:\n",
        "--   - date, team, service\n",
        "--   - monthly_cost, monthly_users, monthly_queries\n",
        "--   - usage_category (ZERO_USAGE, LOW_USAGE, USED)\n",
        "-- =============================================================================\n",
        "\n",
        "-- Look at last 30 days and take most recent metrics for each service\n",
        "WITH recent_costs AS (\n",
        "  SELECT \n",
        "    c.date,\n",
        "    h.region,\n",
        "    h.team,\n",
        "    h.service,\n",
        "    c.monthly.cost AS monthly_cost,\n",
        "    c.cost_hierarchy_id,\n",
        "    ROW_NUMBER() OVER (PARTITION BY h.service ORDER BY c.date DESC) AS rn\n",
        "  FROM product_analytics_staging.agg_costs_rolling c\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE h.grouping_columns = 'region.team.product_group.dataplatform_feature.service'\n",
        "    AND h.team = :team\n",
        "    -- Look at last 30 days to capture all recent services\n",
        "    AND c.date >= DATE_SUB((SELECT MAX(date) FROM product_analytics_staging.agg_costs_rolling WHERE date BETWEEN :date.min AND :date.max), 29)\n",
        "),\n",
        "recent_usage AS (\n",
        "  SELECT \n",
        "    u.cost_hierarchy_id,\n",
        "    u.date,\n",
        "    u.monthly.unique_users AS monthly_users,\n",
        "    u.monthly.total_queries AS monthly_queries,\n",
        "    ROW_NUMBER() OVER (PARTITION BY u.cost_hierarchy_id ORDER BY u.date DESC) AS rn\n",
        "  FROM product_analytics_staging.agg_table_usage_rolling u\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE h.grouping_columns = 'region.team.product_group.dataplatform_feature.service'\n",
        "    AND h.team = :team\n",
        "    AND u.date >= DATE_SUB((SELECT MAX(date) FROM product_analytics_staging.agg_table_usage_rolling WHERE date BETWEEN :date.min AND :date.max), 29)\n",
        ")\n",
        "SELECT \n",
        "  CAST(c.date AS DATE) AS date,\n",
        "  c.region,\n",
        "  c.team,\n",
        "  c.service,\n",
        "  c.monthly_cost,\n",
        "  COALESCE(u.monthly_users, 0) AS monthly_users,\n",
        "  COALESCE(u.monthly_queries, 0) AS monthly_queries,\n",
        "  CASE \n",
        "    WHEN COALESCE(u.monthly_users, 0) = 0 THEN 'ZERO_USAGE'\n",
        "    WHEN COALESCE(u.monthly_users, 0) < 3 THEN 'LOW_USAGE'\n",
        "    ELSE 'USED'\n",
        "  END AS usage_category,\n",
        "  -- Quick navigation links (service = database.table format)\n",
        "  CONCAT('https://datahub.internal.samsara.com/dataset/urn:li:dataset:(urn:li:dataPlatform:databricks,', c.service, ',PROD)/Schema') AS datahub_url,\n",
        "  CONCAT('https://dagster.internal.samsara.com/assets/', c.region, '/', REPLACE(c.service, '.', '/')) AS dagster_url\n",
        "FROM recent_costs c\n",
        "LEFT JOIN recent_usage u\n",
        "  ON c.cost_hierarchy_id = u.cost_hierarchy_id\n",
        "  AND u.rn = 1\n",
        "WHERE c.rn = 1  -- Take most recent row for each service\n",
        "  AND c.monthly_cost > 10  -- Only show services with material cost\n",
        "  AND COALESCE(u.monthly_users, 0) < 3  -- Low or zero usage\n",
        "ORDER BY c.monthly_cost DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        },
        {
          "displayName": "li",
          "keyword": "li",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataset",
          "keyword": "dataset",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataPlatform",
          "keyword": "dataPlatform",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "databricks",
          "keyword": "databricks",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "3a5b0fbd",
      "displayName": "queries.cost.alerts.active_alerts",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Alerts\n",
        "-- View: Active Alerts Summary\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Active Cost Alerts by Type\"\n",
        "-- Description: Current alerts grouped by type and severity.\n",
        "--              critical_service_increase is highest priority.\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT\n",
        "  alert_type,\n",
        "  time_horizon,\n",
        "  COUNT(*) AS alert_count,\n",
        "  SUM(cost) AS total_cost_affected,\n",
        "  ROUND(AVG(z_score), 2) AS avg_z_score,\n",
        "  ROUND(AVG(percent_change), 1) AS avg_percent_change\n",
        "FROM product_analytics_staging.dim_cost_alerts\n",
        "WHERE date BETWEEN :date.min AND :date.max\n",
        "  AND team = :team\n",
        "GROUP BY alert_type, time_horizon\n",
        "ORDER BY \n",
        "  CASE alert_type \n",
        "    WHEN 'critical_service_increase' THEN 1\n",
        "    WHEN 'critical_team_increase' THEN 2\n",
        "    WHEN 'critical_decrease' THEN 3\n",
        "    WHEN 'multi_horizon_anomaly' THEN 4\n",
        "    WHEN 'anomalous_weekly_spike' THEN 5\n",
        "    WHEN 'overall_daily_spike' THEN 6\n",
        "    ELSE 7\n",
        "  END,\n",
        "  time_horizon\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "e93beeaa",
      "displayName": "queries.cost.anomalies.critical_table_increases",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Anomalies\n",
        "-- View: Critical Service Increases\n",
        "-- =============================================================================\n",
        "-- Visualization: Table (sortable, with conditional formatting)\n",
        "-- Title: \"Services with Critical Cost Spikes (>5\u03c3)\"\n",
        "-- Description: Top 50 services with statistically significant cost increases \n",
        "--              requiring immediate investigation. Sort by z-score to prioritize.\n",
        "--\n",
        "-- Columns:\n",
        "--   - date, region, team, product_group, dataplatform_feature, service\n",
        "--   - current_cost, expected_cost, cost_increase (USD)\n",
        "--   - cost_z_score, percent_change (0-1 scale, format as %)\n",
        "-- Conditional Formatting: Highlight rows with z_score > 7 in red\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(a.date AS DATE) AS date,\n",
        "  h.region,\n",
        "  h.team,\n",
        "  h.product_group,\n",
        "  h.dataplatform_feature,\n",
        "  h.service,\n",
        "  a.daily.cost AS current_cost,\n",
        "  a.daily.z_score AS cost_z_score,\n",
        "  a.daily.percent_change AS percent_change,\n",
        "  a.daily_baseline.mean AS expected_cost,\n",
        "  a.daily.cost - a.daily_baseline.mean AS cost_increase\n",
        "FROM product_analytics_staging.fct_table_cost_anomalies a\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE a.date BETWEEN :date.min AND :date.max\n",
        "  AND h.team = :team\n",
        "  AND h.service IS NOT NULL  -- Service-level groupings only\n",
        "  AND a.daily.status = 'critical_increase'\n",
        "ORDER BY a.daily.z_score DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "a2f66709",
      "displayName": "queries.cost.alerts.alert_details",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Alerts\n",
        "-- View: Alert Details\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Cost Alert Details\"\n",
        "-- Description: Detailed view of all current alerts with full context.\n",
        "--              z_score > 3 indicates extreme deviation.\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT\n",
        "  CAST(date AS DATE) AS date,\n",
        "  alert_type,\n",
        "  time_horizon,\n",
        "  hierarchy_label,\n",
        "  grouping_columns,\n",
        "  region,\n",
        "  team,\n",
        "  product_group,\n",
        "  dataplatform_feature,\n",
        "  service,\n",
        "  ROUND(cost, 2) AS cost,\n",
        "  ROUND(baseline_mean, 2) AS baseline_mean,\n",
        "  ROUND(z_score, 2) AS z_score,\n",
        "  ROUND(percent_change, 1) AS percent_change_pct,\n",
        "  status\n",
        "FROM product_analytics_staging.dim_cost_alerts\n",
        "WHERE date BETWEEN :date.min AND :date.max\n",
        "  AND team = :team\n",
        "ORDER BY \n",
        "  date DESC,\n",
        "  CASE alert_type \n",
        "    WHEN 'critical_service_increase' THEN 1\n",
        "    WHEN 'critical_team_increase' THEN 2\n",
        "    WHEN 'critical_decrease' THEN 3\n",
        "    ELSE 4\n",
        "  END,\n",
        "  ABS(z_score) DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "a1da4b07",
      "displayName": "queries.cost.alerts.recurring_alerts",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Alerts\n",
        "-- View: Recurring Alerts\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Recurring Cost Alerts (Chronic Issues)\"\n",
        "-- Description: Services with alerts on multiple days. High recurrence indicates\n",
        "--              persistent problems needing systematic investigation.\n",
        "-- =============================================================================\n",
        "\n",
        "WITH alert_history AS (\n",
        "  SELECT\n",
        "    service,\n",
        "    region,\n",
        "    team,\n",
        "    product_group,\n",
        "    dataplatform_feature,\n",
        "    alert_type,\n",
        "    COUNT(DISTINCT date) AS recurrence_days,\n",
        "    MIN(date) AS first_alert_date,\n",
        "    MAX(date) AS last_alert_date,\n",
        "    AVG(cost) AS avg_cost,\n",
        "    AVG(z_score) AS avg_z_score\n",
        "  FROM product_analytics_staging.dim_cost_alerts\n",
        "  WHERE date BETWEEN :date.min AND :date.max\n",
        "    AND team = :team\n",
        "  GROUP BY service, region, team, product_group, dataplatform_feature, alert_type\n",
        "  HAVING COUNT(DISTINCT date) >= 2\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  service,\n",
        "  region,\n",
        "  team,\n",
        "  product_group,\n",
        "  dataplatform_feature,\n",
        "  alert_type,\n",
        "  recurrence_days,\n",
        "  CAST(first_alert_date AS DATE) AS first_alert_date,\n",
        "  CAST(last_alert_date AS DATE) AS last_alert_date,\n",
        "  DATEDIFF(last_alert_date, first_alert_date) AS alert_span_days,\n",
        "  ROUND(avg_cost, 2) AS avg_cost,\n",
        "  ROUND(avg_z_score, 2) AS avg_z_score\n",
        "FROM alert_history\n",
        "ORDER BY recurrence_days DESC, avg_z_score DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "76b4fbb2",
      "displayName": "queries.cost.anomalies.persistent_anomalies",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Cost Anomalies\n",
        "-- View: Persistent Anomalies\n",
        "-- =============================================================================\n",
        "-- Visualization: Table (sortable)\n",
        "-- Title: \"Services with Persistent Anomalies (3+ Days)\"\n",
        "-- Description: Services showing sustained cost anomalies indicating systemic issues \n",
        "--              rather than one-time spikes. Prioritize by days_anomalous.\n",
        "--\n",
        "-- Columns:\n",
        "--   - service, region, team\n",
        "--   - streak_start, streak_end, days_anomalous\n",
        "--   - status, avg_cost, max_z_score\n",
        "-- Sort: days_anomalous DESC, avg_cost DESC\n",
        "-- =============================================================================\n",
        "\n",
        "WITH anomaly_days AS (\n",
        "  SELECT \n",
        "    h.service,\n",
        "    h.region,\n",
        "    h.team,\n",
        "    a.date,\n",
        "    a.daily.status,\n",
        "    a.daily.cost,\n",
        "    a.daily.z_score,\n",
        "    -- Detect gaps: if previous date is not yesterday, start new streak\n",
        "    CASE WHEN LAG(a.date) OVER (PARTITION BY h.service, h.region, h.team ORDER BY a.date) \n",
        "              = DATE_SUB(a.date, 1)\n",
        "         THEN 0 ELSE 1 END AS is_new_streak\n",
        "  FROM product_analytics_staging.fct_table_cost_anomalies a\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE a.date BETWEEN :date.min AND :date.max\n",
        "    AND h.team = :team\n",
        "    AND h.service IS NOT NULL  -- Service-level groupings only\n",
        "    AND a.daily.status IN ('critical_increase', 'anomalous_increase', 'warning')\n",
        "),\n",
        "anomaly_streaks AS (\n",
        "  SELECT \n",
        "    *,\n",
        "    SUM(is_new_streak) OVER (PARTITION BY service, region, team ORDER BY date) AS streak_group\n",
        "  FROM anomaly_days\n",
        ")\n",
        "SELECT \n",
        "  service,\n",
        "  region,\n",
        "  team,\n",
        "  CAST(MIN(date) AS DATE) AS streak_start,\n",
        "  CAST(MAX(date) AS DATE) AS streak_end,\n",
        "  COUNT(*) AS days_anomalous,  -- Actual count of anomaly days\n",
        "  MAX(status) AS status,\n",
        "  ROUND(AVG(cost), 2) AS avg_cost,\n",
        "  ROUND(MAX(z_score), 2) AS max_z_score\n",
        "FROM anomaly_streaks\n",
        "GROUP BY service, region, team, streak_group\n",
        "HAVING COUNT(*) >= 3  -- 3+ consecutive anomaly days\n",
        "ORDER BY days_anomalous DESC, avg_cost DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "45da29af",
      "displayName": "queries.usage.overview.usage_growth",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage Overview\n",
        "-- View: Usage Growth (2 charts)\n",
        "-- =============================================================================\n",
        "-- \n",
        "-- CHART 1: Active Users Growth\n",
        "-- Visualization: Line Chart (dual-axis)\n",
        "-- Title: \"FirmwareVDP Monthly Active Users Growth\"\n",
        "-- Description: Track MAU (monthly active users) and MoM growth rate.\n",
        "--\n",
        "-- CHART 2: Query Volume Growth  \n",
        "-- Visualization: Line Chart (dual-axis)\n",
        "-- Title: \"FirmwareVDP Monthly Query Volume Growth\"\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Horizontal line at 0% on growth axes (label: \"Zero Growth\", style: dashed)\n",
        "--   - Horizontal line at 10% on growth axes (label: \"Healthy Growth Target\", color: green)\n",
        "--   - Horizontal line at -10% on growth axes (label: \"Concern Threshold\", color: yellow)\n",
        "-- =============================================================================\n",
        "\n",
        "SELECT \n",
        "  CAST(u.date AS DATE) AS date,\n",
        "  u.monthly.unique_users AS monthly_active_users,\n",
        "  u.monthly.delta_unique_users AS user_change,\n",
        "  u.monthly.delta_unique_users / NULLIF(u.monthly.unique_users - u.monthly.delta_unique_users, 0) AS user_growth_pct,\n",
        "  u.monthly.total_queries AS monthly_queries,\n",
        "  (u.monthly.total_queries - LAG(u.monthly.total_queries) OVER (ORDER BY u.date)) \n",
        "    / NULLIF(LAG(u.monthly.total_queries) OVER (ORDER BY u.date), 0) AS query_growth_pct\n",
        "FROM product_analytics_staging.agg_table_usage_rolling u\n",
        "JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "  USING (date, cost_hierarchy_id)\n",
        "WHERE h.grouping_columns = 'team'\n",
        "  AND h.team = :team\n",
        "  AND u.date BETWEEN :date.min AND :date.max\n",
        "ORDER BY u.date DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "2b02b550",
      "displayName": "queries.usage.engagement.platform_usage_trends",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: User Analytics - Platform Trends\n",
        "-- View: Platform Usage Trends\n",
        "-- =============================================================================\n",
        "-- Visualization: Multi-line chart\n",
        "-- Title: \"Platform Usage Trends Over Time\"\n",
        "-- Description: Shows how platform adoption evolves - are more users using both\n",
        "--              SQL and dashboards? Is overall engagement growing?\n",
        "--\n",
        "-- Line Chart:\n",
        "--   X-Axis: date\n",
        "--   Y-Axis: user_count or pct\n",
        "--   Lines: total_active_users, sql_only_users, dashboard_only_users, both_users\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Growing \"both_users\" indicates successful cross-platform adoption\n",
        "--   - Watch for declining trends that may indicate churn\n",
        "-- =============================================================================\n",
        "\n",
        "WITH overall_metrics AS (\n",
        "  SELECT \n",
        "    a.date,\n",
        "    a.monthly.users.total AS total_active_users,\n",
        "    a.monthly.users.sql_users,\n",
        "    a.monthly.users.dashboard_users,\n",
        "    a.monthly.users.sql_only AS sql_only_users,\n",
        "    a.monthly.users.dashboard_only AS dashboard_only_users,\n",
        "    a.monthly.users.both AS both_users,\n",
        "    a.monthly.sql.queries AS total_sql_queries,\n",
        "    a.monthly.dashboard.events AS total_dashboard_events,\n",
        "    a.monthly.combined.total_interactions,\n",
        "    a.monthly.combined.delta_users AS delta_active_users\n",
        "  FROM product_analytics_staging.agg_platform_usage_rolling a\n",
        "  JOIN product_analytics_staging.dim_user_hierarchies h\n",
        "    USING (date, user_hierarchy_id)\n",
        "  WHERE h.grouping_columns = 'overall'\n",
        "    AND a.date BETWEEN :date.min AND :date.max\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  CAST(date AS DATE) AS date,\n",
        "  -- User counts\n",
        "  total_active_users,\n",
        "  sql_only_users,\n",
        "  dashboard_only_users,\n",
        "  both_users,\n",
        "  \n",
        "  -- User percentages (0-1 range for UI percent formatting)\n",
        "  ROUND(sql_only_users * 1.0 / NULLIF(total_active_users, 0), 4) AS pct_sql_only,\n",
        "  ROUND(dashboard_only_users * 1.0 / NULLIF(total_active_users, 0), 4) AS pct_dashboard_only,\n",
        "  ROUND(both_users * 1.0 / NULLIF(total_active_users, 0), 4) AS pct_both,\n",
        "  \n",
        "  -- Activity metrics\n",
        "  total_sql_queries,\n",
        "  total_dashboard_events,\n",
        "  total_interactions,\n",
        "  \n",
        "  -- Per-user averages\n",
        "  ROUND(total_sql_queries * 1.0 / NULLIF(sql_users, 0), 1) AS avg_queries_per_sql_user,\n",
        "  ROUND(total_dashboard_events * 1.0 / NULLIF(dashboard_users, 0), 1) AS avg_events_per_dashboard_user,\n",
        "  ROUND(total_interactions * 1.0 / NULLIF(total_active_users, 0), 1) AS avg_interactions_per_user,\n",
        "  \n",
        "  -- Growth\n",
        "  delta_active_users,\n",
        "  \n",
        "  -- 7-day moving averages\n",
        "  AVG(total_active_users) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS active_users_7d_avg,\n",
        "  AVG(sql_users) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sql_users_7d_avg,\n",
        "  AVG(dashboard_users) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS dashboard_users_7d_avg,\n",
        "  AVG(both_users) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS both_users_7d_avg\n",
        "\n",
        "FROM overall_metrics\n",
        "ORDER BY date\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "d6fb5044",
      "displayName": "queries.usage.engagement.most_accessed_tables",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Tables\n",
        "-- View: Most Accessed Services\n",
        "-- =============================================================================\n",
        "-- Visualization: Bar Chart (horizontal) + Table\n",
        "-- Title: \"Top 50 Most Accessed Services\"\n",
        "-- Description: Services with highest unique user count. These are your most \n",
        "--              valuable data products - prioritize their quality and SLAs.\n",
        "--\n",
        "-- Chart: Horizontal bar of monthly_users by service (top 20)\n",
        "-- Table Columns:\n",
        "--   - date, service, product_group, dataplatform_feature\n",
        "--   - monthly_users, monthly_queries, avg_queries_per_user, percent_of_users\n",
        "-- Sort: monthly_users DESC\n",
        "-- =============================================================================\n",
        "\n",
        "-- Look at last 30 days and take most recent metrics for each service\n",
        "WITH recent_activity AS (\n",
        "  SELECT \n",
        "    u.date,\n",
        "    h.region,\n",
        "    h.service,\n",
        "    h.product_group,\n",
        "    h.dataplatform_feature,\n",
        "    u.monthly.unique_users AS monthly_users,\n",
        "    u.monthly.total_queries AS monthly_queries,\n",
        "    u.monthly.avg_queries_per_user AS avg_queries_per_user,\n",
        "    ROW_NUMBER() OVER (PARTITION BY h.service ORDER BY u.date DESC) AS rn\n",
        "  FROM product_analytics_staging.agg_table_usage_rolling u\n",
        "  JOIN product_analytics_staging.dim_cost_hierarchies h\n",
        "    USING (date, cost_hierarchy_id)\n",
        "  WHERE h.service IS NOT NULL  -- Service-level groupings only\n",
        "    AND h.team = :team\n",
        "    -- Look at last 30 days to capture all recently accessed services\n",
        "    AND u.date >= DATE_SUB((SELECT MAX(date) FROM product_analytics_staging.agg_table_usage_rolling WHERE date BETWEEN :date.min AND :date.max), 29)\n",
        ")\n",
        "SELECT \n",
        "  CAST(date AS DATE) AS date,\n",
        "  region,\n",
        "  service,\n",
        "  product_group,\n",
        "  dataplatform_feature,\n",
        "  monthly_users,\n",
        "  monthly_queries,\n",
        "  avg_queries_per_user,\n",
        "  monthly_users / SUM(monthly_users) OVER () AS percent_of_users,\n",
        "  -- Quick navigation links (service = database.table format)\n",
        "  CONCAT('https://datahub.internal.samsara.com/dataset/urn:li:dataset:(urn:li:dataPlatform:databricks,', service, ',PROD)/Schema') AS datahub_url,\n",
        "  CONCAT('https://dagster.internal.samsara.com/assets/', region, '/', REPLACE(service, '.', '/')) AS dagster_url\n",
        "FROM recent_activity\n",
        "WHERE rn = 1  -- Take most recent row for each service\n",
        "ORDER BY monthly_users DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        },
        {
          "displayName": "li",
          "keyword": "li",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataset",
          "keyword": "dataset",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataPlatform",
          "keyword": "dataPlatform",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "databricks",
          "keyword": "databricks",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "fe905fe2",
      "displayName": "queries.usage.tables.unused_tables",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Tables\n",
        "-- View: Unused Tables\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Unused Tables (Deprecation Candidates)\"\n",
        "-- Description: Tables with no queries in the selected date range.\n",
        "--              Good candidates for archival or cost reduction.\n",
        "-- =============================================================================\n",
        "\n",
        "WITH team_tables AS (\n",
        "  -- Get all tables owned by the team from dim_tables\n",
        "  SELECT DISTINCT\n",
        "    table_id,\n",
        "    region,\n",
        "    database,\n",
        "    `table`\n",
        "  FROM product_analytics_staging.dim_tables\n",
        "  WHERE date = (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max)\n",
        "    AND team = :team\n",
        "),\n",
        "\n",
        "-- Aggregate usage from fact table\n",
        "recent_usage AS (\n",
        "  SELECT\n",
        "    q.table_id,\n",
        "    SUM(q.query_count) AS total_queries,\n",
        "    COUNT(DISTINCT q.employee_id) AS total_users,\n",
        "    MAX(q.date) AS last_query_date\n",
        "  FROM product_analytics_staging.fct_table_user_queries q\n",
        "  WHERE q.date BETWEEN :date.min AND :date.max\n",
        "  GROUP BY q.table_id\n",
        ")\n",
        "\n",
        "-- Find tables with no usage (LEFT JOIN to find tables with no queries)\n",
        "SELECT\n",
        "  t.region,\n",
        "  t.database,\n",
        "  t.`table`,\n",
        "  COALESCE(u.total_queries, 0) AS total_queries,\n",
        "  COALESCE(u.total_users, 0) AS total_users,\n",
        "  CAST(u.last_query_date AS DATE) AS last_query_date,\n",
        "  DATEDIFF(CURRENT_DATE(), u.last_query_date) AS days_since_last_query,\n",
        "  -- Quick navigation links\n",
        "  CONCAT('https://datahub.internal.samsara.com/dataset/urn:li:dataset:(urn:li:dataPlatform:databricks,', t.database, '.', t.`table`, ',PROD)/Schema') AS datahub_url,\n",
        "  CONCAT('https://dagster.internal.samsara.com/assets/', t.region, '/', t.database, '/', t.`table`) AS dagster_url\n",
        "FROM team_tables t\n",
        "LEFT JOIN recent_usage u\n",
        "  USING (table_id)\n",
        "WHERE u.total_queries IS NULL\n",
        "   OR u.total_queries = 0\n",
        "ORDER BY t.database, t.`table`\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        },
        {
          "displayName": "li",
          "keyword": "li",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataset",
          "keyword": "dataset",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataPlatform",
          "keyword": "dataPlatform",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "databricks",
          "keyword": "databricks",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "11884c3d",
      "displayName": "queries.usage.engagement.platform_power_users",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: User Analytics - Platform Engagement\n",
        "-- View: Power Users of Team Tables\n",
        "-- =============================================================================\n",
        "-- Visualization: Table with tier badges\n",
        "-- Title: \"Power Users of FirmwareVDP Tables\"\n",
        "-- Description: Users ranked by their usage of tables owned by the selected team.\n",
        "--              Pure star schema: joins fact to dim_tables and employee_hierarchy.\n",
        "--\n",
        "-- Annotations:\n",
        "--   - SUPER_USER: Top 5% by total_queries\n",
        "--   - POWER_USER: Top 10% (P90-P95)\n",
        "--   - ACTIVE_USER: Top 25% (P75-P90)\n",
        "--   - REGULAR: Bottom 75%\n",
        "-- =============================================================================\n",
        "\n",
        "-- Subtract 1 day from max to ensure complete data\n",
        "WITH latest_date AS (\n",
        "  SELECT MAX(date) AS max_date\n",
        "  FROM product_analytics_staging.fct_table_user_queries\n",
        "  WHERE date BETWEEN :date.min AND DATE_SUB(CAST(:date.max AS DATE), 1)\n",
        "),\n",
        "\n",
        "-- Aggregate user activity on team-owned tables (last 30 days)\n",
        "-- Join to both dimensions for filtering and attributes\n",
        "user_activity AS (\n",
        "  SELECT \n",
        "    e.employee_email,\n",
        "    e.job_family_group,\n",
        "    e.job_family,\n",
        "    e.department,\n",
        "    SUM(q.query_count) AS total_queries,\n",
        "    COUNT(DISTINCT q.table_id) AS unique_tables,\n",
        "    COUNT(DISTINCT q.date) AS active_days\n",
        "  FROM product_analytics_staging.fct_table_user_queries q\n",
        "  JOIN product_analytics_staging.dim_tables t USING (date, table_id)\n",
        "  JOIN edw.silver.employee_hierarchy_active_vw e ON q.employee_id = e.employee_id\n",
        "  WHERE q.date BETWEEN DATE_SUB((SELECT max_date FROM latest_date), 29) AND (SELECT max_date FROM latest_date)\n",
        "    AND t.team = :team\n",
        "  GROUP BY e.employee_email, e.job_family_group, e.job_family, e.department\n",
        "  HAVING SUM(q.query_count) > 0\n",
        "),\n",
        "\n",
        "percentiles AS (\n",
        "  SELECT \n",
        "    PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY total_queries) AS p75,\n",
        "    PERCENTILE_CONT(0.90) WITHIN GROUP (ORDER BY total_queries) AS p90,\n",
        "    PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY total_queries) AS p95\n",
        "  FROM user_activity\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  ROW_NUMBER() OVER (ORDER BY u.total_queries DESC) AS rank,\n",
        "  u.employee_email,\n",
        "  u.department,\n",
        "  u.job_family,\n",
        "  u.job_family_group,\n",
        "  u.total_queries,\n",
        "  u.unique_tables,\n",
        "  u.active_days,\n",
        "  ROUND(u.total_queries * 1.0 / NULLIF(u.active_days, 0), 1) AS queries_per_day,\n",
        "  CASE \n",
        "    WHEN u.total_queries >= p.p95 THEN 'SUPER_USER'\n",
        "    WHEN u.total_queries >= p.p90 THEN 'POWER_USER'\n",
        "    WHEN u.total_queries >= p.p75 THEN 'ACTIVE_USER'\n",
        "    ELSE 'REGULAR'\n",
        "  END AS user_tier,\n",
        "  ROUND(PERCENT_RANK() OVER (ORDER BY u.total_queries) * 100, 1) AS percentile_rank\n",
        "FROM user_activity u\n",
        "CROSS JOIN percentiles p\n",
        "ORDER BY u.total_queries DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "43dcf09a",
      "displayName": "queries.usage.engagement.platform_engagement_scores",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: User Analytics - Platform Engagement\n",
        "-- View: Engagement Scores (Team Tables)\n",
        "-- =============================================================================\n",
        "-- Visualization: Scatter plot + table\n",
        "-- Title: \"User Engagement Scores for FirmwareVDP Tables\"\n",
        "-- Description: Engagement scores based on usage of team-owned tables.\n",
        "--              Score combines query volume, breadth (unique tables), and recency.\n",
        "--\n",
        "-- Scatter Plot:\n",
        "--   X-Axis: volume_score (0-1)\n",
        "--   Y-Axis: breadth_score (0-1)\n",
        "--   Point Size: engagement_score\n",
        "--   Color: engagement_tier\n",
        "-- =============================================================================\n",
        "\n",
        "-- Subtract 1 day from max to ensure complete data\n",
        "WITH latest_date AS (\n",
        "  SELECT MAX(date) AS max_date\n",
        "  FROM product_analytics_staging.fct_table_user_queries\n",
        "  WHERE date BETWEEN :date.min AND DATE_SUB(CAST(:date.max AS DATE), 1)\n",
        "),\n",
        "\n",
        "-- Aggregate user activity on team-owned tables (last 30 days)\n",
        "-- Join to both dimensions for filtering and attributes\n",
        "user_activity AS (\n",
        "  SELECT \n",
        "    e.employee_email,\n",
        "    e.job_family_group,\n",
        "    e.job_family,\n",
        "    e.department,\n",
        "    SUM(q.query_count) AS total_queries,\n",
        "    COUNT(DISTINCT q.table_id) AS unique_tables,\n",
        "    COUNT(DISTINCT q.date) AS active_days\n",
        "  FROM product_analytics_staging.fct_table_user_queries q\n",
        "  JOIN product_analytics_staging.dim_tables t USING (date, table_id)\n",
        "  JOIN edw.silver.employee_hierarchy_active_vw e ON q.employee_id = e.employee_id\n",
        "  WHERE q.date BETWEEN DATE_SUB((SELECT max_date FROM latest_date), 29) AND (SELECT max_date FROM latest_date)\n",
        "    AND t.team = :team\n",
        "  GROUP BY e.employee_email, e.job_family_group, e.job_family, e.department\n",
        "  HAVING SUM(q.query_count) > 0\n",
        "),\n",
        "\n",
        "max_values AS (\n",
        "  SELECT \n",
        "    MAX(total_queries) AS max_queries,\n",
        "    MAX(unique_tables) AS max_tables,\n",
        "    MAX(active_days) AS max_active_days\n",
        "  FROM user_activity\n",
        "),\n",
        "\n",
        "user_scores AS (\n",
        "  SELECT \n",
        "    u.*,\n",
        "    -- Normalized scores (0-1)\n",
        "    u.total_queries * 1.0 / NULLIF(m.max_queries, 0) AS volume_score,\n",
        "    u.unique_tables * 1.0 / NULLIF(m.max_tables, 0) AS breadth_score,\n",
        "    u.active_days * 1.0 / NULLIF(m.max_active_days, 0) AS recency_score\n",
        "  FROM user_activity u\n",
        "  CROSS JOIN max_values m\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  employee_email,\n",
        "  department,\n",
        "  job_family,\n",
        "  job_family_group,\n",
        "  \n",
        "  -- Component scores (0-1, UI formats as percentage)\n",
        "  ROUND(volume_score, 3) AS volume_score,\n",
        "  ROUND(breadth_score, 3) AS breadth_score,\n",
        "  ROUND(recency_score, 3) AS recency_score,\n",
        "  \n",
        "  -- Weighted engagement score (0-1):\n",
        "  -- Recency (40%) + Frequency/Volume (30%) + Breadth (30%)\n",
        "  ROUND(\n",
        "    recency_score * 0.40 +\n",
        "    volume_score * 0.30 +\n",
        "    breadth_score * 0.30,\n",
        "    3\n",
        "  ) AS engagement_score,\n",
        "  \n",
        "  -- Raw metrics\n",
        "  total_queries,\n",
        "  unique_tables,\n",
        "  active_days,\n",
        "  \n",
        "  -- Engagement tier (thresholds: >0.70 HIGH, >=0.40 MEDIUM, else LOW)\n",
        "  CASE \n",
        "    WHEN (recency_score * 0.40 + volume_score * 0.30 + breadth_score * 0.30) > 0.70 THEN 'HIGH_ENGAGEMENT'\n",
        "    WHEN (recency_score * 0.40 + volume_score * 0.30 + breadth_score * 0.30) >= 0.40 THEN 'MEDIUM_ENGAGEMENT'\n",
        "    ELSE 'LOW_ENGAGEMENT'\n",
        "  END AS engagement_tier\n",
        "\n",
        "FROM user_scores\n",
        "ORDER BY engagement_score DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "6c39e90c",
      "displayName": "queries.usage.engagement.dashboard_usage",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Engagement\n",
        "-- View: FirmwareVDP Dashboard Usage\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart\n",
        "-- Title: \"Dashboard Usage Over Time\"\n",
        "-- Description: Daily event count per dashboard. Track engagement trends and\n",
        "--              identify usage patterns.\n",
        "--\n",
        "-- X-axis: date\n",
        "-- Y-axis: events (count)\n",
        "-- Series: dashboard_title (color by)\n",
        "-- =============================================================================\n",
        "\n",
        "WITH dashboard_metadata AS (\n",
        "  SELECT\n",
        "    dashboard_id,\n",
        "    dashboard_title\n",
        "  FROM (VALUES\n",
        "    ('01f0a83a866f1de78da43e4d779640b4', 'Trace Explorer'),\n",
        "    ('01f02d133db1173a8ba26f8bba1cdc35', 'Coverage'),\n",
        "    ('01efd424550c107aae9d8c7edcebff18', 'Data Dashboard'),\n",
        "    ('01efbcc3b2181e5688194ba2d0f7100c', 'Release Qualifier'),\n",
        "    ('01f0d1bfc7271cb9939bccb49eb3d88e', 'Signal Promotion Service V2'),\n",
        "    ('01f0bb572dd2117e8e477d9b5e05755c', 'DCE Program Metrics'),\n",
        "    ('01f0d106fa4613bfbe3d376d3e89ecf2', 'Cost Dashboard V2'),\n",
        "    ('01f0c03521bb16419b4e8f0cce0ff67d', 'Automotive On-Call Dashboard')\n",
        "  ) AS t(dashboard_id, dashboard_title)\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  CAST(e.date AS DATE) AS date,\n",
        "  m.dashboard_title,\n",
        "  COUNT(*) AS events,\n",
        "  COUNT(DISTINCT e.user_email) AS unique_users\n",
        "FROM auditlog.fct_databricks_dashboard_events e\n",
        "JOIN dashboard_metadata m\n",
        "  USING (dashboard_id)\n",
        "WHERE e.date BETWEEN :date.min AND :date.max\n",
        "GROUP BY e.date, m.dashboard_title\n",
        "ORDER BY date DESC, events DESC\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "cdff51fc",
      "displayName": "queries.usage.engagement.dashboard_weekly_trends",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Engagement\n",
        "-- View: Dashboard Weekly Trends\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart (multi-series)\n",
        "-- Title: \"Weekly Dashboard Activity\"\n",
        "-- Description: Track dashboard engagement trends by week. Useful for spotting\n",
        "--              adoption patterns, seasonal usage, and the impact of updates.\n",
        "--\n",
        "-- X-axis: week\n",
        "-- Y-axis: events / unique_users (dual axis or separate charts)\n",
        "-- Series: dashboard_title (color by)\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Mark dashboard release dates or major updates\n",
        "-- =============================================================================\n",
        "\n",
        "WITH dashboard_metadata AS (\n",
        "  SELECT\n",
        "    dashboard_id,\n",
        "    dashboard_title\n",
        "  FROM (VALUES\n",
        "    ('01f0a83a866f1de78da43e4d779640b4', 'Trace Explorer'),\n",
        "    ('01f02d133db1173a8ba26f8bba1cdc35', 'Coverage'),\n",
        "    ('01efd424550c107aae9d8c7edcebff18', 'Data Dashboard'),\n",
        "    ('01efbcc3b2181e5688194ba2d0f7100c', 'Release Qualifier'),\n",
        "    ('01f0d1bfc7271cb9939bccb49eb3d88e', 'Signal Promotion Service V2'),\n",
        "    ('01f0bb572dd2117e8e477d9b5e05755c', 'DCE Program Metrics'),\n",
        "    ('01f0d106fa4613bfbe3d376d3e89ecf2', 'Cost Dashboard V2'),\n",
        "    ('01f0c03521bb16419b4e8f0cce0ff67d', 'Automotive On-Call Dashboard')\n",
        "  ) AS t(dashboard_id, dashboard_title)\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  CAST(DATE_TRUNC('week', e.date) AS DATE) AS week,\n",
        "  m.dashboard_title,\n",
        "  COUNT(*) AS events,\n",
        "  COUNT(DISTINCT e.user_email) AS unique_users,\n",
        "  COUNT(DISTINCT e.date) AS active_days,\n",
        "  -- Week-over-week comparison\n",
        "  ROUND(COUNT(*) / 7.0, 1) AS avg_daily_events\n",
        "FROM auditlog.fct_databricks_dashboard_events e\n",
        "JOIN dashboard_metadata m\n",
        "  USING (dashboard_id)\n",
        "WHERE e.date BETWEEN :date.min AND :date.max\n",
        "GROUP BY 1, 2\n",
        "ORDER BY week DESC, events DESC\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "79644ce0",
      "displayName": "queries.usage.engagement.dashboard_top_users",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Engagement\n",
        "-- View: Top Dashboard Users\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Top Users by Dashboard\"\n",
        "-- Description: Ranked list of most active users per dashboard. Identifies power\n",
        "--              users and helps understand adoption patterns.\n",
        "--\n",
        "-- Table Columns:\n",
        "--   - dashboard_title, user_email, event_count, rank, dashboard_url\n",
        "--\n",
        "-- Use Case: Identify champions, find users to interview for feedback,\n",
        "--           spot potential training needs for low-engagement users\n",
        "-- =============================================================================\n",
        "\n",
        "WITH dashboard_metadata AS (\n",
        "  SELECT\n",
        "    dashboard_id,\n",
        "    dashboard_title,\n",
        "    dashboard_url\n",
        "  FROM (VALUES\n",
        "    ('01f0a83a866f1de78da43e4d779640b4', 'Trace Explorer', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f0a83a866f1de78da43e4d779640b4/published?o=5924096274798303'),\n",
        "    ('01f02d133db1173a8ba26f8bba1cdc35', 'Coverage', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f02d133db1173a8ba26f8bba1cdc35/published?o=5924096274798303'),\n",
        "    ('01efd424550c107aae9d8c7edcebff18', 'Data Dashboard', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01efd424550c107aae9d8c7edcebff18/published?o=5924096274798303'),\n",
        "    ('01efbcc3b2181e5688194ba2d0f7100c', 'Release Qualifier', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01efbcc3b2181e5688194ba2d0f7100c/published?o=5924096274798303'),\n",
        "    ('01f0d1bfc7271cb9939bccb49eb3d88e', 'Signal Promotion Service V2', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f0d1bfc7271cb9939bccb49eb3d88e/published?o=5924096274798303'),\n",
        "    ('01f0bb572dd2117e8e477d9b5e05755c', 'DCE Program Metrics', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f0bb572dd2117e8e477d9b5e05755c/published?o=5924096274798303'),\n",
        "    ('01f0d106fa4613bfbe3d376d3e89ecf2', 'Cost Dashboard V2', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f0d106fa4613bfbe3d376d3e89ecf2/published?o=5924096274798303'),\n",
        "    ('01f0c03521bb16419b4e8f0cce0ff67d', 'Automotive On-Call Dashboard', 'https://samsara-dev-us-west-2.cloud.databricks.com/dashboardsv3/01f0c03521bb16419b4e8f0cce0ff67d/published?o=5924096274798303')\n",
        "  ) AS t(dashboard_id, dashboard_title, dashboard_url)\n",
        "),\n",
        "\n",
        "user_counts AS (\n",
        "  SELECT\n",
        "    e.dashboard_id,\n",
        "    e.user_email,\n",
        "    COUNT(*) AS event_count,\n",
        "    COUNT(DISTINCT e.date) AS active_days,\n",
        "    CAST(MAX(e.date) AS DATE) AS last_active\n",
        "  FROM auditlog.fct_databricks_dashboard_events e\n",
        "  WHERE e.date BETWEEN :date.min AND :date.max\n",
        "    AND e.dashboard_id IN (\n",
        "      '01f0a83a866f1de78da43e4d779640b4',\n",
        "      '01f02d133db1173a8ba26f8bba1cdc35',\n",
        "      '01efd424550c107aae9d8c7edcebff18',\n",
        "      '01efbcc3b2181e5688194ba2d0f7100c',\n",
        "      '01f0d1bfc7271cb9939bccb49eb3d88e',\n",
        "      '01f0bb572dd2117e8e477d9b5e05755c',\n",
        "      '01f0d106fa4613bfbe3d376d3e89ecf2',\n",
        "      '01f0c03521bb16419b4e8f0cce0ff67d'\n",
        "    )\n",
        "  GROUP BY e.dashboard_id, e.user_email\n",
        "),\n",
        "\n",
        "ranked AS (\n",
        "  SELECT\n",
        "    *,\n",
        "    RANK() OVER (PARTITION BY dashboard_id ORDER BY event_count DESC) AS user_rank\n",
        "  FROM user_counts\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  m.dashboard_title,\n",
        "  r.user_email,\n",
        "  r.event_count,\n",
        "  r.active_days,\n",
        "  r.last_active,\n",
        "  r.user_rank,\n",
        "  m.dashboard_url\n",
        "FROM ranked r\n",
        "JOIN dashboard_metadata m\n",
        "  USING (dashboard_id)\n",
        "WHERE r.user_rank <= 10  -- Top 10 users per dashboard\n",
        "ORDER BY m.dashboard_title, r.user_rank\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "25c25516",
      "displayName": "queries.usage.engagement.dashboard_overall_top_users",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Engagement\n",
        "-- View: Overall Top Dashboard Users\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Top Users Across All Dashboards\"\n",
        "-- Description: Ranked list of most active users across all tracked dashboards.\n",
        "--              Identifies power users who engage with multiple dashboards.\n",
        "--\n",
        "-- Table Columns:\n",
        "--   - user_email, total_events, dashboards_used, active_days, most_used_dashboard, rank\n",
        "--\n",
        "-- Use Case: Find data champions, potential trainers, users for feedback\n",
        "-- =============================================================================\n",
        "\n",
        "WITH dashboard_metadata AS (\n",
        "  SELECT\n",
        "    dashboard_id,\n",
        "    dashboard_title\n",
        "  FROM (VALUES\n",
        "    ('01f0a83a866f1de78da43e4d779640b4', 'Trace Explorer'),\n",
        "    ('01f02d133db1173a8ba26f8bba1cdc35', 'Coverage'),\n",
        "    ('01efd424550c107aae9d8c7edcebff18', 'Data Dashboard'),\n",
        "    ('01efbcc3b2181e5688194ba2d0f7100c', 'Release Qualifier'),\n",
        "    ('01f0d1bfc7271cb9939bccb49eb3d88e', 'Signal Promotion Service V2'),\n",
        "    ('01f0bb572dd2117e8e477d9b5e05755c', 'DCE Program Metrics'),\n",
        "    ('01f0d106fa4613bfbe3d376d3e89ecf2', 'Cost Dashboard V2'),\n",
        "    ('01f0c03521bb16419b4e8f0cce0ff67d', 'Automotive On-Call Dashboard')\n",
        "  ) AS t(dashboard_id, dashboard_title)\n",
        "),\n",
        "\n",
        "-- Per-user-per-dashboard event counts\n",
        "user_dashboard_counts AS (\n",
        "  SELECT\n",
        "    e.user_email,\n",
        "    e.dashboard_id,\n",
        "    m.dashboard_title,\n",
        "    COUNT(*) AS events_per_dashboard\n",
        "  FROM auditlog.fct_databricks_dashboard_events e\n",
        "  JOIN dashboard_metadata m\n",
        "    USING (dashboard_id)\n",
        "  WHERE e.date BETWEEN :date.min AND :date.max\n",
        "  GROUP BY e.user_email, e.dashboard_id, m.dashboard_title\n",
        "),\n",
        "\n",
        "-- Active days per user (from original events, not a constant)\n",
        "user_active_days AS (\n",
        "  SELECT\n",
        "    e.user_email,\n",
        "    COUNT(DISTINCT e.date) AS active_days\n",
        "  FROM auditlog.fct_databricks_dashboard_events e\n",
        "  JOIN dashboard_metadata m\n",
        "    USING (dashboard_id)\n",
        "  WHERE e.date BETWEEN :date.min AND :date.max\n",
        "  GROUP BY e.user_email\n",
        "),\n",
        "\n",
        "-- Most-used dashboard per user (using ROW_NUMBER to pick top)\n",
        "user_most_used AS (\n",
        "  SELECT\n",
        "    user_email,\n",
        "    dashboard_title AS most_used_dashboard\n",
        "  FROM (\n",
        "    SELECT\n",
        "      user_email,\n",
        "      dashboard_title,\n",
        "      ROW_NUMBER() OVER (PARTITION BY user_email ORDER BY events_per_dashboard DESC) AS rn\n",
        "    FROM user_dashboard_counts\n",
        "  )\n",
        "  WHERE rn = 1\n",
        "),\n",
        "\n",
        "-- Aggregate to user level (GROUP BY only user_email)\n",
        "user_totals AS (\n",
        "  SELECT\n",
        "    user_email,\n",
        "    SUM(events_per_dashboard) AS total_events,\n",
        "    COUNT(DISTINCT dashboard_id) AS dashboards_used\n",
        "  FROM user_dashboard_counts\n",
        "  GROUP BY user_email\n",
        "),\n",
        "\n",
        "-- Combine all user metrics\n",
        "user_summary AS (\n",
        "  SELECT\n",
        "    t.user_email,\n",
        "    t.total_events,\n",
        "    t.dashboards_used,\n",
        "    a.active_days,\n",
        "    m.most_used_dashboard\n",
        "  FROM user_totals t\n",
        "  JOIN user_active_days a USING (user_email)\n",
        "  JOIN user_most_used m USING (user_email)\n",
        "),\n",
        "\n",
        "ranked AS (\n",
        "  SELECT\n",
        "    *,\n",
        "    RANK() OVER (ORDER BY total_events DESC) AS user_rank\n",
        "  FROM user_summary\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  user_email,\n",
        "  total_events,\n",
        "  dashboards_used,\n",
        "  active_days,\n",
        "  most_used_dashboard,\n",
        "  user_rank\n",
        "FROM ranked\n",
        "WHERE user_rank <= 25  -- Top 25 users overall\n",
        "ORDER BY user_rank\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "35893731",
      "displayName": "queries.usage.engagement.dashboard_actions_breakdown",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Usage - Engagement\n",
        "-- View: Dashboard Actions Breakdown\n",
        "-- =============================================================================\n",
        "-- Visualization: Bar Chart (stacked) + Table\n",
        "-- Title: \"Dashboard Events by Action Type\"\n",
        "-- Description: Understand what users are doing with dashboards. Views vs edits\n",
        "--              vs exports helps gauge engagement depth and identify use patterns.\n",
        "--\n",
        "-- Chart: Stacked bar chart, x=action_name, y=count, color=dashboard_title\n",
        "-- Table: action_name, count, percent_of_total\n",
        "--\n",
        "-- Action types from Databricks audit logs:\n",
        "--   - getPublishedDashboard (view published)\n",
        "--   - getDashboard (view draft)\n",
        "--   - updateDashboard (edit)\n",
        "--   - cloneDashboard (copy)\n",
        "--   - runQuery (execute query in dashboard)\n",
        "--   - etc.\n",
        "-- =============================================================================\n",
        "\n",
        "WITH dashboard_metadata AS (\n",
        "  SELECT\n",
        "    dashboard_id,\n",
        "    dashboard_title\n",
        "  FROM (VALUES\n",
        "    ('01f0a83a866f1de78da43e4d779640b4', 'Trace Explorer'),\n",
        "    ('01f02d133db1173a8ba26f8bba1cdc35', 'Coverage'),\n",
        "    ('01efd424550c107aae9d8c7edcebff18', 'Data Dashboard'),\n",
        "    ('01efbcc3b2181e5688194ba2d0f7100c', 'Release Qualifier'),\n",
        "    ('01f0d1bfc7271cb9939bccb49eb3d88e', 'Signal Promotion Service V2'),\n",
        "    ('01f0bb572dd2117e8e477d9b5e05755c', 'DCE Program Metrics'),\n",
        "    ('01f0d106fa4613bfbe3d376d3e89ecf2', 'Cost Dashboard V2'),\n",
        "    ('01f0c03521bb16419b4e8f0cce0ff67d', 'Automotive On-Call Dashboard')\n",
        "  ) AS t(dashboard_id, dashboard_title)\n",
        "),\n",
        "\n",
        "action_counts AS (\n",
        "  SELECT\n",
        "    e.action_name,\n",
        "    m.dashboard_title,\n",
        "    COUNT(*) AS event_count,\n",
        "    COUNT(DISTINCT e.user_email) AS unique_users\n",
        "  FROM auditlog.fct_databricks_dashboard_events e\n",
        "  JOIN dashboard_metadata m\n",
        "    USING (dashboard_id)\n",
        "  WHERE e.date BETWEEN :date.min AND :date.max\n",
        "  GROUP BY e.action_name, m.dashboard_title\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  action_name,\n",
        "  dashboard_title,\n",
        "  event_count,\n",
        "  unique_users,\n",
        "  -- Calculate percent of total for this dashboard (0-1 range for UI percent formatting)\n",
        "  ROUND(event_count * 1.0 / SUM(event_count) OVER (PARTITION BY dashboard_title), 4) AS percent_of_dashboard,\n",
        "  -- Calculate percent of total across all dashboards\n",
        "  ROUND(event_count * 1.0 / SUM(event_count) OVER (), 4) AS percent_of_total\n",
        "FROM action_counts\n",
        "ORDER BY event_count DESC\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        }
      ]
    },
    {
      "name": "75c178b6",
      "displayName": "queries.reliability.overview.reliability_snapshot",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Reliability Overview\n",
        "-- View: Reliability Snapshot\n",
        "-- =============================================================================\n",
        "-- Visualization: Scorecards (4-6 cards)\n",
        "-- Title: \"Data Reliability At-a-Glance\"\n",
        "-- Purpose: Quick health check - are our tables fresh and landing on time?\n",
        "--\n",
        "-- Scorecards:\n",
        "--   1. \"Tables Tracked\" - total_tables (count)\n",
        "--   2. \"Fresh\" - fresh_tables (count, color: green)\n",
        "--   3. \"Warning\" - warning_tables (count, color: yellow)\n",
        "--   4. \"Stale\" - stale_tables (count, color: red)\n",
        "--   5. \"2-Day SLA %\" - pct_meeting_2d_sla (%, target: >95%)\n",
        "--   6. \"Avg Latency\" - avg_latency_days (days, target: <1.0)\n",
        "--\n",
        "-- Annotations:\n",
        "--   - Color code scorecards based on status (green/yellow/red)\n",
        "--   - Show delta vs previous period where applicable\n",
        "-- =============================================================================\n",
        "\n",
        "-- Latest day snapshot for scorecards (filtered to firmwarevdp-owned tables)\n",
        "-- Use the MINIMUM of max dates across tables to ensure joins work\n",
        "WITH max_dates AS (\n",
        "  SELECT \n",
        "    (SELECT MAX(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max) AS reliability_max,\n",
        "    (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max) AS tables_max\n",
        "),\n",
        "common_date AS (\n",
        "  SELECT LEAST(reliability_max, tables_max) AS max_date\n",
        "  FROM max_dates\n",
        "),\n",
        "-- Get firmwarevdp-owned tables from dim_tables\n",
        "owned_tables AS (\n",
        "  SELECT DISTINCT\n",
        "    t.date,\n",
        "    t.table_id\n",
        "  FROM product_analytics_staging.dim_tables t\n",
        "  WHERE t.date = (SELECT max_date FROM common_date)\n",
        "    AND t.team = :team\n",
        ")\n",
        "SELECT \n",
        "  CAST(r.date AS DATE) AS date,\n",
        "  \n",
        "  -- Table health counts (freshness_status stored as plain text)\n",
        "  COUNT(*) AS total_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'FRESH' THEN 1 ELSE 0 END) AS fresh_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'WARNING' THEN 1 ELSE 0 END) AS warning_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'STALE' THEN 1 ELSE 0 END) AS stale_tables,\n",
        "  \n",
        "  -- Percentages (0-1 range for UI percent formatting)\n",
        "  ROUND(SUM(CASE WHEN r.freshness_status = 'FRESH' THEN 1 ELSE 0 END) * 1.0 / COUNT(*), 4) AS pct_fresh,\n",
        "  ROUND(SUM(CASE WHEN r.freshness_status = 'STALE' THEN 1 ELSE 0 END) * 1.0 / COUNT(*), 4) AS pct_stale,\n",
        "  \n",
        "  -- SLA compliance (30-day rolling, 0-1 range)\n",
        "  ROUND(AVG(r.monthly.pct_meeting_1d_sla), 4) AS pct_meeting_1d_sla,\n",
        "  ROUND(AVG(r.monthly.pct_meeting_2d_sla), 4) AS pct_meeting_2d_sla,\n",
        "  \n",
        "  -- Latency (30-day rolling)\n",
        "  ROUND(AVG(r.monthly.avg_latency_days), 2) AS avg_latency_days,\n",
        "  MAX(r.monthly.max_latency_days) AS max_latency_days,\n",
        "  \n",
        "  -- Volume\n",
        "  SUM(r.monthly.partitions_landed) AS partitions_landed_30d\n",
        "\n",
        "FROM owned_tables o\n",
        "JOIN product_analytics_staging.agg_landing_reliability_rolling r\n",
        "  USING (date, table_id)\n",
        "GROUP BY r.date\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "3ca3763f",
      "displayName": "queries.reliability.overview.reliability_trend",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Reliability Overview\n",
        "-- View: Reliability Trend\n",
        "-- =============================================================================\n",
        "-- Visualization: Line Chart (multi-series)\n",
        "-- Title: \"Data Reliability Over Time\"\n",
        "-- Purpose: Track reliability metrics across the selected date range to identify\n",
        "--          trends, improvements, or degradations in data freshness.\n",
        "--\n",
        "-- X-axis: date\n",
        "-- Y-axis: percentage / count\n",
        "-- Series: pct_fresh, pct_meeting_2d_sla, avg_latency_days\n",
        "--\n",
        "-- Use Case: See how reliability changes day-over-day, catch degradation early\n",
        "-- =============================================================================\n",
        "\n",
        "-- Daily reliability metrics for firmwarevdp-owned tables\n",
        "-- Use date bounds to ensure joins work across both tables\n",
        "WITH date_bounds AS (\n",
        "  SELECT\n",
        "    GREATEST(\n",
        "      (SELECT MIN(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max),\n",
        "      (SELECT MIN(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max)\n",
        "    ) AS min_date,\n",
        "    LEAST(\n",
        "      (SELECT MAX(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max),\n",
        "      (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max)\n",
        "    ) AS max_date\n",
        "),\n",
        "\n",
        "-- Get firmwarevdp-owned tables for each date\n",
        "owned_tables AS (\n",
        "  SELECT\n",
        "    t.date,\n",
        "    t.table_id\n",
        "  FROM product_analytics_staging.dim_tables t\n",
        "  WHERE t.date BETWEEN (SELECT min_date FROM date_bounds) AND (SELECT max_date FROM date_bounds)\n",
        "    AND t.team = :team\n",
        ")\n",
        "\n",
        "SELECT \n",
        "  CAST(r.date AS DATE) AS date,\n",
        "  \n",
        "  -- Table health counts\n",
        "  COUNT(*) AS total_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'FRESH' THEN 1 ELSE 0 END) AS fresh_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'WARNING' THEN 1 ELSE 0 END) AS warning_tables,\n",
        "  SUM(CASE WHEN r.freshness_status = 'STALE' THEN 1 ELSE 0 END) AS stale_tables,\n",
        "  \n",
        "  -- Percentages (0-1 range for UI percent formatting)\n",
        "  ROUND(SUM(CASE WHEN r.freshness_status = 'FRESH' THEN 1 ELSE 0 END) * 1.0 / COUNT(*), 4) AS pct_fresh,\n",
        "  ROUND(SUM(CASE WHEN r.freshness_status = 'STALE' THEN 1 ELSE 0 END) * 1.0 / COUNT(*), 4) AS pct_stale,\n",
        "  \n",
        "  -- SLA compliance (30-day rolling averages, 0-1 range)\n",
        "  ROUND(AVG(r.monthly.pct_meeting_1d_sla), 4) AS pct_meeting_1d_sla,\n",
        "  ROUND(AVG(r.monthly.pct_meeting_2d_sla), 4) AS pct_meeting_2d_sla,\n",
        "  \n",
        "  -- Latency metrics\n",
        "  ROUND(AVG(r.monthly.avg_latency_days), 2) AS avg_latency_days,\n",
        "  MAX(r.monthly.max_latency_days) AS max_latency_days,\n",
        "  \n",
        "  -- Volume\n",
        "  SUM(r.monthly.partitions_landed) AS partitions_landed_30d\n",
        "\n",
        "FROM owned_tables o\n",
        "JOIN product_analytics_staging.agg_landing_reliability_rolling r\n",
        "  USING (date, table_id)\n",
        "GROUP BY r.date\n",
        "ORDER BY r.date DESC\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "fd060c59",
      "displayName": "queries.reliability.overview.reliability_worst_offenders",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Reliability Overview\n",
        "-- View: Worst Offenders\n",
        "-- =============================================================================\n",
        "-- Visualization: Table\n",
        "-- Title: \"Tables with Poorest Reliability\"\n",
        "-- Purpose: Identify tables that consistently underperform on reliability metrics\n",
        "--          over the selected time span. Prioritize remediation efforts.\n",
        "--\n",
        "-- Table Columns:\n",
        "--   - database, table, avg_pct_meeting_2d_sla, days_stale, avg_latency_days\n",
        "--\n",
        "-- Use Case: Find tables needing attention, track problematic patterns\n",
        "-- =============================================================================\n",
        "\n",
        "-- Aggregate reliability metrics per table over the entire date range\n",
        "WITH date_bounds AS (\n",
        "  SELECT\n",
        "    GREATEST(\n",
        "      (SELECT MIN(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max),\n",
        "      (SELECT MIN(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max)\n",
        "    ) AS min_date,\n",
        "    LEAST(\n",
        "      (SELECT MAX(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max),\n",
        "      (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max)\n",
        "    ) AS max_date\n",
        "),\n",
        "\n",
        "-- Get firmwarevdp-owned tables with their attributes\n",
        "owned_tables AS (\n",
        "  SELECT\n",
        "    t.date,\n",
        "    t.table_id,\n",
        "    t.region,\n",
        "    t.database,\n",
        "    t.`table`\n",
        "  FROM product_analytics_staging.dim_tables t\n",
        "  WHERE t.date BETWEEN (SELECT min_date FROM date_bounds) AND (SELECT max_date FROM date_bounds)\n",
        "    AND t.team = :team\n",
        "),\n",
        "\n",
        "-- Aggregate reliability metrics per table\n",
        "table_reliability AS (\n",
        "  SELECT\n",
        "    o.database,\n",
        "    o.`table`,\n",
        "    o.region,\n",
        "    \n",
        "    -- Count metrics\n",
        "    COUNT(DISTINCT o.date) AS days_tracked,\n",
        "    SUM(CASE WHEN r.freshness_status = 'STALE' THEN 1 ELSE 0 END) AS days_stale,\n",
        "    SUM(CASE WHEN r.freshness_status = 'WARNING' THEN 1 ELSE 0 END) AS days_warning,\n",
        "    SUM(CASE WHEN r.freshness_status = 'FRESH' THEN 1 ELSE 0 END) AS days_fresh,\n",
        "    \n",
        "    -- SLA compliance (average over period, as 0-1 for UI percent formatting)\n",
        "    ROUND(AVG(r.monthly.pct_meeting_1d_sla), 3) AS avg_pct_meeting_1d_sla,\n",
        "    ROUND(AVG(r.monthly.pct_meeting_2d_sla), 3) AS avg_pct_meeting_2d_sla,\n",
        "    \n",
        "    -- Latency metrics\n",
        "    ROUND(AVG(r.monthly.avg_latency_days), 2) AS avg_latency_days,\n",
        "    MAX(r.monthly.max_latency_days) AS max_latency_days,\n",
        "    \n",
        "    -- Volume\n",
        "    SUM(r.monthly.partitions_landed) AS total_partitions_landed\n",
        "    \n",
        "  FROM owned_tables o\n",
        "  JOIN product_analytics_staging.agg_landing_reliability_rolling r\n",
        "    USING (date, table_id)\n",
        "  GROUP BY o.database, o.`table`, o.region\n",
        "),\n",
        "\n",
        "-- Calculate a \"reliability score\" for ranking (lower = worse)\n",
        "scored AS (\n",
        "  SELECT\n",
        "    *,\n",
        "    -- Score: penalize stale days, low SLA compliance, high latency (0-100 scale)\n",
        "    (avg_pct_meeting_2d_sla * 100 * 0.5) + \n",
        "    ((1.0 - (days_stale * 1.0 / NULLIF(days_tracked, 0))) * 100 * 0.3) +\n",
        "    ((1.0 - LEAST(avg_latency_days / 5.0, 1.0)) * 100 * 0.2) AS reliability_score\n",
        "  FROM table_reliability\n",
        "  WHERE days_tracked > 0\n",
        ")\n",
        "\n",
        "SELECT\n",
        "  database,\n",
        "  `table`,\n",
        "  region,\n",
        "  \n",
        "  -- Freshness breakdown\n",
        "  days_tracked,\n",
        "  days_stale,\n",
        "  days_warning,\n",
        "  days_fresh,\n",
        "  ROUND(days_stale * 1.0 / NULLIF(days_tracked, 0), 3) AS pct_days_stale,\n",
        "  \n",
        "  -- SLA compliance\n",
        "  avg_pct_meeting_1d_sla,\n",
        "  avg_pct_meeting_2d_sla,\n",
        "  \n",
        "  -- Latency\n",
        "  avg_latency_days,\n",
        "  max_latency_days,\n",
        "  \n",
        "  -- Overall score (0-100, lower = worse)\n",
        "  ROUND(reliability_score, 1) AS reliability_score,\n",
        "  \n",
        "  -- Quick navigation links\n",
        "  CONCAT('https://datahub.internal.samsara.com/dataset/urn:li:dataset:(urn:li:dataPlatform:databricks,', database, '.', `table`, ',PROD)/Schema') AS datahub_url,\n",
        "  CONCAT('https://dagster.internal.samsara.com/assets/', region, '/', database, '/', `table`) AS dagster_url\n",
        "\n",
        "FROM scored\n",
        "WHERE days_stale > 0 OR avg_pct_meeting_2d_sla < 0.95 OR avg_latency_days > 1\n",
        "ORDER BY reliability_score ASC, days_stale DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        },
        {
          "displayName": "li",
          "keyword": "li",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataset",
          "keyword": "dataset",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "dataPlatform",
          "keyword": "dataPlatform",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "displayName": "databricks",
          "keyword": "databricks",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ac0c705b",
      "displayName": "queries.reliability.tables.table_freshness",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Reliability Tables\n",
        "-- View: Table Freshness Status\n",
        "-- =============================================================================\n",
        "-- Visualization: Table (sortable, with conditional formatting)\n",
        "-- Title: \"Table Freshness Status\"\n",
        "-- Purpose: Per-table view of freshness and SLA compliance\n",
        "--\n",
        "-- Columns:\n",
        "--   - region, database, table\n",
        "--   - freshness_status (\ud83d\udfe2/\ud83d\udfe1/\ud83d\udd34)\n",
        "--   - last_partition_landed, days_since_last_landing\n",
        "--   - pct_meeting_1d_sla, pct_meeting_2d_sla\n",
        "--   - avg_latency_days, max_latency_days\n",
        "--\n",
        "-- Filters:\n",
        "--   - freshness_status dropdown (Fresh, Warning, Stale, All)\n",
        "--   - region dropdown\n",
        "--\n",
        "-- Conditional Formatting:\n",
        "--   - freshness_status column colored by status\n",
        "--   - pct_meeting_2d_sla: green >95%, yellow 80-95%, red <80%\n",
        "-- =============================================================================\n",
        "\n",
        "-- Get most recent date's metrics for firmwarevdp-owned tables\n",
        "-- Use the MINIMUM of max dates across tables to ensure joins work\n",
        "WITH max_dates AS (\n",
        "  SELECT \n",
        "    (SELECT MAX(date) FROM product_analytics_staging.agg_landing_reliability_rolling WHERE date BETWEEN :date.min AND :date.max) AS reliability_max,\n",
        "    (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max) AS tables_max\n",
        "),\n",
        "common_date AS (\n",
        "  SELECT LEAST(reliability_max, tables_max) AS max_date\n",
        "  FROM max_dates\n",
        "),\n",
        "-- Get firmwarevdp-owned tables from dim_tables (with region/database/table names)\n",
        "owned_tables AS (\n",
        "  SELECT DISTINCT\n",
        "    t.date,\n",
        "    t.table_id,\n",
        "    t.region,\n",
        "    t.database,\n",
        "    t.`table`\n",
        "  FROM product_analytics_staging.dim_tables t\n",
        "  WHERE t.date = (SELECT max_date FROM common_date)\n",
        "    AND t.team = :team\n",
        ")\n",
        "SELECT \n",
        "  o.region,\n",
        "  o.database,\n",
        "  o.`table`,\n",
        "  -- Add emoji indicators for display (stored as plain text)\n",
        "  CASE r.freshness_status\n",
        "    WHEN 'FRESH' THEN '\ud83d\udfe2 FRESH'\n",
        "    WHEN 'WARNING' THEN '\ud83d\udfe1 WARNING'\n",
        "    WHEN 'STALE' THEN '\ud83d\udd34 STALE'\n",
        "    ELSE r.freshness_status\n",
        "  END AS freshness_status,\n",
        "  r.last_partition_landed,\n",
        "  r.days_since_last_landing,\n",
        "  \n",
        "  -- 30-day SLA compliance (0-1 range for UI percent formatting)\n",
        "  ROUND(r.monthly.pct_meeting_1d_sla, 4) AS pct_meeting_1d_sla,\n",
        "  ROUND(r.monthly.pct_meeting_2d_sla, 4) AS pct_meeting_2d_sla,\n",
        "  \n",
        "  -- Latency metrics\n",
        "  ROUND(r.monthly.avg_latency_days, 2) AS avg_latency_days,\n",
        "  r.monthly.max_latency_days,\n",
        "  \n",
        "  -- Volume\n",
        "  r.monthly.partitions_landed AS partitions_landed_30d\n",
        "\n",
        "FROM owned_tables o\n",
        "JOIN product_analytics_staging.agg_landing_reliability_rolling r\n",
        "  USING (date, table_id)\n",
        "ORDER BY \n",
        "  CASE r.freshness_status \n",
        "    WHEN 'STALE' THEN 1 \n",
        "    WHEN 'WARNING' THEN 2 \n",
        "    ELSE 3 \n",
        "  END,\n",
        "  r.days_since_last_landing DESC,\n",
        "  o.database, \n",
        "  o.`table`\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "cc757122",
      "displayName": "queries.reliability.tables.sla_breaches",
      "queryLines": [
        "-- =============================================================================\n",
        "-- Dashboard: Data Cost & Efficiency (DCE)\n",
        "-- Tab: Reliability Tables\n",
        "-- View: SLA Breaches\n",
        "-- =============================================================================\n",
        "-- Visualization: Table (sortable, with conditional formatting)\n",
        "-- Title: \"Tables Breaching 2-Day SLA\"\n",
        "-- Purpose: Identify and prioritize tables with SLA issues\n",
        "--\n",
        "-- Columns:\n",
        "--   - region, database, table\n",
        "--   - late_partitions_7d, late_partitions_30d\n",
        "--   - avg_latency_days, max_latency_days\n",
        "--   - worst_partition (partition_date with highest latency)\n",
        "--\n",
        "-- Sort: By late_partitions_7d DESC (prioritize recent issues)\n",
        "--\n",
        "-- Conditional Formatting:\n",
        "--   - late_partitions_7d: red if >5, yellow if >0\n",
        "--   - max_latency_days: red if >5 days\n",
        "-- =============================================================================\n",
        "\n",
        "-- Find common date range where both tables have data\n",
        "WITH max_dates AS (\n",
        "  SELECT \n",
        "    (SELECT MAX(date) FROM product_analytics_staging.fct_partition_landings WHERE date BETWEEN :date.min AND :date.max) AS landings_max,\n",
        "    (SELECT MAX(date) FROM product_analytics_staging.dim_tables WHERE date BETWEEN :date.min AND :date.max) AS tables_max\n",
        "),\n",
        "common_max AS (\n",
        "  SELECT LEAST(landings_max, tables_max) AS max_date\n",
        "  FROM max_dates\n",
        "),\n",
        "-- Get firmwarevdp-owned tables from dim_tables (with region/database/table names)\n",
        "owned_tables AS (\n",
        "  SELECT DISTINCT\n",
        "    t.date,\n",
        "    t.table_id,\n",
        "    t.region,\n",
        "    t.database,\n",
        "    t.`table`\n",
        "  FROM product_analytics_staging.dim_tables t\n",
        "  WHERE t.date BETWEEN DATE_SUB((SELECT max_date FROM common_max), 29) AND (SELECT max_date FROM common_max)\n",
        "    AND t.team = :team\n",
        "),\n",
        "-- Get partition-level details for SLA breaches\n",
        "late_landings AS (\n",
        "  SELECT \n",
        "    o.region,\n",
        "    o.database,\n",
        "    o.`table`,\n",
        "    f.partition_date,\n",
        "    f.date AS landing_date,\n",
        "    f.landing_latency_days,\n",
        "    -- Categorize by recency\n",
        "    CASE \n",
        "      WHEN f.date >= DATE_SUB((SELECT max_date FROM common_max), 6) THEN 'last_7d'\n",
        "      ELSE 'last_30d'\n",
        "    END AS recency\n",
        "  FROM owned_tables o\n",
        "  JOIN product_analytics_staging.fct_partition_landings f\n",
        "    USING (date, table_id)\n",
        "  WHERE NOT f.meets_2d_sla\n",
        "),\n",
        "aggregated AS (\n",
        "  SELECT\n",
        "    region,\n",
        "    database,\n",
        "    `table`,\n",
        "    COUNT(CASE WHEN recency = 'last_7d' THEN 1 END) AS late_partitions_7d,\n",
        "    COUNT(*) AS late_partitions_30d,\n",
        "    ROUND(AVG(landing_latency_days), 1) AS avg_latency_days,\n",
        "    MAX(landing_latency_days) AS max_latency_days,\n",
        "    -- Get the worst partition\n",
        "    MAX_BY(partition_date, landing_latency_days) AS worst_partition\n",
        "  FROM late_landings\n",
        "  GROUP BY region, database, `table`\n",
        ")\n",
        "SELECT \n",
        "  region,\n",
        "  database,\n",
        "  `table`,\n",
        "  late_partitions_7d,\n",
        "  late_partitions_30d,\n",
        "  avg_latency_days,\n",
        "  max_latency_days,\n",
        "  worst_partition\n",
        "FROM aggregated\n",
        "WHERE late_partitions_30d > 0\n",
        "ORDER BY late_partitions_7d DESC, late_partitions_30d DESC, max_latency_days DESC\n",
        "LIMIT CAST(CASE WHEN :limit <= 0 THEN 999999 ELSE :limit END AS INT)\n",
        "\n"
      ],
      "parameters": [
        {
          "displayName": "date",
          "keyword": "date",
          "dataType": "DATE",
          "complexType": "RANGE",
          "defaultSelection": {
            "range": {
              "dataType": "DATE",
              "min": {
                "value": "now-90d/d"
              },
              "max": {
                "value": "now/d"
              }
            }
          }
        },
        {
          "displayName": "limit",
          "keyword": "limit",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "-1"
                }
              ]
            }
          }
        },
        {
          "displayName": "team",
          "keyword": "team",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "firmwarevdp"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "pages": [
    {
      "name": "34b0d93f",
      "displayName": "Overview",
      "layout": [
        {
          "widget": {
            "name": "15c695d5",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "edc83baf",
                  "fields": [
                    {
                      "name": "metric",
                      "expression": "`metric`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    },
                    {
                      "name": "unit",
                      "expression": "`unit`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "value",
                  "rowNumber": 1,
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Rolling Cost",
                "showDescription": true,
                "description": "Executive-level KPIs showing current month costs, growth trends, and critical anomaly count. Updates daily."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "9b246b03",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "b045a54d",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "monthly_active_users",
                      "expression": "`monthly_active_users`"
                    },
                    {
                      "name": "monthly_queries",
                      "expression": "`monthly_queries`"
                    },
                    {
                      "name": "unique_tables_monthly",
                      "expression": "`unique_tables_monthly`"
                    },
                    {
                      "name": "avg_queries_per_user",
                      "expression": "`avg_queries_per_user`"
                    },
                    {
                      "name": "user_change",
                      "expression": "`user_change`"
                    },
                    {
                      "name": "user_growth_pct",
                      "expression": "`user_growth_pct`"
                    },
                    {
                      "name": "query_growth_pct",
                      "expression": "`query_growth_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "monthly_active_users",
                  "rowNumber": 1
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Active Users"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "ed812e1c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ea5a03bc",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "current_monthly_cost",
                      "expression": "`current_monthly_cost`"
                    },
                    {
                      "name": "month_over_month_change",
                      "expression": "`month_over_month_change`"
                    },
                    {
                      "name": "mom_growth_pct",
                      "expression": "`mom_growth_pct`"
                    },
                    {
                      "name": "trailing_12m_cost",
                      "expression": "`trailing_12m_cost`"
                    },
                    {
                      "name": "budget_status",
                      "expression": "`budget_status`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "fieldName": "current_monthly_cost",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  },
                  "axis": {
                    "title": "30-Day Rolling Cost (USD)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Rolling Cost Trend",
                "showDescription": true,
                "description": "30-day rolling cost over time with MoM growth rate. Track monthly spending trajectory against budget thresholds."
              },
              "annotations": [
                {
                  "type": "horizontal-line",
                  "encodings": {
                    "y": {
                      "dataValue": "15000",
                      "dataType": "DOUBLE"
                    },
                    "label": {
                      "value": "Budget Limit"
                    },
                    "color": {
                      "value": {
                        "themeColorType": "visualizationColors",
                        "position": 0
                      }
                    }
                  }
                },
                {
                  "type": "horizontal-line",
                  "encodings": {
                    "y": {
                      "dataValue": "12000",
                      "dataType": "DOUBLE"
                    },
                    "label": {
                      "value": "Warning Threshold"
                    },
                    "color": {
                      "value": {
                        "themeColorType": "visualizationColors",
                        "position": 2
                      }
                    }
                  }
                }
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "ee288d23",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1ba1f227",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "daily_users",
                      "expression": "`daily_users`"
                    },
                    {
                      "name": "daily_queries",
                      "expression": "`daily_queries`"
                    },
                    {
                      "name": "tables_accessed_today",
                      "expression": "`tables_accessed_today`"
                    },
                    {
                      "name": "weekly_active_users",
                      "expression": "`weekly_active_users`"
                    },
                    {
                      "name": "weekly_queries",
                      "expression": "`weekly_queries`"
                    },
                    {
                      "name": "monthly_active_users",
                      "expression": "`monthly_active_users`"
                    },
                    {
                      "name": "monthly_queries",
                      "expression": "`monthly_queries`"
                    },
                    {
                      "name": "unique_tables_accessed_monthly",
                      "expression": "`unique_tables_accessed_monthly`"
                    },
                    {
                      "name": "avg_queries_per_user",
                      "expression": "`avg_queries_per_user`"
                    },
                    {
                      "name": "avg_queries_per_table",
                      "expression": "`avg_queries_per_table`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "daily_users"
                    },
                    {
                      "fieldName": "weekly_active_users"
                    },
                    {
                      "fieldName": "monthly_active_users"
                    }
                  ],
                  "axis": {
                    "title": "Active Users"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users (Daily / 7-Day / 30-Day)",
                "showDescription": true,
                "description": "Track DAU, WAU, and MAU trends to understand engagement patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 7,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3b5383ae",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "844c9d3f",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "time_horizon",
                      "expression": "`time_horizon`"
                    },
                    {
                      "name": "warnings",
                      "expression": "`warnings`"
                    },
                    {
                      "name": "anomalous",
                      "expression": "`anomalous`"
                    },
                    {
                      "name": "critical",
                      "expression": "`critical`"
                    },
                    {
                      "name": "total_anomalies",
                      "expression": "`total_anomalies`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "warnings"
                    },
                    {
                      "fieldName": "anomalous"
                    },
                    {
                      "fieldName": "critical"
                    }
                  ],
                  "axis": {
                    "title": "Anomaly Count"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily Anomaly Count by Severity",
                "showDescription": true,
                "description": "Count of warnings, anomalous, and critical cost deviations."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 5
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "675ddeab",
      "displayName": "Cost Analysis",
      "layout": [
        {
          "widget": {
            "name": "f7c9c3d6",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ab9c2215",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "rolling_7d_cost",
                      "expression": "`rolling_7d_cost`"
                    },
                    {
                      "name": "rolling_30d_cost",
                      "expression": "`rolling_30d_cost`"
                    },
                    {
                      "name": "rolling_90d_cost",
                      "expression": "`rolling_90d_cost`"
                    },
                    {
                      "name": "rolling_365d_cost",
                      "expression": "`rolling_365d_cost`"
                    },
                    {
                      "name": "daily_change",
                      "expression": "`daily_change`"
                    },
                    {
                      "name": "weekly_change",
                      "expression": "`weekly_change`"
                    },
                    {
                      "name": "monthly_change",
                      "expression": "`monthly_change`"
                    },
                    {
                      "name": "yearly_change",
                      "expression": "`yearly_change`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "daily_cost"
                    },
                    {
                      "fieldName": "rolling_7d_cost"
                    },
                    {
                      "fieldName": "rolling_30d_cost"
                    },
                    {
                      "fieldName": "rolling_90d_cost"
                    }
                  ],
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  },
                  "axis": {
                    "title": "Cost (USD)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Rolling Cost Comparison (Daily / 7d / 30d / 90d)",
                "showDescription": true,
                "description": "Compare daily, weekly (7d), monthly (30d), quarterly (90d), and yearly (365d) rolling costs to understand spend patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "cf2289eb",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ab9c2215",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "rolling_7d_cost",
                      "expression": "`rolling_7d_cost`"
                    },
                    {
                      "name": "rolling_30d_cost",
                      "expression": "`rolling_30d_cost`"
                    },
                    {
                      "name": "rolling_90d_cost",
                      "expression": "`rolling_90d_cost`"
                    },
                    {
                      "name": "rolling_365d_cost",
                      "expression": "`rolling_365d_cost`"
                    },
                    {
                      "name": "daily_change",
                      "expression": "`daily_change`"
                    },
                    {
                      "name": "weekly_change",
                      "expression": "`weekly_change`"
                    },
                    {
                      "name": "monthly_change",
                      "expression": "`monthly_change`"
                    },
                    {
                      "name": "yearly_change",
                      "expression": "`yearly_change`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "fieldName": "rolling_365d_cost",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  },
                  "axis": {
                    "title": "365-Day Rolling Cost (USD)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Trailing 12-Month Cost (365-Day Rolling)",
                "showDescription": true,
                "description": "Compare daily, weekly (7d), monthly (30d), quarterly (90d), and yearly (365d) rolling costs to understand spend patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "0d8cfda2",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "421a0f5e",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "total_monthly_cost",
                      "expression": "`total_monthly_cost`"
                    },
                    {
                      "name": "active_users",
                      "expression": "`active_users`"
                    },
                    {
                      "name": "cost_per_user",
                      "expression": "`cost_per_user`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "cost_per_1k_queries",
                      "expression": "`cost_per_1k_queries`"
                    },
                    {
                      "name": "efficiency_status",
                      "expression": "`efficiency_status`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "cost_per_user"
                    },
                    {
                      "fieldName": "cost_per_1k_queries"
                    }
                  ],
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  },
                  "axis": {
                    "title": "Cost per Unit (USD)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Cost Efficiency ($/User, $/1K Queries)",
                "showDescription": true,
                "description": "Track unit economics over time. Monitor cost efficiency relative to user count and query volume."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "06fc2e51",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "220b8832",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_change",
                      "expression": "`monthly_change`"
                    },
                    {
                      "name": "percent_of_firmwarevdp_total",
                      "expression": "`percent_of_firmwarevdp_total`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "fieldName": "monthly_cost",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "none",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  },
                  "axis": {
                    "title": "30-Day Rolling Cost (USD)"
                  },
                  "stackType": "stacked"
                },
                "color": {
                  "fieldName": "product_group",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day Cost by Product Group (Stacked)",
                "showDescription": true,
                "description": "Time-series view of how costs are distributed across product groups and dataplatform features within FirmwareVDP."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 15,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "54e63b9f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a5f2e9e3",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "dataplatform_feature",
                      "expression": "`dataplatform_feature`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_change",
                      "expression": "`monthly_change`"
                    },
                    {
                      "name": "yesterday_cost",
                      "expression": "`yesterday_cost`"
                    },
                    {
                      "name": "percent_of_total",
                      "expression": "`percent_of_total`"
                    },
                    {
                      "name": "datahub_url",
                      "expression": "`datahub_url`"
                    },
                    {
                      "name": "dagster_url",
                      "expression": "`dagster_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "product_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "product_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dataplatform_feature",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "dataplatform_feature",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "monthly_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_change",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "monthly_change",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "yesterday_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "yesterday_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "percent_of_total",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "percent_of_total",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "datahub_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Datahub",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100010,
                    "title": "datahub_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dagster_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Dagster",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100011,
                    "title": "dagster_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top Tables by 30-Day Cost",
                "showDescription": true,
                "description": "Identify the highest-cost services for optimization. Shows monthly cost, recent trend, and percent of total FirmwareVDP spending."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "1c05e759",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1a1916c2",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "monthly_cost",
                      "expression": "`monthly_cost`"
                    },
                    {
                      "name": "monthly_users",
                      "expression": "`monthly_users`"
                    },
                    {
                      "name": "monthly_queries",
                      "expression": "`monthly_queries`"
                    },
                    {
                      "name": "usage_category",
                      "expression": "`usage_category`"
                    },
                    {
                      "name": "datahub_url",
                      "expression": "`datahub_url`"
                    },
                    {
                      "name": "dagster_url",
                      "expression": "`dagster_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "monthly_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_users",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "monthly_users",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_queries",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "monthly_queries",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "usage_category",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100007,
                    "title": "usage_category",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "datahub_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Datahub",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100008,
                    "title": "datahub_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dagster_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Dagster",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100009,
                    "title": "dagster_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Idle & Low-Usage Tables",
                "showDescription": true,
                "description": "Services costing >$10/month with <3 users. Deprecation candidates."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 26,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "7423a517",
      "displayName": "Alerts & Anomalies",
      "layout": [
        {
          "widget": {
            "name": "63604e01",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "3a5b0fbd",
                  "fields": [
                    {
                      "name": "alert_type",
                      "expression": "`alert_type`"
                    },
                    {
                      "name": "time_horizon",
                      "expression": "`time_horizon`"
                    },
                    {
                      "name": "alert_count",
                      "expression": "`alert_count`"
                    },
                    {
                      "name": "total_cost_affected",
                      "expression": "`total_cost_affected`"
                    },
                    {
                      "name": "avg_z_score",
                      "expression": "`avg_z_score`"
                    },
                    {
                      "name": "avg_percent_change",
                      "expression": "`avg_percent_change`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "alert_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "alert_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "time_horizon",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100001,
                    "title": "time_horizon",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "alert_count",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100002,
                    "title": "alert_count",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_cost_affected",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "total_cost_affected",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_z_score",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "avg_z_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_percent_change",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "avg_percent_change",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Active Alerts by Type",
                "showDescription": true,
                "description": "Current alerts grouped by type and severity. critical_service_increase is highest priority."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "c1d52f0e",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e93beeaa",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "dataplatform_feature",
                      "expression": "`dataplatform_feature`"
                    },
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "current_cost",
                      "expression": "`current_cost`"
                    },
                    {
                      "name": "cost_z_score",
                      "expression": "`cost_z_score`"
                    },
                    {
                      "name": "percent_change",
                      "expression": "`percent_change`"
                    },
                    {
                      "name": "expected_cost",
                      "expression": "`expected_cost`"
                    },
                    {
                      "name": "cost_increase",
                      "expression": "`cost_increase`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "product_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "product_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dataplatform_feature",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "dataplatform_feature",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "current_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "current_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "cost_z_score",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "cost_z_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "percent_change",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "percent_change",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "expected_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "expected_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "cost_increase",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "cost_increase",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Critical Cost Spikes (>5\u03c3)",
                "showDescription": true,
                "description": "Top 50 services with statistically significant cost increases requiring immediate investigation. Sort by z-score to prioritize."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "bcfc76e7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a2f66709",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "alert_type",
                      "expression": "`alert_type`"
                    },
                    {
                      "name": "time_horizon",
                      "expression": "`time_horizon`"
                    },
                    {
                      "name": "hierarchy_label",
                      "expression": "`hierarchy_label`"
                    },
                    {
                      "name": "grouping_columns",
                      "expression": "`grouping_columns`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "dataplatform_feature",
                      "expression": "`dataplatform_feature`"
                    },
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "cost",
                      "expression": "`cost`"
                    },
                    {
                      "name": "baseline_mean",
                      "expression": "`baseline_mean`"
                    },
                    {
                      "name": "z_score",
                      "expression": "`z_score`"
                    },
                    {
                      "name": "percent_change_pct",
                      "expression": "`percent_change_pct`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "alert_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "alert_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "time_horizon",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100002,
                    "title": "time_horizon",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "hierarchy_label",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "hierarchy_label",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "grouping_columns",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "grouping_columns",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100006,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "product_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100007,
                    "title": "product_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dataplatform_feature",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100008,
                    "title": "dataplatform_feature",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100009,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "baseline_mean",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100011,
                    "title": "baseline_mean",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "z_score",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100012,
                    "title": "z_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "percent_change_pct",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100013,
                    "title": "percent_change_pct",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "status",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100014,
                    "title": "status",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Alert Details",
                "showDescription": true,
                "description": "Detailed view of all current alerts with full context. z_score > 3 indicates extreme deviation."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "f14a4867",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a1da4b07",
                  "fields": [
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "dataplatform_feature",
                      "expression": "`dataplatform_feature`"
                    },
                    {
                      "name": "alert_type",
                      "expression": "`alert_type`"
                    },
                    {
                      "name": "recurrence_days",
                      "expression": "`recurrence_days`"
                    },
                    {
                      "name": "first_alert_date",
                      "expression": "`first_alert_date`"
                    },
                    {
                      "name": "last_alert_date",
                      "expression": "`last_alert_date`"
                    },
                    {
                      "name": "alert_span_days",
                      "expression": "`alert_span_days`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "avg_z_score",
                      "expression": "`avg_z_score`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "product_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "product_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dataplatform_feature",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "dataplatform_feature",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "alert_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "alert_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "recurrence_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "recurrence_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "first_alert_date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100007,
                    "title": "first_alert_date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "last_alert_date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100008,
                    "title": "last_alert_date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "alert_span_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "alert_span_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "avg_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_z_score",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100011,
                    "title": "avg_z_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Recurring Alerts (Chronic Issues)",
                "showDescription": true,
                "description": "Services with alerts on multiple days. High recurrence indicates persistent problems needing systematic investigation."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "59a91d52",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "76b4fbb2",
                  "fields": [
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "team",
                      "expression": "`team`"
                    },
                    {
                      "name": "streak_start",
                      "expression": "`streak_start`"
                    },
                    {
                      "name": "streak_end",
                      "expression": "`streak_end`"
                    },
                    {
                      "name": "days_anomalous",
                      "expression": "`days_anomalous`"
                    },
                    {
                      "name": "status",
                      "expression": "`status`"
                    },
                    {
                      "name": "avg_cost",
                      "expression": "`avg_cost`"
                    },
                    {
                      "name": "max_z_score",
                      "expression": "`max_z_score`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "team",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "team",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "streak_start",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "streak_start",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "streak_end",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "streak_end",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_anomalous",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "days_anomalous",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "status",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100006,
                    "title": "status",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_cost",
                    "numberFormat": "$#,##0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "avg_cost",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "max_z_score",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "max_z_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Persistent Anomalies (3+ Days)",
                "showDescription": true,
                "description": "Services showing sustained cost anomalies indicating systemic issues rather than one-time spikes. Prioritize by days_anomalous."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 21,
            "width": 6,
            "height": 5
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "bf8a468a",
      "displayName": "Usage & Engagement",
      "layout": [
        {
          "widget": {
            "name": "e06513a7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "45da29af",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "monthly_active_users",
                      "expression": "`monthly_active_users`"
                    },
                    {
                      "name": "user_change",
                      "expression": "`user_change`"
                    },
                    {
                      "name": "user_growth_pct",
                      "expression": "`user_growth_pct`"
                    },
                    {
                      "name": "monthly_queries",
                      "expression": "`monthly_queries`"
                    },
                    {
                      "name": "query_growth_pct",
                      "expression": "`query_growth_pct`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "monthly_active_users"
                    },
                    {
                      "fieldName": "monthly_queries"
                    }
                  ],
                  "axis": {
                    "title": "Count (30-Day Rolling)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "30-Day User & Query Growth",
                "showDescription": true,
                "description": "Track MAU (monthly active users) and MoM growth rate."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "a146933d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "2b02b550",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "total_active_users",
                      "expression": "`total_active_users`"
                    },
                    {
                      "name": "sql_only_users",
                      "expression": "`sql_only_users`"
                    },
                    {
                      "name": "dashboard_only_users",
                      "expression": "`dashboard_only_users`"
                    },
                    {
                      "name": "both_users",
                      "expression": "`both_users`"
                    },
                    {
                      "name": "pct_sql_only",
                      "expression": "`pct_sql_only`"
                    },
                    {
                      "name": "pct_dashboard_only",
                      "expression": "`pct_dashboard_only`"
                    },
                    {
                      "name": "pct_both",
                      "expression": "`pct_both`"
                    },
                    {
                      "name": "total_sql_queries",
                      "expression": "`total_sql_queries`"
                    },
                    {
                      "name": "total_dashboard_events",
                      "expression": "`total_dashboard_events`"
                    },
                    {
                      "name": "total_interactions",
                      "expression": "`total_interactions`"
                    },
                    {
                      "name": "avg_queries_per_sql_user",
                      "expression": "`avg_queries_per_sql_user`"
                    },
                    {
                      "name": "avg_events_per_dashboard_user",
                      "expression": "`avg_events_per_dashboard_user`"
                    },
                    {
                      "name": "avg_interactions_per_user",
                      "expression": "`avg_interactions_per_user`"
                    },
                    {
                      "name": "delta_active_users",
                      "expression": "`delta_active_users`"
                    },
                    {
                      "name": "active_users_7d_avg",
                      "expression": "`active_users_7d_avg`"
                    },
                    {
                      "name": "sql_users_7d_avg",
                      "expression": "`sql_users_7d_avg`"
                    },
                    {
                      "name": "dashboard_users_7d_avg",
                      "expression": "`dashboard_users_7d_avg`"
                    },
                    {
                      "name": "both_users_7d_avg",
                      "expression": "`both_users_7d_avg`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "active_users_7d_avg"
                    },
                    {
                      "fieldName": "sql_users_7d_avg"
                    },
                    {
                      "fieldName": "dashboard_users_7d_avg"
                    }
                  ],
                  "axis": {
                    "title": "Users (7-Day Avg)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Platform Usage (7-Day Rolling Average)",
                "showDescription": true,
                "description": "Shows how platform adoption evolves - are more users using both"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3b2c84ca",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "d6fb5044",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "service",
                      "expression": "`service`"
                    },
                    {
                      "name": "product_group",
                      "expression": "`product_group`"
                    },
                    {
                      "name": "dataplatform_feature",
                      "expression": "`dataplatform_feature`"
                    },
                    {
                      "name": "monthly_users",
                      "expression": "`monthly_users`"
                    },
                    {
                      "name": "monthly_queries",
                      "expression": "`monthly_queries`"
                    },
                    {
                      "name": "avg_queries_per_user",
                      "expression": "`avg_queries_per_user`"
                    },
                    {
                      "name": "percent_of_users",
                      "expression": "`percent_of_users`"
                    },
                    {
                      "name": "datahub_url",
                      "expression": "`datahub_url`"
                    },
                    {
                      "name": "dagster_url",
                      "expression": "`dagster_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "service",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "service",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "product_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "product_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dataplatform_feature",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "dataplatform_feature",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_users",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "monthly_users",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "monthly_queries",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "monthly_queries",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_queries_per_user",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "avg_queries_per_user",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "percent_of_users",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "percent_of_users",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "datahub_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Datahub",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100009,
                    "title": "datahub_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dagster_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Dagster",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100010,
                    "title": "dagster_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Most Accessed Tables (30-Day Period)",
                "showDescription": true,
                "description": "Services with highest unique user count. These are your most valuable data products - prioritize their quality and SLAs."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5f8350c4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "fe905fe2",
                  "fields": [
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "database",
                      "expression": "`database`"
                    },
                    {
                      "name": "table",
                      "expression": "`table`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "total_users",
                      "expression": "`total_users`"
                    },
                    {
                      "name": "last_query_date",
                      "expression": "`last_query_date`"
                    },
                    {
                      "name": "days_since_last_query",
                      "expression": "`days_since_last_query`"
                    },
                    {
                      "name": "datahub_url",
                      "expression": "`datahub_url`"
                    },
                    {
                      "name": "dagster_url",
                      "expression": "`dagster_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "database",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "database",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "table",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "table",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_queries",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "total_queries",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_users",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "total_users",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "last_query_date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100005,
                    "title": "last_query_date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "days_since_last_query",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "days_since_last_query",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "datahub_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Datahub",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100007,
                    "title": "datahub_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dagster_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Dagster",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100008,
                    "title": "dagster_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Unused Tables in Date Range",
                "showDescription": true,
                "description": "Tables with no queries in the selected date range."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "99500230",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "11884c3d",
                  "fields": [
                    {
                      "name": "rank",
                      "expression": "`rank`"
                    },
                    {
                      "name": "employee_email",
                      "expression": "`employee_email`"
                    },
                    {
                      "name": "department",
                      "expression": "`department`"
                    },
                    {
                      "name": "job_family",
                      "expression": "`job_family`"
                    },
                    {
                      "name": "job_family_group",
                      "expression": "`job_family_group`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "unique_tables",
                      "expression": "`unique_tables`"
                    },
                    {
                      "name": "active_days",
                      "expression": "`active_days`"
                    },
                    {
                      "name": "queries_per_day",
                      "expression": "`queries_per_day`"
                    },
                    {
                      "name": "user_tier",
                      "expression": "`user_tier`"
                    },
                    {
                      "name": "percentile_rank",
                      "expression": "`percentile_rank`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "rank",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "rank",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "employee_email",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "employee_email",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "department",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "department",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "job_family",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "job_family",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "job_family_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "job_family_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_queries",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "total_queries",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "unique_tables",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100006,
                    "title": "unique_tables",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "active_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "active_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "queries_per_day",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "queries_per_day",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "user_tier",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100009,
                    "title": "user_tier",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "percentile_rank",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "percentile_rank",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Power Users (30-Day Period)",
                "showDescription": true,
                "description": "Users ranked by their usage of tables owned by the selected team."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "3b5618e0",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "43dcf09a",
                  "fields": [
                    {
                      "name": "employee_email",
                      "expression": "`employee_email`"
                    },
                    {
                      "name": "department",
                      "expression": "`department`"
                    },
                    {
                      "name": "job_family",
                      "expression": "`job_family`"
                    },
                    {
                      "name": "job_family_group",
                      "expression": "`job_family_group`"
                    },
                    {
                      "name": "volume_score",
                      "expression": "`volume_score`"
                    },
                    {
                      "name": "breadth_score",
                      "expression": "`breadth_score`"
                    },
                    {
                      "name": "recency_score",
                      "expression": "`recency_score`"
                    },
                    {
                      "name": "engagement_score",
                      "expression": "`engagement_score`"
                    },
                    {
                      "name": "total_queries",
                      "expression": "`total_queries`"
                    },
                    {
                      "name": "unique_tables",
                      "expression": "`unique_tables`"
                    },
                    {
                      "name": "active_days",
                      "expression": "`active_days`"
                    },
                    {
                      "name": "engagement_tier",
                      "expression": "`engagement_tier`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "employee_email",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "employee_email",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "department",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "department",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "job_family",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "job_family",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "job_family_group",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "job_family_group",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "volume_score",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "volume_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "breadth_score",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "breadth_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "recency_score",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "recency_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "engagement_score",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "engagement_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_queries",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "total_queries",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "unique_tables",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100009,
                    "title": "unique_tables",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "active_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "active_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "engagement_tier",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100011,
                    "title": "engagement_tier",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "User Engagement Scores (30-Day Period)",
                "showDescription": true,
                "description": "Engagement scores based on usage of team-owned tables."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 27,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "8417db47",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "6c39e90c",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "dashboard_title",
                      "expression": "`dashboard_title`"
                    },
                    {
                      "name": "events",
                      "expression": "`events`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "fieldName": "events",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Events"
                  }
                },
                "color": {
                  "fieldName": "dashboard_title",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Dashboard Usage Over Time",
                "showDescription": true,
                "description": "Daily event count per dashboard. Track engagement trends and identify usage patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 32,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "77c9fb08",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cdff51fc",
                  "fields": [
                    {
                      "name": "week",
                      "expression": "`week`"
                    },
                    {
                      "name": "dashboard_title",
                      "expression": "`dashboard_title`"
                    },
                    {
                      "name": "events",
                      "expression": "`events`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "active_days",
                      "expression": "`active_days`"
                    },
                    {
                      "name": "avg_daily_events",
                      "expression": "`avg_daily_events`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "week",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Week"
                  }
                },
                "y": {
                  "fieldName": "events",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Events"
                  }
                },
                "color": {
                  "fieldName": "dashboard_title",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Weekly Dashboard Activity",
                "showDescription": true,
                "description": "Track dashboard engagement trends by week. Useful for spotting adoption patterns, seasonal usage, and the impact of updates."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 37,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "1b3ec232",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "79644ce0",
                  "fields": [
                    {
                      "name": "dashboard_title",
                      "expression": "`dashboard_title`"
                    },
                    {
                      "name": "user_email",
                      "expression": "`user_email`"
                    },
                    {
                      "name": "event_count",
                      "expression": "`event_count`"
                    },
                    {
                      "name": "active_days",
                      "expression": "`active_days`"
                    },
                    {
                      "name": "last_active",
                      "expression": "`last_active`"
                    },
                    {
                      "name": "user_rank",
                      "expression": "`user_rank`"
                    },
                    {
                      "name": "dashboard_url",
                      "expression": "`dashboard_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "dashboard_title",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "dashboard_title",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "user_email",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "user_email",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "event_count",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100002,
                    "title": "event_count",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "active_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "active_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "last_active",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "last_active",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "user_rank",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "user_rank",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dashboard_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Open Dashboard",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100006,
                    "title": "dashboard_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top Users by Dashboard",
                "showDescription": true,
                "description": "Ranked list of most active users per dashboard. Identifies power users and helps understand adoption patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 42,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "a90c6e00",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "25c25516",
                  "fields": [
                    {
                      "name": "user_email",
                      "expression": "`user_email`"
                    },
                    {
                      "name": "total_events",
                      "expression": "`total_events`"
                    },
                    {
                      "name": "dashboards_used",
                      "expression": "`dashboards_used`"
                    },
                    {
                      "name": "active_days",
                      "expression": "`active_days`"
                    },
                    {
                      "name": "most_used_dashboard",
                      "expression": "`most_used_dashboard`"
                    },
                    {
                      "name": "user_rank",
                      "expression": "`user_rank`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "user_email",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "user_email",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "total_events",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100001,
                    "title": "total_events",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dashboards_used",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "dashboards_used",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "active_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "active_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "most_used_dashboard",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "most_used_dashboard",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "user_rank",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100005,
                    "title": "user_rank",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Top Users Overall (All Dashboards)",
                "showDescription": true,
                "description": "Ranked list of most active users across all tracked dashboards."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 48,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "0a2acb4f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "35893731",
                  "fields": [
                    {
                      "name": "action_name",
                      "expression": "`action_name`"
                    },
                    {
                      "name": "dashboard_title",
                      "expression": "`dashboard_title`"
                    },
                    {
                      "name": "event_count",
                      "expression": "`event_count`"
                    },
                    {
                      "name": "unique_users",
                      "expression": "`unique_users`"
                    },
                    {
                      "name": "percent_of_dashboard",
                      "expression": "`percent_of_dashboard`"
                    },
                    {
                      "name": "percent_of_total",
                      "expression": "`percent_of_total`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "heatmap",
              "encodings": {
                "x": {
                  "fieldName": "dashboard_title",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "action_name",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "color": {
                  "fieldName": "event_count",
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Dashboard Events by Action Type",
                "showDescription": true,
                "description": "Understand what users are doing with dashboards. Views vs edits vs exports helps gauge engagement depth and identify use patterns."
              }
            }
          },
          "position": {
            "x": 0,
            "y": 53,
            "width": 6,
            "height": 7
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "c0708ef7",
      "displayName": "Reliability",
      "layout": [
        {
          "widget": {
            "name": "12865eb6",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "75c178b6",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "total_tables",
                      "expression": "`total_tables`"
                    },
                    {
                      "name": "fresh_tables",
                      "expression": "`fresh_tables`"
                    },
                    {
                      "name": "warning_tables",
                      "expression": "`warning_tables`"
                    },
                    {
                      "name": "stale_tables",
                      "expression": "`stale_tables`"
                    },
                    {
                      "name": "pct_fresh",
                      "expression": "`pct_fresh`"
                    },
                    {
                      "name": "pct_stale",
                      "expression": "`pct_stale`"
                    },
                    {
                      "name": "pct_meeting_1d_sla",
                      "expression": "`pct_meeting_1d_sla`"
                    },
                    {
                      "name": "pct_meeting_2d_sla",
                      "expression": "`pct_meeting_2d_sla`"
                    },
                    {
                      "name": "avg_latency_days",
                      "expression": "`avg_latency_days`"
                    },
                    {
                      "name": "max_latency_days",
                      "expression": "`max_latency_days`"
                    },
                    {
                      "name": "partitions_landed_30d",
                      "expression": "`partitions_landed_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "date",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 100000,
                    "title": "date",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "total_tables",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100001,
                    "title": "total_tables",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "fresh_tables",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "fresh_tables",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "warning_tables",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "warning_tables",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "stale_tables",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "stale_tables",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "pct_fresh",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "pct_fresh",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "pct_stale",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "pct_stale",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "pct_meeting_1d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "pct_meeting_1d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "pct_meeting_2d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "pct_meeting_2d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "avg_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "avg_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "max_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "max_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "partitions_landed_30d",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100011,
                    "title": "partitions_landed_30d",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Reliability Snapshot (Latest)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "2df24f3b",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "3ca3763f",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "total_tables",
                      "expression": "`total_tables`"
                    },
                    {
                      "name": "fresh_tables",
                      "expression": "`fresh_tables`"
                    },
                    {
                      "name": "warning_tables",
                      "expression": "`warning_tables`"
                    },
                    {
                      "name": "stale_tables",
                      "expression": "`stale_tables`"
                    },
                    {
                      "name": "pct_fresh",
                      "expression": "`pct_fresh`"
                    },
                    {
                      "name": "pct_stale",
                      "expression": "`pct_stale`"
                    },
                    {
                      "name": "pct_meeting_1d_sla",
                      "expression": "`pct_meeting_1d_sla`"
                    },
                    {
                      "name": "pct_meeting_2d_sla",
                      "expression": "`pct_meeting_2d_sla`"
                    },
                    {
                      "name": "avg_latency_days",
                      "expression": "`avg_latency_days`"
                    },
                    {
                      "name": "max_latency_days",
                      "expression": "`max_latency_days`"
                    },
                    {
                      "name": "partitions_landed_30d",
                      "expression": "`partitions_landed_30d`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  }
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "pct_fresh"
                    },
                    {
                      "fieldName": "pct_meeting_2d_sla"
                    }
                  ],
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "axis": {
                    "title": "Percentage"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Reliability Trend Over Time",
                "showDescription": false,
                "description": ""
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "e5f09600",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "fd060c59",
                  "fields": [
                    {
                      "name": "database",
                      "expression": "`database`"
                    },
                    {
                      "name": "table",
                      "expression": "`table`"
                    },
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "days_tracked",
                      "expression": "`days_tracked`"
                    },
                    {
                      "name": "days_stale",
                      "expression": "`days_stale`"
                    },
                    {
                      "name": "days_warning",
                      "expression": "`days_warning`"
                    },
                    {
                      "name": "days_fresh",
                      "expression": "`days_fresh`"
                    },
                    {
                      "name": "pct_days_stale",
                      "expression": "`pct_days_stale`"
                    },
                    {
                      "name": "avg_pct_meeting_1d_sla",
                      "expression": "`avg_pct_meeting_1d_sla`"
                    },
                    {
                      "name": "avg_pct_meeting_2d_sla",
                      "expression": "`avg_pct_meeting_2d_sla`"
                    },
                    {
                      "name": "avg_latency_days",
                      "expression": "`avg_latency_days`"
                    },
                    {
                      "name": "max_latency_days",
                      "expression": "`max_latency_days`"
                    },
                    {
                      "name": "reliability_score",
                      "expression": "`reliability_score`"
                    },
                    {
                      "name": "datahub_url",
                      "expression": "`datahub_url`"
                    },
                    {
                      "name": "dagster_url",
                      "expression": "`dagster_url`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "database",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "database",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "table",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "table",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_tracked",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100003,
                    "title": "days_tracked",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_stale",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100004,
                    "title": "days_stale",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_warning",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "days_warning",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_fresh",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "days_fresh",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "pct_days_stale",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "pct_days_stale",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "avg_pct_meeting_1d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "avg_pct_meeting_1d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "avg_pct_meeting_2d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "avg_pct_meeting_2d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "avg_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100010,
                    "title": "avg_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "max_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100011,
                    "title": "max_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "reliability_score",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100012,
                    "title": "reliability_score",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "datahub_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Datahub",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100013,
                    "title": "datahub_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "dagster_url",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "Dagster",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "link",
                    "visible": true,
                    "order": 100014,
                    "title": "dagster_url",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Worst Offenders (Tables with Poor Reliability)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "57d95700",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ac0c705b",
                  "fields": [
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "database",
                      "expression": "`database`"
                    },
                    {
                      "name": "table",
                      "expression": "`table`"
                    },
                    {
                      "name": "freshness_status",
                      "expression": "`freshness_status`"
                    },
                    {
                      "name": "last_partition_landed",
                      "expression": "`last_partition_landed`"
                    },
                    {
                      "name": "days_since_last_landing",
                      "expression": "`days_since_last_landing`"
                    },
                    {
                      "name": "pct_meeting_1d_sla",
                      "expression": "`pct_meeting_1d_sla`"
                    },
                    {
                      "name": "pct_meeting_2d_sla",
                      "expression": "`pct_meeting_2d_sla`"
                    },
                    {
                      "name": "avg_latency_days",
                      "expression": "`avg_latency_days`"
                    },
                    {
                      "name": "max_latency_days",
                      "expression": "`max_latency_days`"
                    },
                    {
                      "name": "partitions_landed_30d",
                      "expression": "`partitions_landed_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "database",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "database",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "table",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "table",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "freshness_status",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "freshness_status",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "last_partition_landed",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "last_partition_landed",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "days_since_last_landing",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "days_since_last_landing",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "pct_meeting_1d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "pct_meeting_1d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "pct_meeting_2d_sla",
                    "numberFormat": "0.0%",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100007,
                    "title": "pct_meeting_2d_sla",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "scalePercentBy100": true
                  },
                  {
                    "fieldName": "avg_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100008,
                    "title": "avg_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "max_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100009,
                    "title": "max_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "partitions_landed_30d",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100010,
                    "title": "partitions_landed_30d",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "Table Freshness (Latest Status)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "8b00c3d5",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "cc757122",
                  "fields": [
                    {
                      "name": "region",
                      "expression": "`region`"
                    },
                    {
                      "name": "database",
                      "expression": "`database`"
                    },
                    {
                      "name": "table",
                      "expression": "`table`"
                    },
                    {
                      "name": "late_partitions_7d",
                      "expression": "`late_partitions_7d`"
                    },
                    {
                      "name": "late_partitions_30d",
                      "expression": "`late_partitions_30d`"
                    },
                    {
                      "name": "avg_latency_days",
                      "expression": "`avg_latency_days`"
                    },
                    {
                      "name": "max_latency_days",
                      "expression": "`max_latency_days`"
                    },
                    {
                      "name": "worst_partition",
                      "expression": "`worst_partition`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "region",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100000,
                    "title": "region",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "database",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100001,
                    "title": "database",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "table",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100002,
                    "title": "table",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "late_partitions_7d",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100003,
                    "title": "late_partitions_7d",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "late_partitions_30d",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100004,
                    "title": "late_partitions_30d",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "avg_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100005,
                    "title": "avg_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "max_latency_days",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 100006,
                    "title": "max_latency_days",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  },
                  {
                    "fieldName": "worst_partition",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 100007,
                    "title": "worst_partition",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false
                  }
                ]
              },
              "invisibleColumns": [],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "title": "SLA Breaches (>2 Days Stale)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "3f5946c9",
      "displayName": "Global Filters",
      "layout": [
        {
          "name": "22399964",
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          },
          "widget": {
            "name": "76dac629",
            "queries": [
              {
                "name": "param_edc83baf_date",
                "query": {
                  "datasetName": "edc83baf",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_b045a54d_date",
                "query": {
                  "datasetName": "b045a54d",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ea5a03bc_date",
                "query": {
                  "datasetName": "ea5a03bc",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_1ba1f227_date",
                "query": {
                  "datasetName": "1ba1f227",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_844c9d3f_date",
                "query": {
                  "datasetName": "844c9d3f",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ab9c2215_date",
                "query": {
                  "datasetName": "ab9c2215",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_421a0f5e_date",
                "query": {
                  "datasetName": "421a0f5e",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_220b8832_date",
                "query": {
                  "datasetName": "220b8832",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a5f2e9e3_date",
                "query": {
                  "datasetName": "a5f2e9e3",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_1a1916c2_date",
                "query": {
                  "datasetName": "1a1916c2",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_3a5b0fbd_date",
                "query": {
                  "datasetName": "3a5b0fbd",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_e93beeaa_date",
                "query": {
                  "datasetName": "e93beeaa",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a2f66709_date",
                "query": {
                  "datasetName": "a2f66709",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a1da4b07_date",
                "query": {
                  "datasetName": "a1da4b07",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_76b4fbb2_date",
                "query": {
                  "datasetName": "76b4fbb2",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_45da29af_date",
                "query": {
                  "datasetName": "45da29af",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_2b02b550_date",
                "query": {
                  "datasetName": "2b02b550",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_d6fb5044_date",
                "query": {
                  "datasetName": "d6fb5044",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_fe905fe2_date",
                "query": {
                  "datasetName": "fe905fe2",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_11884c3d_date",
                "query": {
                  "datasetName": "11884c3d",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_43dcf09a_date",
                "query": {
                  "datasetName": "43dcf09a",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_6c39e90c_date",
                "query": {
                  "datasetName": "6c39e90c",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_cdff51fc_date",
                "query": {
                  "datasetName": "cdff51fc",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_79644ce0_date",
                "query": {
                  "datasetName": "79644ce0",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_25c25516_date",
                "query": {
                  "datasetName": "25c25516",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_35893731_date",
                "query": {
                  "datasetName": "35893731",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_75c178b6_date",
                "query": {
                  "datasetName": "75c178b6",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_3ca3763f_date",
                "query": {
                  "datasetName": "3ca3763f",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_fd060c59_date",
                "query": {
                  "datasetName": "fd060c59",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ac0c705b_date",
                "query": {
                  "datasetName": "ac0c705b",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_cc757122_date",
                "query": {
                  "datasetName": "cc757122",
                  "parameters": [
                    {
                      "name": "date",
                      "keyword": "date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "date",
                    "queryName": "param_edc83baf_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_b045a54d_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_ea5a03bc_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_1ba1f227_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_844c9d3f_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_ab9c2215_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_421a0f5e_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_220b8832_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_a5f2e9e3_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_1a1916c2_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_3a5b0fbd_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_e93beeaa_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_a2f66709_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_a1da4b07_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_76b4fbb2_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_45da29af_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_2b02b550_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_d6fb5044_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_fe905fe2_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_11884c3d_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_43dcf09a_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_6c39e90c_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_cdff51fc_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_79644ce0_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_25c25516_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_35893731_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_75c178b6_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_3ca3763f_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_fd060c59_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_ac0c705b_date"
                  },
                  {
                    "parameterName": "date",
                    "queryName": "param_cc757122_date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Date Range"
              },
              "selection": {
                "defaultSelection": {
                  "range": {
                    "dataType": "DATE",
                    "min": {
                      "value": "now-90d/d"
                    },
                    "max": {
                      "value": "now/d"
                    }
                  }
                }
              }
            }
          }
        },
        {
          "name": "2bb5a93a",
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          },
          "widget": {
            "name": "5d20041c",
            "queries": [
              {
                "name": "param_edc83baf_team",
                "query": {
                  "datasetName": "edc83baf",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_b045a54d_team",
                "query": {
                  "datasetName": "b045a54d",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ea5a03bc_team",
                "query": {
                  "datasetName": "ea5a03bc",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_1ba1f227_team",
                "query": {
                  "datasetName": "1ba1f227",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_844c9d3f_team",
                "query": {
                  "datasetName": "844c9d3f",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ab9c2215_team",
                "query": {
                  "datasetName": "ab9c2215",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_421a0f5e_team",
                "query": {
                  "datasetName": "421a0f5e",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_220b8832_team",
                "query": {
                  "datasetName": "220b8832",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a5f2e9e3_team",
                "query": {
                  "datasetName": "a5f2e9e3",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_1a1916c2_team",
                "query": {
                  "datasetName": "1a1916c2",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_3a5b0fbd_team",
                "query": {
                  "datasetName": "3a5b0fbd",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_e93beeaa_team",
                "query": {
                  "datasetName": "e93beeaa",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a2f66709_team",
                "query": {
                  "datasetName": "a2f66709",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_a1da4b07_team",
                "query": {
                  "datasetName": "a1da4b07",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_76b4fbb2_team",
                "query": {
                  "datasetName": "76b4fbb2",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_45da29af_team",
                "query": {
                  "datasetName": "45da29af",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_d6fb5044_team",
                "query": {
                  "datasetName": "d6fb5044",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_fe905fe2_team",
                "query": {
                  "datasetName": "fe905fe2",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_11884c3d_team",
                "query": {
                  "datasetName": "11884c3d",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_43dcf09a_team",
                "query": {
                  "datasetName": "43dcf09a",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_75c178b6_team",
                "query": {
                  "datasetName": "75c178b6",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_3ca3763f_team",
                "query": {
                  "datasetName": "3ca3763f",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_fd060c59_team",
                "query": {
                  "datasetName": "fd060c59",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_ac0c705b_team",
                "query": {
                  "datasetName": "ac0c705b",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "param_cc757122_team",
                "query": {
                  "datasetName": "cc757122",
                  "parameters": [
                    {
                      "name": "team",
                      "keyword": "team"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "team",
                    "queryName": "param_edc83baf_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_b045a54d_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_ea5a03bc_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_1ba1f227_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_844c9d3f_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_ab9c2215_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_421a0f5e_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_220b8832_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_a5f2e9e3_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_1a1916c2_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_3a5b0fbd_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_e93beeaa_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_a2f66709_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_a1da4b07_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_76b4fbb2_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_45da29af_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_d6fb5044_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_fe905fe2_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_11884c3d_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_43dcf09a_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_75c178b6_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_3ca3763f_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_fd060c59_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_ac0c705b_team"
                  },
                  {
                    "parameterName": "team",
                    "queryName": "param_cc757122_team"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Team"
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "firmwarevdp"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      ],
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    },
    "applyModeEnabled": false
  },
  "parameters": [
    {
      "displayName": "date",
      "keyword": "date",
      "dataType": "DATE",
      "complexType": "RANGE",
      "defaultSelection": {
        "range": {
          "dataType": "DATE",
          "min": {
            "value": "now-90d/d"
          },
          "max": {
            "value": "now/d"
          }
        }
      }
    },
    {
      "displayName": "team",
      "keyword": "team",
      "dataType": "STRING",
      "defaultSelection": {
        "values": {
          "dataType": "STRING",
          "values": [
            {
              "value": "firmwarevdp"
            }
          ]
        }
      }
    },
    {
      "displayName": "limit",
      "keyword": "limit",
      "dataType": "DECIMAL",
      "defaultSelection": {
        "values": {
          "dataType": "DECIMAL",
          "values": [
            {
              "value": "-1"
            }
          ]
        }
      }
    },
    {
      "displayName": "li",
      "keyword": "li",
      "dataType": "STRING",
      "defaultSelection": {
        "values": {
          "dataType": "STRING",
          "values": [
            {
              "value": ""
            }
          ]
        }
      }
    },
    {
      "displayName": "dataset",
      "keyword": "dataset",
      "dataType": "STRING",
      "defaultSelection": {
        "values": {
          "dataType": "STRING",
          "values": [
            {
              "value": ""
            }
          ]
        }
      }
    },
    {
      "displayName": "dataPlatform",
      "keyword": "dataPlatform",
      "dataType": "STRING",
      "defaultSelection": {
        "values": {
          "dataType": "STRING",
          "values": [
            {
              "value": ""
            }
          ]
        }
      }
    },
    {
      "displayName": "databricks",
      "keyword": "databricks",
      "dataType": "STRING",
      "defaultSelection": {
        "values": {
          "dataType": "STRING",
          "values": [
            {
              "value": ""
            }
          ]
        }
      }
    }
  ]
}

{
  "name": "camera_connector_health.cc_health_output",
  "owner": "MediaExperience",
  "description": "Output of the camera connector health",
  "dependencies": [
    {
      "external": true,
      "dbname": "productsdb",
      "tablename": "devices",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "productsdb",
      "tablename": "gateways",
      "type": "table"
    },
    {
      "external": false,
      "dbname": "camera_connector_health",
      "tablename": "combined_connected_and_recording_durations",
      "type": "table"
    },
    {
      "external": false,
      "dbname": "camera_connector_health",
      "tablename": "cc_reversing_and_recording_durations",
      "type": "table"
    }
  ],
  "expectation": {
    "batch_mode": "KEEP_ALL"
  },
  "sqlite_report_config": {
    "report_name": "camera_connector_health",
    "_comment": "Hack: In order to support a snapshot report, the interval start is fixed to 12/1/2021. In order for those rows to be queried, fix the start/end date to include 12/1/2021.\nNOTE: Remember to update the config value of CustomMonthToProload in SQLite report registry whenever the final output month is changed.",
    "hardcoded_start_date": "DATE(\"2021-11-30\")",
    "hardcoded_end_date": "DATE(\"2021-12-02\")",
    "staleness_monitors": [
      {
        "hours": 7,
        "urgency": "LOW"
      },
      {
        "hours": 25,
        "urgency": "HIGH"
      }
    ],
    "team_runbook_url": "https://samsaradev.atlassian.net/wiki/x/14Wxqw"
  },
  "parameters": ["start_date", "end_date", "pipeline_execution_time"],
  "output": {
    "dbname": "camera_connector_health",
    "tablename": "cc_health_output",
    "type": "table",
    "partition": ["date"],
    "primary_key": ["org_id", "vg_id", "overall_end_ms"],
    "schema": [
      { "name": "org_id", "type": "long" },
      { "name": "vg_id", "type": "long" },
      { "name": "cm_id", "nullable": false, "type": "long" },
      { "name": "date", "nullable": false, "type": "date" },
      { "name": "connector_attribute", "nullable": false, "type": "integer" },
      { "name": "overall_start_ms", "type": "long" },
      { "name": "overall_end_ms", "type": "long" },
      { "name": "overall_trip_ms", "nullable": false, "type": "long" },
      { "name": "overall_connected_ms", "nullable": false, "type": "long" },
      { "name": "overall_recording_ms", "nullable": false, "type": "long" },
      { "name": "overall_reversing_ms", "nullable": false, "type": "long" },
      { "name": "overall_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "overall_recording_uptime_pct", "nullable": false, "type": "double" },
      { "name": "overall_connected_uptime_pct", "nullable": false, "type": "double" },
      { "name": "s1_start_ms", "nullable": false, "type": "long" },
      { "name": "s1_end_ms", "nullable": false, "type": "long" },
      { "name": "s1_trip_ms", "nullable": false, "type": "long" },
      { "name": "s1_connected_ms", "nullable": false, "type": "long" },
      { "name": "s1_recording_ms", "nullable": false, "type": "long" },
      { "name": "s1_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s1_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s1_recording_uptime_pct", "nullable": false, "type": "double" },
      { "name": "s2_start_ms", "nullable": false, "type": "long" },
      { "name": "s2_end_ms", "nullable": false, "type": "long" },
      { "name": "s2_trip_ms", "nullable": false, "type": "long" },
      { "name": "s2_connected_ms", "nullable": false, "type": "long" },
      { "name": "s2_recording_ms", "nullable": false, "type": "long" },
      { "name": "s2_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s2_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s2_recording_uptime_pct", "nullable": false, "type": "double" },
      { "name": "s3_start_ms", "nullable": false, "type": "long" },
      { "name": "s3_end_ms", "nullable": false, "type": "long" },
      { "name": "s3_trip_ms", "nullable": false, "type": "long" },
      { "name": "s3_connected_ms", "nullable": false, "type": "long" },
      { "name": "s3_recording_ms", "nullable": false, "type": "long" },
      { "name": "s3_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s3_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s3_recording_uptime_pct", "nullable": false, "type": "double" },
      { "name": "s4_start_ms", "nullable": false, "type": "long" },
      { "name": "s4_end_ms", "nullable": false, "type": "long" },
      { "name": "s4_trip_ms", "nullable": false, "type": "long" },
      { "name": "s4_connected_ms", "nullable": false, "type": "long" },
      { "name": "s4_recording_ms", "nullable": false, "type": "long" },
      { "name": "s4_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s4_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s4_recording_uptime_pct", "nullable": false, "type": "double" },
      { "name": "s5_start_ms", "nullable": false, "type": "long" },
      { "name": "s5_end_ms", "nullable": false, "type": "long" },
      { "name": "s5_trip_ms", "nullable": false, "type": "long" },
      { "name": "s5_connected_ms", "nullable": false, "type": "long" },
      { "name": "s5_recording_ms", "nullable": false, "type": "long" },
      { "name": "s5_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s5_recording_per_reversing_ms", "nullable": false, "type": "long" },
      { "name": "s5_recording_uptime_pct", "nullable": false, "type": "double" }
    ],
    "write_mode": "overwrite"
  }
}

{
  "test_cases": [
    {
      "label": "only trips, connected, and recording intervals within [start_date, end_date) interval are included",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552005000,
            "end_ms": 1635465610000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-09-30",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552005000,
            "end_ms": 1635465610000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552005000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-09-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635465610000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-29"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1641081625000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2022-01-02"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 5000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "only connected and recording intervals within trip bounds are counted",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552016000,
            "end_ms": 1635552021000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552016000,
            "end_ms": 1635552021000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 4000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 4000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552016000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "only recording intervals within connected bounds are counted",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552025000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552025000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 5000,
          "trip_duration_ms": 10000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "multiple connected intervals per trip are aggregated into connected_ms",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552016000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552017000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552018000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552019000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 3000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 3000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "multiple recording intervals are aggregated into recording_ms",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552016000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552017000,
            "end_ms": 1635552018000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552019000,
            "end_ms": 1635552020000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 3000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "after first connection (within a month of end date), trips without connected intervals are included",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552025000,
            "end_ms": 1635552030000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552035000,
            "end_ms": 1635552040000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552025000,
            "end_ms": 1635552030000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552035000,
            "end_ms": 1635552040000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1633132815000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 5000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        },
        {
          "cm_id": 101,
          "connected_ms": 0,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 0,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552025000,
          "vg_id": 100
        },
        {
          "cm_id": 101,
          "connected_ms": 0,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 0,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552035000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "before first connection, trips without connected intervals are not included",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552025000,
            "end_ms": 1635552030000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552035000,
            "end_ms": 1635552040000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552025000,
            "end_ms": 1635552030000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552035000,
            "end_ms": 1635552040000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552030000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552035000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552040000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 5000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552035000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "connected intervals without recording intervals are included",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552025000,
            "end_ms": 1635552030000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552035000,
            "end_ms": 1635552040000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552025000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552030000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552035000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552040000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 0,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552025000,
          "vg_id": 100
        },
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 0,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552035000,
          "vg_id": 100
        }
      ]
    },
    {
      "label": "only trips of the currently selected CM will be counted",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "cur-rentSeri-al",
            "camera_first_connected_at_ms": 1635552020000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          },
          {
            "org_id": 10,
            "device_id": 102,
            "product_id": 43,
            "serial": "current-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552020000,
            "end_ms": 1635552025000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-30",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000
          },
          {
            "vg_id": 100,
            "cm_id": 102,
            "start_ms": 1635552020000,
            "end_ms": 1635552025000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false
            },
            "date": "2021-10-29"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552025000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false
            },
            "date": "2021-10-30"
          }
        ]
      },
      "expected_data": [
        {
          "vg_id": 100,
          "cm_id": 102,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 5000,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552020000
        }
      ]
    },
    {
      "label": "only trips, connected, and recording intervals within [start_date, end_date) interval are included",
      "parameters": {
        "start_date": " '2021-10-26' ",
        "end_date": " '2021-11-01' ",
        "pipeline_execution_time": " '2021-11-02 12:00:00' "
      },
      "input_data": {
        "productsdb.devices": [
          {
            "org_id": 10,
            "id": 100,
            "product_id": 24,
            "camera_serial": "ran-domSeri-al",
            "camera_first_connected_at_ms": 1635552005000
          }
        ],
        "productsdb.gateways": [
          {
            "org_id": 10,
            "device_id": 101,
            "product_id": 43,
            "serial": "random-Serial"
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552005000,
            "end_ms": 1635465610000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-09-30",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "start_ms": 1635552015000,
            "end_ms": 1635552020000,
            "proto": {
              "ongoing": false
            },
            "date": "2021-10-29",
            "version": 101
          }
        ],
        "camera_connector_health.cc_recording_intervals": [
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552005000,
            "end_ms": 1635465610000
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015000,
            "end_ms": 1635552015050
          },
          {
            "vg_id": 100,
            "cm_id": 101,
            "start_ms": 1635552015050,
            "end_ms": 1635552020000
          }
        ],
        "kinesisstats.osdrearcameraconnected": [
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552005000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-09-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635465610000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-29"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552015000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1635552020000,
            "value": {
              "int_value": 0,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2021-10-30"
          },
          {
            "org_id": 10,
            "object_id": 100,
            "time": 1641081625000,
            "value": {
              "int_value": 1,
              "is_databreak": false,
              "is_end": false,
              "is_start": false
            },
            "date": "2022-01-02"
          }
        ]
      },
      "expected_data": [
        {
          "cm_id": 101,
          "connected_ms": 5000,
          "date": "2021-10-30",
          "org_id": 10,
          "recording_ms": 4950,
          "trip_duration_ms": 5000,
          "trip_start_ms": 1635552015000,
          "vg_id": 100
        }
      ]
    }
  ]
}

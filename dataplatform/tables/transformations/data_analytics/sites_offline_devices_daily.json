{
  "name": "data_analytics.sites_offline_devices_daily",
  "owner": "DataAnalytics",
  "description": "A periodic table containing a daily snapshot of the life state of every sites device.",
  "dependencies": [
    {
      "dbname": "dataprep",
      "tablename": "active_devices",
      "type": "table"
    },
    {
      "dbname": "dataprep",
      "tablename": "customer_metadata",
      "type": "table",
      "external": true,
      "schema_path": "dataprep/business/customer_metadata.metadata.json"
    },
    {
      "dbname": "clouddb",
      "tablename": "organizations",
      "type": "table",
      "external": true
    },
    {
      "dbname": "productsdb",
      "tablename": "devices",
      "type": "table",
      "external": true
    },
    {
      "dbname": "definitions",
      "tablename": "445_calendar",
      "type": "table",
      "external": true
    },
    {
      "dbname": "kinesisstats",
      "tablename": "osdhubserverdeviceheartbeat",
      "type": "table",
      "external": true
    },
    {
      "dbname": "dataprep",
      "tablename": "device_builds",
      "type": "table",
      "external": true
    },
    {
      "dbname": "kinesisstats",
      "tablename": "osdgrpchubserverdeviceheartbeat",
      "type": "table",
      "external": true
    }
  ],
  "parameters": ["start_date", "end_date"],
  "output": {
    "dbname": "data_analytics",
    "tablename": "sites_offline_devices_daily",
    "type": "table",
    "primary_key": ["device_id", "org_id", "date"],
    "partition": ["date"],
    "schema": [
      {
        "name": "date",
        "type": "string",
        "metadata": {
          "comment": "The date on which a device's life state was recorded in 'YYYY-mm-dd' format"
        }
      },
      {
        "name": "org_id",
        "type": "long",
        "metadata": {
          "comment": "$org_id_default_description"
        }
      },
      {
        "name": "sam_number",
        "type": "string",
        "metadata": {
          "comment": "A SAM number is a unique identifier for a Samsara customer. Each customer, in theory, should have a single SAM number. This SAM number can be found in the customer accountâ€™s page in Salesforce"
        }
      },
      {
        "name": "org_name",
        "type": "string",
        "metadata": {
          "comment": "The organization name registered with the 'org_id'"
        }
      },
      {
        "name": "internal_org",
        "type": "long",
        "metadata": {
          "comment": "An integer indicating whether the corresponding 'org_id' is an external customer or an internal Samsara customer (e.g., employees or devs) - 0 is external; 1 is internal"
        }
      },
      {
        "name": "device_name",
        "type": "string",
        "metadata": {
          "comment": "The device's registered name"
        }
      },
      {
        "name": "device_id",
        "type": "long",
        "metadata": {
          "comment": "$device_id_default_description"
        }
      },
      {
        "name": "product_id",
        "type": "long",
        "metadata": {
          "comment": "The internal ID of the Samsara product. Preview in ['definitions.products'](https://amundsen.internal.samsara.com/table_detail/cluster/delta/definitions/products)"
        }
      },
      {
        "name": "variant_type",
        "type": "string",
        "metadata": {
          "comment": "The product variant type of the device. See [RFC: Product Hardware Variants](https://paper.dropbox.com/doc/RFC-Product-Hardware-Variants--BiHJD6~OSGzIQIA8JvEqnQuXAQ-gGECL8xB8c77ZLAIqVu89)"
        }
      },
      {
        "name": "fw",
        "type": "string",
        "metadata": {
          "comment": "The firmware build of the device recorded on the given 'date'"
        }
      },
      {
        "name": "is_offline",
        "type": "string",
        "nullable": false,
        "metadata": {
          "comment": "A boolean indicating whether at least one heartbeat had been revieved by the device on the given 'date'"
        }
      }
    ],
    "write_mode": "merge"
  },
  "nonproduction": true
}

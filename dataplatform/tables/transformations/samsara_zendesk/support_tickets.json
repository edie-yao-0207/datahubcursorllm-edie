{
  "name": "samsara_zendesk.support_tickets",
  "owner": "DataEngineering",
  "nonproduction": true,
  "description": "Create a view of support tickets with corresponding product tags / attributes",
  "dependencies": [
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "ticket",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "organization",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "group",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "ticket_custom_field",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "ticket_field_history",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "ticket_form_history",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "user",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "ticket_tag",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "samsara_zendesk",
      "tablename": "historical_support_tickets",
      "type": "table"
    },
    {
      "external": true,
      "dbname": "definitions",
      "tablename": "445_calendar",
      "type": "table"
    }
  ],
  "backfill_start_date": "2015-06-19",
  "parameters": ["start_date", "end_date"],
  "output": {
    "dbname": "samsara_zendesk",
    "tablename": "support_tickets",
    "type": "table",
    "primary_key": ["ticket_id"],
    "schema": [
      {
        "name": "ticket_id",
        "type": "long",
        "metadata": {
          "comment": "The internal ticket id of the Zendesk support ticket submitted."
        }
      },
      {
        "name": "date_ticket_created",
        "type": "date",
        "metadata": {
          "comment": "The date on which the Zendesk ticket was created."
        }
      },
      {
        "name": "date_ticket_solved",
        "type": "date",
        "metadata": {
          "comment": "The date on which the Zendesk ticket was solved."
        }
      },
      {
        "name": "ticket_status",
        "type": "string",
        "metadata": {
          "comment": "This the current status of the ticket -- deleted, pending, closed, solved, open, hold, new."
        }
      },
      {
        "name": "ticket_form",
        "type": "string",
        "metadata": {
          "comment": "The type of ticket form the support agent selects based on the product area of the ticket -- Hardware Form, Hardware [NEW], Dan- Test, Industrial, Dashboard Form, Admin App Form, Docebo Support, Admin App [NEW], Dashboard [NEW], Hardware (Deactivated), Docebo Support Form, Driver App Form, Sales/CSM Escalation, Driver App [NEW], Dashboard (Deactivated), Admin App (Deactivated), Product Returns/Exchange Form, Sales/CSM Escalation Form, Non Support Related [NEW], Non Support Related Form, Driver App (Deactivated), Product Returns/Exchange [NEW], Non Support Related (Deactivated), GEOFF ONLY - TEST - DO NOT USE, Product Returns/Exchange (Deactivated), NPS Follow up (Product Only) [NEW], NPS Follow up (Product Only) (Deactivated), etc."
        }
      },
      {
        "name": "case_reason",
        "type": "string",
        "metadata": {
          "comment": "The category of the type of issue of the ticket -- RMA::Warranty Exchange, Problem Without Issue, RMA::Cable Swap, Service Degradation, RMA::Exchange, RMA::Status Check, Audit::In House Audit, RMA::Return Label, Sales Escalation, Question, How-To, Feedback, Audit::Roadside Audit, RMA::Customer Satisfaction, Problem With Issue, RMA::Sales Exchange, Webinar, Other::Callback No Answer, etc."
        }
      },
      {
        "name": "admin_app_area",
        "type": "string",
        "metadata": {
          "comment": "If the ticket_form is Admin App Form, this field indiciates the specific issue within the admin app. Otherwise it is null -- Alerts, Sign in/Sign Out, Safety, HOS & Compliance, Performance, Fleet Overview."
        }
      },
      {
        "name": "driver_app_area",
        "type": "string",
        "metadata": {
          "comment": "If the ticket_form is Driver App Form, this field indiciates the specific issue within the driver app. Otherwise it is null -- HOS & Compliance::Roadside Inspections::DOT Inspection Screen, HOS & Compliance::Auto Duty::Connectivity, HOS & Compliance::Violations::Shifts, HOS & Compliance::Auto Duty::Driving, HOS & Compliance::Exemptions::Canadian Exemptions, Sign In/Sign Out::Credentials, Workflow::Routes & Dispatch::Navigation, etc."
        }
      },
      {
        "name": "hardware_area_new",
        "type": "string",
        "metadata": {
          "comment": "Deprecated. DO NOT USE THIS."
        }
      },
      {
        "name": "dashboard_area",
        "type": "string",
        "metadata": {
          "comment": "If the ticket_form is Dashboard Form, this field indiciates the specific issue within the dashboard. Otherwise it is null -- Fleet::Overview::Fleet List, Fleet::Reports::Compliance::Drivers HOS::Status Updates, Settings::Developer::API::Safety, Platform::Settings::Drivers, Fleet::Overview::Vehicle Show::Diagnostics::Odometer, Fleet::Overview::Vehicle Overview [NOT Diagnostics], Fleet::Reports::General::Activity Report (Not Odometer Related), etc."
        }
      },
      {
        "name": "reason_for_return",
        "type": "string",
        "metadata": {
          "comment": "If the ticket_form is Product Returns/Exchange Form, this field indiciates which product needs to be returns and why it was returned. Otherwise it is null -- Cable Swap::Vehicle Issue, Sensor::Sensor has no readings, Vehicle Gateway::Low Battery, Vehicle Gateway::No Power (Fails to Power Up), Sensor::Sensor Won't Connect, Camera::(CM3X): Profile C, Cable Swap::Sales Process, Asset Gateway::MCU Error, Vehicle Gateway::No Cellular (Blinking Orange), VG::Cable Swap::Vehicle Issue, Asset Gateway::Low Battery, etc."
        }
      },
      {
        "name": "product_team",
        "type": "string",
        "metadata": {
          "comment": "The internal Samsara product team that is responsible for the product in the issue of the ticket -- Alerts, Safety Workflow, EuroFleet Product Group, Equipment, Fuel Services, Integrations, VG Services, Trailer / Reefer, Camera Awareness, Platform UX, Safety Firmware, Multicam Product Team, ADAS, Fleet Maintenance, Routing, Location Services, Fleet Firmware, Compliance, Eurofleet, Platform Admin, Mexico, Docs and Messaging, Safety Scoring and Insights, Safety Platform, Platform Reports, Driver App, Admin App Team, Platform Operations, Powered & Unpowered Assets, Developer Ecosystem (API), Platform Security, Cloud, Compliance Canada, OEM Integration, etc."
        }
      },
      {
        "name": "product_group",
        "type": "string",
        "metadata": {
          "comment": "The internal Samsara product group that is responsible for the product in the issue in the ticket -- pg_eurofleet, pg_connected_driver, pg_platform, unknown, pg_assets, pg_fleet_app_ecosystem, #N/A, pg_dashcam, pg_telematics, non-product_related."
        }
      },
      {
        "name": "product_new",
        "type": "string",
        "metadata": {
          "comment": "The product the ticket issue is related to -- Camera::CMVR::CMVR41A, Asset Gateway::AG45, Camera::CM31, Sensor::DM11, Camera::CM32, Camera::CM25::CM25E, Vehicle Gateway::VG33, Asset Gateway::AG41, Sensor::CRGO, Sensor::EM21, Vehicle Gateway::VG34 EU, Industrial::VS2, Industrial::HM11, Driver ID Token, Sensor::IDRDR, Asset Gateway::AG41 EU, Asset Gateway::AG15, Sensor::EM12, Vehicle Gateway::VG34, Camera::CMVR::CMVR81A, Asset Gateway::AG24 EU, Camera::CM25::CM25I, Asset Gateway::AG24, Installation Accessories, Cable Swap, Camera::CM22, Sensor::EM23, Sensor::EM22, Industrial::IG21, Industrial::GW22, Cable:: Promo Cable, Camera::CM12, Camera::CM11, Cable:: Cable Swap, Industrial::PM10, Industrial::IM31, Industrial::IM33, Industrial::PM20, etc."
        }
      },
      {
        "name": "ticket_group",
        "type": "string",
        "metadata": {
          "comment": "The group of agents that are going be handling the ticket -- Industrial Support, PSE, TAM - German, Assistance, French Speakers, Small Fleet, Dev Team, Support Management, TAM - Marshall, TAM - Donny, Docebo, Commercial Team, TAM - Nagy, Docebo , Tier 2, Escalations, Tier 3, [EC] New View Test Group, Premier Team, Standard Team, Spanish Speakers, Micro-fleets, Enterprise Team, Mid-Market Team, German Speaker, Standard Team 2, Support, TAM - Chunpreet, Tier 1, Assist Team, UK Support, French VM, NPS Group, Dashboard, etc."
        }
      },
      {
        "name": "ticket_assignee",
        "type": "string",
        "metadata": {
          "comment": "The agent that is currently handlig the ticket (could change if passed to another agent)."
        }
      },
      {
        "name": "segment",
        "type": "string",
        "metadata": {
          "comment": "The sales segment of the ticket creator's Samsara account -- MM, ENT, Management, Mid-Market, Connected Worker, Industrial, -, SMB, ADR, Mid Market, Channel AE, Enterprise, Commercial."
        }
      },
      {
        "name": "customer_type",
        "type": "string",
        "metadata": {
          "comment": "The role of the person that wrote the ticket -- Sales, Mechanic/Tech, Driver, Admin, Other."
        }
      },
      {
        "name": "global_geography",
        "type": "string",
        "metadata": {
          "comment": "The region where the ticket creator is located in -- BENELUX, France, Canada East, Canada West, Other, US, -, South & Midwest, Central, Mexico, East, DACH, West, UK & I, Northeast, UK, Iberia."
        }
      },
      {
        "name": "calendar_month_created",
        "type": "string",
        "metadata": {
          "comment": "The month in which the ticket was created and is of the format YYYY-M (ex: 2021-5 or 2020-10)."
        }
      },
      {
        "name": "fiscal_month_created",
        "type": "string",
        "metadata": {
          "comment": "The fiscal month in which the ticket was created (ex: FY21_5 or FY20_10)."
        }
      },
      {
        "name": "fiscal_quarter_created",
        "type": "string",
        "metadata": {
          "comment": "The fiscal quarter in which the ticket was created (ex: FY21'Q1)."
        }
      },
      {
        "name": "week_display",
        "type": "string",
        "metadata": {
          "comment": "The week in which the ticket was created. The beginning of the week is Sunday (ex: Wk of 2020-03-29)."
        }
      },
      {
        "name": "is_product_related",
        "type": "boolean",
        "metadata": {
          "comment": "Indicates if the ticket is related to a Samsara product."
        }
      },
      {
        "name": "issue_area",
        "type": "string",
        "metadata": {
          "comment": "Deprecated. DO NOT USE THIS."
        }
      },
      {
        "name": "case_reason_issue_area",
        "type": "string",
        "metadata": {
          "comment": "Deprecated. DO NOT USE THIS."
        }
      },
      {
        "name": "is_fleet_ticket",
        "type": "boolean",
        "metadata": {
          "comment": "Indicates if the issue is related to a fleet product."
        }
      },
      {
        "name": "is_merged_ticket",
        "type": "boolean",
        "metadata": {
          "comment": "Indicates if this ticket has been merged with another ticket."
        }
      },
      {
        "name": "sam_number",
        "type": "string",
        "metadata": {
          "comment": "The internal Samsara ID of the associated customer."
        }
      },
      {
        "name": "date_ticket_updated",
        "type": "date",
        "metadata": {
          "comment": "The date the ticket was last updated at."
        }
      },
      {
        "name": "is_child_ticket",
        "type": "boolean",
        "metadata": {
          "comment": "A flag indicating if a ticket is a child (internal) ticket or not."
        }
      }
    ],
    "write_mode": "merge"
  },
  "disabled_regions": ["eu-west-1", "ca-central-1"]
}

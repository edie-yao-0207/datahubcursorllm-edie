{
  "test_cases": [
    {
      "label": "identify zero speeding time when not driving",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579942799999,
            "end_ms": 1579953600001,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 0,
              "gps_speed_meters_per_second": 0
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 0,
                "gps_speed_meters_per_second": 0
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 0,
              "gps_speed_meters_per_second": 0
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 0,
                "gps_speed_meters_per_second": 0
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 0,
                "gps_speed_meters_per_second": 0
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 0,
              "gps_speed_meters_per_second": 0
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 0,
                "gps_speed_meters_per_second": 0
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "identify no ECU speeding when driving at low speed",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579942799999,
            "end_ms": 1579953600001,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "identify no GPS speeding when driving at low speed",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579942799999,
            "end_ms": 1579953600001,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "gps_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "gps_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "gps_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "gps_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "gps_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "gps_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "gps_speed_meters_per_second": 5
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "find ECU speeding interval datapoint using default threshold",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579936400000,
            "end_ms": 1579956400000,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 30
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 3600000
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "find ECU speeding interval datapoint amongst other datapoints in the same hour using default threshold",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579936400000,
            "end_ms": 1579956400000,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579947000000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579947600000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579947600000,
            "value": {
              "ecu_speed_meters_per_second": 30
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579947000000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579948200000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579948200000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579947600000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579948800000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579948800000,
            "value": {
              "ecu_speed_meters_per_second": 30
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579948200000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579949400000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579949400000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579948800000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 1200000
        }
      ]
    },
    {
      "label": "find ECU speeding interval datapoint using default org custom threshold",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579936400000,
            "end_ms": 1579956400000,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 10
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 10
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 10
              }
            }
          }
        ],
        "ecodriving_report.speed_profile_threshold_intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "profile_id": 200,
            "interval_start": "2020-01-25 10:00:00",
            "interval_end": "2020-01-25 11:00:00",
            "custom_speed_profile_threshold_meters_per_second": 5.0
          }
        ],
        "fueldb_shards.driver_efficiency_score_profiles": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "is_default": 1,
            "profile_uuid": 200
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 3600000
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "find ECU speeding interval datapoint using device custom threshold",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579936400000,
            "end_ms": 1579956400000,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 10
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 10
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 10
              }
            }
          }
        ],
        "ecodriving_report.speed_profile_threshold_intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "profile_id": 200,
            "interval_start": "2020-01-25 10:00:00",
            "interval_end": "2020-01-25 11:00:00",
            "custom_speed_profile_threshold_meters_per_second": 5.0
          }
        ],
        "fueldb_shards.driver_efficiency_profiles_devices": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "profile_id": 200
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 3600000
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "find only one ECU speeding interval datapoint when all three threshold routes are met",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579936400000,
            "end_ms": 1579956400000,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 50
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 50
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 50
              }
            }
          }
        ],
        "ecodriving_report.speed_profile_threshold_intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "profile_id": 200,
            "interval_start": "2020-01-25 10:00:00",
            "interval_end": "2020-01-25 11:00:00",
            "custom_speed_profile_threshold_meters_per_second": 5.0
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "profile_id": 300,
            "interval_start": "2020-01-25 10:00:00",
            "interval_end": "2020-01-25 11:00:00",
            "custom_speed_profile_threshold_meters_per_second": 5.0
          }
        ],
        "fueldb_shards.driver_efficiency_profiles_devices": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "profile_id": 200
          }
        ],
        "fueldb_shards.driver_efficiency_score_profiles": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "is_default": 1,
            "profile_uuid": 300
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 3600000
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "limit speeding duration by the current engine state if present",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579944600000,
            "end_ms": 1579953600001,
            "state": "ON"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 30
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 1800000
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    },
    {
      "label": "ignore speeding when the engine state is not ON or IDLE",
      "parameters": {
        "start_date": " '2020-01-25' ",
        "end_date": " '2020-01-26' "
      },
      "input_data": {
        "engine_state.intervals": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1579944600000,
            "end_ms": 1579953600001,
            "state": "OFF"
          }
        ],
        "kinesisstats_window.location": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579942800000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579946400000,
            "value": {
              "ecu_speed_meters_per_second": 30
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579942800000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            },
            "next": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579953600000,
              "value": {
                "ecu_speed_meters_per_second": 5
              }
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "device_id": 200,
            "time": 1579953600000,
            "value": {
              "ecu_speed_meters_per_second": 5
            },
            "previous": {
              "date": "2020-01-25",
              "org_id": 100,
              "device_id": 200,
              "time": 1579946400000,
              "value": {
                "ecu_speed_meters_per_second": 30
              }
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 09:00:00",
          "interval_end": "2020-01-25 10:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 10:00:00",
          "interval_end": "2020-01-25 11:00:00",
          "over_speed_ms": 0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2020-01-25 12:00:00",
          "interval_end": "2020-01-25 13:00:00",
          "over_speed_ms": 0
        }
      ]
    }
  ]
}

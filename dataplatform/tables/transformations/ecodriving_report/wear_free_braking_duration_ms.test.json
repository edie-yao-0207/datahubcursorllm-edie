{
  "test_cases": [
    {
      "label": "Aggregate data for a single hourly interval within a single day.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:05:00 GMT+0000",
            "time": 1717491900000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:10:00 GMT+0000",
            "time": 1717492200000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:05:00 GMT+0000",
            "time": 1717491900000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:10:00 GMT+0000",
            "time": 1717492200000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "pheonetic_spelling_of_driver_id": "Schfifty Five",
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Mon Jun 03 2024 23:00:00 GMT+0000",
            "start_time": 1717455600000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 23:00:00 GMT+0000",
            "end_time": 1717542000000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 9000
        }
      ]
    },
    {
      "label": "Data spanning across multiple hours within a day.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 08:30:00 GMT+0000",
            "time": 1717489800000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:30:00 GMT+0000",
            "time": 1717493400000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 08:30:00 GMT+0000",
            "time": 1717489800000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:30:00 GMT+0000",
            "time": 1717493400000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 08:00:00 GMT+0000",
            "start_time": 1717488000000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 10:00:00 GMT+0000",
            "end_time": 1717495200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 08:00:00",
          "interval_end": "2024-06-04 09:00:00",
          "org_id": 100,
          "duration_ms": 2000
        },
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 4000
        }
      ]
    },
    {
      "label": "No data",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [],
        "fuel_energy_efficiency_report.driver_assignments": []
      },
      "expected_data": []
    },
    {
      "label": "No driver assignments.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:05:00 GMT+0000",
            "time": 1717491900000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": []
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 3000
        }
      ]
    },
    {
      "label": "Large data set over multiple days.",
      "parameters": {
        "start_date": " '2024-06-01' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-01",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Sat Jun 01 2024 09:00:00 GMT+0000",
            "time": 1717232400000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-02",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Sun Jun 02 2024 09:00:00 GMT+0000",
            "time": 1717318800000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-03",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Mon Jun 03 2024 09:00:00 GMT+0000",
            "time": 1717405200000,
            "value": {
              "int_value": 3000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-01",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Sat Jun 01 2024 09:05:00 GMT+0000",
            "time": 1717232700000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-02",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Sun Jun 02 2024 09:05:00 GMT+0000",
            "time": 1717319100000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-03",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Mon Jun 03 2024 09:05:00 GMT+0000",
            "time": 1717405500000,
            "value": {
              "int_value": 3000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Sat Jun 01 2024 08:00:00 GMT+0000",
            "start_time": 1717228800000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Sat Jun 01 2024 18:00:00 GMT+0000",
            "end_time": 1717264800000
          },
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 56,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Sun Jun 02 2024 08:00:00 GMT+0000",
            "start_time": 1717315200000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Sun Jun 02 2024 18:00:00 GMT+0000",
            "end_time": 1717351200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-01",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-01 09:00:00",
          "interval_end": "2024-06-01 10:00:00",
          "org_id": 100,
          "duration_ms": 2000
        },
        {
          "date": "2024-06-02",
          "device_id": 200,
          "driver_id": 56,
          "interval_start": "2024-06-02 09:00:00",
          "interval_end": "2024-06-02 10:00:00",
          "org_id": 100,
          "duration_ms": 4000
        },
        {
          "date": "2024-06-03",
          "device_id": 200,
          "driver_id": 0,
          "interval_start": "2024-06-03 09:00:00",
          "interval_end": "2024-06-03 10:00:00",
          "org_id": 100,
          "duration_ms": 6000
        }
      ]
    },
    {
      "label": "No regen braking data.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 08:00:00 GMT+0000",
            "start_time": 1717488000000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 10:00:00 GMT+0000",
            "end_time": 1717495200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 2000
        }
      ]
    },
    {
      "label": "No retarder braking data.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 08:00:00 GMT+0000",
            "start_time": 1717488000000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 10:00:00 GMT+0000",
            "end_time": 1717495200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 1000
        }
      ]
    },
    {
      "label": "Overlapping regen and retarder braking instances.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:00:00 GMT+0000",
            "time": 1717491600000,
            "value": {
              "int_value": 5000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:05:00 GMT+0000",
            "time": 1717491900000,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 09:03:00 GMT+0000",
            "time": 1717491780000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 08:00:00 GMT+0000",
            "start_time": 1717488000000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 10:00:00 GMT+0000",
            "end_time": 1717495200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 09:00:00",
          "interval_end": "2024-06-04 10:00:00",
          "org_id": 100,
          "duration_ms": 8000
        }
      ]
    },
    {
      "label": "Data points inside the date range.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-03",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Mon Jun 03 2024 08:00:00 GMT+0000",
            "time": 1717406400,
            "value": {
              "int_value": 1000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-05",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Wed Jun 05 2024 10:00:00 GMT+0000",
            "time": 1717572000,
            "value": {
              "int_value": 2000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-03",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Mon Jun 03 2024 09:00:00 GMT+0000",
            "time": 1717410000,
            "value": {
              "int_value": 3000,
              "is_end": false,
              "is_databreak": false
            }
          },
          {
            "date": "2024-06-05",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Wed Jun 05 2024 11:00:00 GMT+0000",
            "time": 1717575600,
            "value": {
              "int_value": 4000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 08:00:00 GMT+0000",
            "start_time": 1717488000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 18:00:00 GMT+0000",
            "end_time": 1717524000
          }
        ]
      },
      "expected_data": []
    },
    {
      "label": "Duration transcending an hour boundary allocated entirely within hour in which it starts.",
      "explanation": "The duration starts at 10:58:00 and ends at 11:01:00. The duration is entirely within the 10:00:00 to 11:00:00 hour.",
      "parameters": {
        "start_date": " '2024-06-04' ",
        "end_date": " '2024-06-05' "
      },
      "input_data": {
        "kinesisstats.osDRegenBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 10:58:00 GMT+0000",
            "time": 1717498680000,
            "value": {
              "int_value": 3000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "kinesisstats.osDAggregateDurationRetarderBrakingMs": [
          {
            "date": "2024-06-04",
            "org_id": 100,
            "object_id": 200,
            "dummy_time_stamp_of_unix_timestamp_below_for_readability": "Tue Jun 04 2024 10:59:00 GMT+0000",
            "time": 1717498740000,
            "value": {
              "int_value": 4000,
              "is_end": false,
              "is_databreak": false
            }
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "org_id": 100,
            "device_id": 200,
            "driver_id": 55,
            "dummy_time_stamp_of_unix_start_timestamp_below_for_readability": "Tue Jun 04 2024 10:00:00 GMT+0000",
            "start_time": 1717495200000,
            "dummy_time_stamp_of_unix_end_timestamp_below_for_readability": "Tue Jun 04 2024 11:00:00 GMT+0000",
            "end_time": 1717498800000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-06-04",
          "device_id": 200,
          "driver_id": 55,
          "interval_start": "2024-06-04 10:00:00",
          "interval_end": "2024-06-04 11:00:00",
          "org_id": 100,
          "duration_ms": 7000
        }
      ]
    }
  ]
}

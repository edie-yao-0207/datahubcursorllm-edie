{
  "name": "apptelematics.trip_platform_assignment",
  "owner": "AppTelematics",
  "description": "Join app telematics trips with mobile logs so we know what mobile platform/os combination logged a trip",
  "backfill_start_date": "2022-07-27",
  "nonproduction": true,
  "disabled_regions": ["us-west-2", "eu-west-1", "ca-central-1"],
  "dependencies": [
    {
      "dbname": "trips2db_shards",
      "tablename": "trips",
      "type": "table",
      "external": true
    },
    {
      "dbname": "datastreams",
      "tablename": "mobile_logs",
      "type": "table",
      "external": true
    }
  ],
  "parameters": ["start_date", "end_date"],
  "output": {
    "dbname": "apptelematics",
    "tablename": "trip_platform_assignment",
    "type": "table",
    "partition": ["date"],
    "primary_key": ["date", "trip_start_ms", "mobile_log_timestamp", "org_id", "device_id", "driver_id"],
    "write_mode": "overwrite",
    "schema": [
      {
        "name": "date",
        "type": "date",
        "metadata": {
          "comment": "$date_default_description"
        }
      },
      {
        "name": "trip_start_ms",
        "type": "long",
        "metadata": {
          "comment": "The start time (in milliseconds) of the trip"
        }
      },
      {
        "name": "mobile_log_timestamp",
        "type": "timestamp",
        "metadata": {
          "comment": "The timestamp of the mobile log of DRIVER_TELEMATICS_LOCATION_TRACKING_STARTED that is being associated with the trip"
        }
      },
      {
        "name": "org_id",
        "type": "long",
        "metadata": {
          "comment": "$org_id_default_description"
        }
      },
      {
        "name": "device_id",
        "type": "long",
        "metadata": {
          "comment": "$device_id_default_description"
        }
      },
      {
        "name": "driver_id",
        "type": "long",
        "metadata": {
          "comment": "$driver_id_default_description"
        }
      },
      {
        "name": "mobile_platform",
        "type": "string",
        "metadata": {
          "comment": "The mobile platform of the device that logged the trip"
        }
      },
      {
        "name": "mobile_os_version",
        "type": "string",
        "metadata": {
          "comment": "The os version of the device that logged the trip"
        }
      },
      {
        "name": "mobile_bundle_version",
        "type": "string",
        "metadata": {
          "comment": "The app bundle version of the device that logged the trip"
        }
      }
    ]
  }
}

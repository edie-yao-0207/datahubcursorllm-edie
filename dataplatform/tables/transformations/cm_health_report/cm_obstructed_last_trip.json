{
  "name": "cm_health_report.cm_obstructed_last_trip",
  "owner": "MediaExperience",
  "description": "The last trip of cameras that ever had an obstruction event, determining if the obstruction happened on the last trip is done on the output node",
  "dependencies": [
    { "external": false, "dbname": "cm_health_report", "tablename": "cm_obstructions", "type": "table" },
    { "external": true, "dbname": "trips2db_shards", "tablename": "trips", "type": "table" }
  ],
  "expectation": {
    "batch_mode": "REMOVE_UNEXPECTED"
  },
  "parameters": ["start_date", "end_date"],
  "output": {
    "dbname": "cm_health_report",
    "tablename": "cm_obstructed_last_trip",
    "type": "table",
    "partition": [],
    "primary_key": ["org_id", "device_id"],
    "schema": [
      {
        "name": "org_id",
        "type": "long",
        "metadata": {
          "comment": "$org_id_default_description"
        }
      },
      {
        "name": "device_id",
        "type": "long",
        "metadata": {
          "comment": "$device_id_default_description"
        }
      },
      {
        "name": "trip_start_ms",
        "type": "long",
        "metadata": {
          "comment": "The start.time of the latest completed trip"
        }
      }
    ],
    "write_mode": "overwrite"
  }
}

{
  "test_cases": [
    {
      "label": "only trips after vg first connected are included.",
      "parameters": {
        "start_date": " '1970-01-01' ",
        "end_date": " '1970-01-03' ",
        "pipeline_execution_time": " '1970-01-10 12:00:00' "
      },
      "input_data": {
        "cm_health_report.cm_2x_3x_linked_vgs": [
          {
            "org_id": 10,
            "vg_device_id": 100,
            "product_id": 24,
            "linked_cm_id": 101,
            "cm_product_id": 44,
            "upper_camera_serial": "CXXX-XXX-XXX",
            "camera_first_connected_at_ms": 50
          }
        ],
        "trips2db_shards.trips": [
          {
            "org_id": 10,
            "device_id": 100,
            "proto": {
              "start": {
                "time": 20
              },
              "end": {
                "time": 100
              },
              "ongoing": false
            },
            "date": "1970-01-01",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "proto": {
              "start": {
                "time": 150
              },
              "end": {
                "time": 200
              },
              "ongoing": false
            },
            "date": "1970-01-01",
            "version": 101
          },
          {
            "org_id": 10,
            "device_id": 100,
            "proto": {
              "start": {
                "time": 250
              },
              "end": {
                "time": 300
              },
              "ongoing": false
            },
            "date": "1970-01-01",
            "version": 201
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 10,
          "device_id": 100,
          "product_id": 24,
          "cm_device_id": 101,
          "cm_product_id": 44,
          "start_ms": 150,
          "end_ms": 200,
          "duration_ms": 50,
          "date": "1970-01-01",
          "on_trip": true
        },
        {
          "org_id": 10,
          "device_id": 100,
          "product_id": 24,
          "cm_device_id": 101,
          "cm_product_id": 44,
          "start_ms": 250,
          "end_ms": 300,
          "duration_ms": 50,
          "date": "1970-01-01",
          "on_trip": true
        }
      ]
    }
  ]
}

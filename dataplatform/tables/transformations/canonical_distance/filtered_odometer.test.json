{
  "test_cases": [
    {
      "label": "test simple cases with valid odometers",
      "parameters": {
        "start_date": "'2020-01-01'",
        "end_date": "'2020-01-02'"
      },
      "input_data": {
        "kinesisstats_window.osdodometer": [
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 1000, "time": 60000 },
            "previous": null,
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 2000, "time": 120000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 1000, "time": 60000 },
              "previous": null,
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 4000, "time": 180000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 2000, "time": 120000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 6000, "time": 240000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 4000, "time": 180000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 8000, "time": 360000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 6000, "time": 240000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 2,
            "object_id": 2,
            "value": { "int_value": 3000, "time": 61000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 8000, "time": 360000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 2,
            "object_id": 2,
            "value": { "int_value": 5000, "time": 121000 },
            "previous": {
              "org_id": 2,
              "object_id": 2,
              "value": { "int_value": 3000, "time": 61000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 2,
            "object_id": 2,
            "value": { "int_value": 7000, "time": 181000 },
            "previous": {
              "org_id": 2,
              "object_id": 2,
              "value": { "int_value": 5000, "time": 121000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-02"
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 60000,
          "osd_odometer": 1000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 120000,
          "osd_odometer": 2000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 180000,
          "osd_odometer": 4000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 240000,
          "osd_odometer": 6000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 360000,
          "osd_odometer": 8000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 2,
          "device_id": 2,
          "time_ms": 61000,
          "osd_odometer": 3000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 2,
          "device_id": 2,
          "time_ms": 121000,
          "osd_odometer": 5000,
          "valid": true,
          "date": "2020-01-01"
        }
      ]
    },
    {
      "label": "test case with invalid odometer values",
      "parameters": {
        "start_date": "'2020-01-01'",
        "end_date": "'2020-01-02'"
      },
      "input_data": {
        "kinesisstats_window.osdodometer": [
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 1000, "time": 60000 },
            "previous": null,
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 2000, "time": 120000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 1000, "time": 60000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 1000000, "time": 140000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 2000, "time": 120000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 1000000, "time": 150000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 1000000, "time": 140000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 1000000, "time": 160000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 1000000, "time": 150000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 4000, "time": 180000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 1000000, "time": 160000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 6000, "time": 240000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 4000, "time": 180000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          },
          {
            "org_id": 1,
            "object_id": 1,
            "value": { "int_value": 8000, "time": 360000 },
            "previous": {
              "org_id": 1,
              "object_id": 1,
              "value": { "int_value": 6000, "time": 240000 },
              "date": "2020-01-01"
            },
            "date": "2020-01-01"
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 60000,
          "osd_odometer": 1000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 120000,
          "osd_odometer": 2000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 140000,
          "osd_odometer": 1000000,
          "valid": false,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 150000,
          "osd_odometer": 1000000,
          "valid": false,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 160000,
          "osd_odometer": 1000000,
          "valid": false,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 180000,
          "osd_odometer": 4000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 240000,
          "osd_odometer": 6000,
          "valid": true,
          "date": "2020-01-01"
        },
        {
          "org_id": 1,
          "device_id": 1,
          "time_ms": 360000,
          "osd_odometer": 8000,
          "valid": true,
          "date": "2020-01-01"
        }
      ]
    }
  ]
}

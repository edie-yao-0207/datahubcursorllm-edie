{
  "test_cases": [
    {
      "label": "test total distance",
      "parameters": {
        "start_date": "'2020-01-01'",
        "end_date": "'2020-01-02'",
        "pipeline_execution_time": "'1970-01-01T00:00:05Z'"
      },
      "input_data": {
        "canonical_distance.filtered_odometer": [
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 1500,
            "valid": true,
            "osd_odometer": 0
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 2000,
            "valid": true,
            "osd_odometer": 10
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 3000,
            "valid": true,
            "osd_odometer": 20
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 4000,
            "valid": false,
            "osd_odometer": 20000
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 5000,
            "valid": true,
            "osd_odometer": 60
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 6000,
            "valid": true,
            "osd_odometer": 60
          },
          {
            "org_id": 2,
            "device_id": 2,
            "date": "2020-01-01",
            "time_ms": 0,
            "valid": true,
            "osd_odometer": 0
          },
          {
            "org_id": 2,
            "device_id": 2,
            "date": "2020-01-01",
            "time_ms": 2000,
            "valid": true,
            "osd_odometer": 100
          }
        ],
        "canonical_distance.interpolated_gps": [
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 0,
            "gps_distance": 0.0,
            "previous": null
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 1000,
            "gps_distance": 5.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 0,
              "gps_distance": 0.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 2000,
            "gps_distance": 10.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 1000,
              "gps_distance": 5.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 3000,
            "gps_distance": 30.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 2000,
              "gps_distance": 10.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 4000,
            "gps_distance": 40.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 3000,
              "gps_distance": 30.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 5000,
            "gps_distance": 50.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 4000,
              "gps_distance": 40.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 7000,
            "gps_distance": 80.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 5000,
              "gps_distance": 50.0
            }
          },
          {
            "org_id": 2,
            "device_id": 1,
            "date": "2020-01-01",
            "time_ms": 8000,
            "gps_distance": 90.0,
            "previous": {
              "org_id": 2,
              "device_id": 1,
              "date": "2020-01-01",
              "time_ms": 7000,
              "gps_distance": 80.0
            }
          },
          {
            "org_id": 2,
            "device_id": 2,
            "date": "2020-01-01",
            "time_ms": 0,
            "gps_distance": 0.0,
            "previous": null
          },
          {
            "org_id": 2,
            "device_id": 2,
            "date": "2020-01-01",
            "time_ms": 2000,
            "gps_distance": 10.0,
            "previous": {
              "org_id": 2,
              "device_id": 2,
              "date": "2020-01-01",
              "time_ms": 0,
              "gps_distance": 0.0
            }
          }
        ],
        "productsdb.devices": [
          {
            "id": 1,
            "org_id": 2,
            "make": "mercedes",
            "model": "sprinter"
          },
          {
            "id": 2,
            "org_id": 2,
            "make": "nissan",
            "model": "rogue"
          }
        ],
        "definitions.canonical_distance_excluded_mmys": [
          {
            "make": "nissan",
            "model": "rogue"
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 2,
          "device_id": 1,
          "date": "2020-01-01",
          "time_ms": 1500,
          "distance": 0,
          "interpolated": 1,
          "osd_odometer": 0
        },
        {
          "org_id": 2,
          "device_id": 1,
          "date": "2020-01-01",
          "time_ms": 2000,
          "distance": 10.0,
          "interpolated": 1,
          "osd_odometer": 10
        },
        {
          "org_id": 2,
          "device_id": 1,
          "date": "2020-01-01",
          "time_ms": 3000,
          "distance": 10.0,
          "interpolated": 1,
          "osd_odometer": 20
        },
        {
          "org_id": 2,
          "device_id": 1,
          "date": "2020-01-01",
          "time_ms": 4000,
          "distance": 20.0,
          "interpolated": 1,
          "osd_odometer": 20
        },
        {
          "org_id": 2,
          "device_id": 1,
          "date": "2020-01-01",
          "time_ms": 5000,
          "distance": 20.0,
          "interpolated": 1,
          "osd_odometer": 60
        },
        {
          "org_id": 2,
          "device_id": 2,
          "date": "2020-01-01",
          "time_ms": 0,
          "distance": null,
          "interpolated": 0,
          "osd_odometer": null
        },
        {
          "org_id": 2,
          "device_id": 2,
          "date": "2020-01-01",
          "time_ms": 2000,
          "distance": 10.0,
          "interpolated": 0,
          "osd_odometer": null
        }
      ]
    }
  ]
}

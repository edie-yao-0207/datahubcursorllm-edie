{
  "test_cases": [
    {
      "label": "map a single stat with no historical value",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedgpsdistance": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "double_value": 100.0
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "distance_traveled_m": null
        }
      ]
    },
    {
      "label": "map stats for a single object_id and single org_id",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedgpsdistance": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "double_value": 100.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579950000000,
            "value": {
              "double_value": 110.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579953600000,
            "value": {
              "double_value": 130.0
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "distance_traveled_m": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579950000000,
          "distance_traveled_m": 10.0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579953600000,
          "distance_traveled_m": 20.0
        }
      ]
    },
    {
      "label": "map stats for multiple object_ids and org_ids",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedgpsdistance": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "double_value": 100.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579950000000,
            "value": {
              "double_value": 105.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579953600000,
            "value": {
              "double_value": 115.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579957200000,
            "value": {
              "double_value": 130.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579960800000,
            "value": {
              "double_value": 150.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579964400000,
            "value": {
              "double_value": 175.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579968000000,
            "value": {
              "double_value": 205.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579971600000,
            "value": {
              "double_value": 240.0
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579975200000,
            "value": {
              "double_value": 280.0
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "distance_traveled_m": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579950000000,
          "distance_traveled_m": null
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579953600000,
          "distance_traveled_m": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579957200000,
          "distance_traveled_m": 30.0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579960800000,
          "distance_traveled_m": 45.0
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579964400000,
          "distance_traveled_m": 60.0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579968000000,
          "distance_traveled_m": 75.0
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579971600000,
          "distance_traveled_m": 90.0
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579975200000,
          "distance_traveled_m": 105.0
        }
      ]
    }
  ]
}

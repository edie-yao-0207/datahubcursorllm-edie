{
  "test_cases": [
    {
      "label": "map a single stat with no historical value",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedanticipationbrakeevents": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "int_value": 100
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "anticipation_brake_events": null
        }
      ]
    },
    {
      "label": "map stats for a single object_id and single org_id",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedanticipationbrakeevents": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "int_value": 100
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579950000000,
            "value": {
              "int_value": 110
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579953600000,
            "value": {
              "int_value": 130
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "anticipation_brake_events": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579950000000,
          "anticipation_brake_events": 10
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579953600000,
          "anticipation_brake_events": 20
        }
      ]
    },
    {
      "label": "map stats for multiple object_ids and org_ids",
      "parameters": {
        "start_date": " '2020-01-20' ",
        "end_date": " '2020-01-30' "
      },
      "input_data": {
        "kinesisstats.osdderivedanticipationbrakeevents": [
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579946400000,
            "value": {
              "int_value": 100
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579950000000,
            "value": {
              "int_value": 105
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579953600000,
            "value": {
              "int_value": 115
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579957200000,
            "value": {
              "int_value": 130
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579960800000,
            "value": {
              "int_value": 150
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579964400000,
            "value": {
              "int_value": 175
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 200,
            "time": 1579968000000,
            "value": {
              "int_value": 205
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 100,
            "object_id": 300,
            "time": 1579971600000,
            "value": {
              "int_value": 240
            }
          },
          {
            "date": "2020-01-25",
            "org_id": 400,
            "object_id": 500,
            "time": 1579975200000,
            "value": {
              "int_value": 280
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579946400000,
          "anticipation_brake_events": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579950000000,
          "anticipation_brake_events": null
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579953600000,
          "anticipation_brake_events": null
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579957200000,
          "anticipation_brake_events": 30
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579960800000,
          "anticipation_brake_events": 45
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579964400000,
          "anticipation_brake_events": 60
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 200,
          "time": 1579968000000,
          "anticipation_brake_events": 75
        },
        {
          "date": "2020-01-25",
          "org_id": 100,
          "object_id": 300,
          "time": 1579971600000,
          "anticipation_brake_events": 90
        },
        {
          "date": "2020-01-25",
          "org_id": 400,
          "object_id": 500,
          "time": 1579975200000,
          "anticipation_brake_events": 105
        }
      ]
    }
  ]
}

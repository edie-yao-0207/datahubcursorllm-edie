{
  "name": "api_logs_report.aggregated_api_logs_count",
  "owner": "DevEcosystem",
  "description": "Aggregates api calls per hour",
  "dependencies": [
    {
      "external": true,
      "dbname": "datastreams",
      "tablename": "api_logs",
      "type": "table"
    }
  ],
  "parameters": ["start_date", "end_date"],
  "sqlite_report_config": {
    "report_name": "api_logs_report",
    "staleness_monitors": [
      {
        "hours": 12,
        "urgency": "HIGH"
      }
    ]
  },
  "output": {
    "dbname": "api_logs_report",
    "tablename": "aggregated_api_logs_count",
    "type": "table",
    "partition": ["date"],
    "write_mode": "overwrite",
    "primary_key": [
      "date",
      "org_id",
      "interval_start",
      "path_template",
      "status_code",
      "http_method",
      "access_token_id",
      "access_token_name",
      "oauth_token_id",
      "oauth_token_app_uuid"
    ],
    "schema": [
      { "name": "date", "type": "date" },
      { "name": "org_id", "type": "long" },
      { "name": "interval_start", "type": "timestamp" },
      { "name": "path_template", "type": "string" },
      { "name": "status_code", "type": "long" },
      { "name": "http_method", "type": "string" },
      { "name": "access_token_id", "type": "string" },
      { "name": "access_token_name", "type": "string" },
      { "name": "oauth_token_id", "type": "string" },
      { "name": "oauth_token_app_uuid", "type": "string" },
      { "name": "count", "type": "long", "nullable": false }
    ]
  }
}

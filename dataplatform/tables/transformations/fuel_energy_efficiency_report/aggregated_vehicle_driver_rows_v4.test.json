{
  "test_cases": [
    {
      "label": "For a period before the cutover date, only draw from v3 data, ignore anything else. Custom fuel/energy costs preferred over dynamic and summed correctly. Canonical fuel types and emissions correctly used.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "engine_type": 2,
            "fuel_cost": 12,
            "fuel_emissions": 324,
            "energy_cost": 46,
            "energy_emissions": 4000,
            "aux_during_idle_ms": 0,
            "distance_traveled_m": 8000.0,
            "electric_distance_traveled_m": 500.0,
            "energy_consumed_kwh": 5.0,
            "energy_regen_kwh": 5.0,
            "fuel_consumed_ml": 4000,
            "idle_duration_ms": 0,
            "on_duration_ms": 3600000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_maintenance.historical_fuel_energy_report_delta_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "object_type": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 100,
            "fuel_consumed_ml_original": 100,
            "energy_consumed_kwh": 2,
            "energy_consumed_kwh_original": 2,
            "distance_traveled_m": 100,
            "distance_traveled_m_original": 100,
            "custom_fuel_cost": 12,
            "dynamic_fuel_cost": 8,
            "custom_energy_cost": 0,
            "dynamic_energy_cost": 0,
            "on_duration_ms": 60000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "electric_distance_traveled_m": 2000,
            "electric_distance_traveled_m_original": 2000,
            "energy_regen_kwh": 0,
            "energy_regen_kwh_original": 0,
            "distance_traveled_m_gps": 500,
            "distance_traveled_m_gps_original": 500,
            "distance_traveled_m_odo": 500,
            "distance_traveled_m_odo_original": 500
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "engine_type": 0,
            "configurable_fuel_id": 0,
            "created_at": "2023-08-01 12:30:45"
          },
          {
            "org_id": 1,
            "device_id": 1,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "created_at": "2023-08-01 15:30:45"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "interval_start": "2023-08-05 00:00:00",
          "fuel_consumed_ml": 100,
          "fuel_consumed_ml_original": 100,
          "energy_consumed_kwh": 2,
          "energy_consumed_kwh_original": 2,
          "distance_traveled_m": 100,
          "distance_traveled_m_original": 100,
          "fuel_cost": 12,
          "energy_cost": 0,
          "fuel_emissions": 232.9,
          "energy_emissions": 0,
          "fuel_cost_original": 12,
          "energy_cost_original": 0,
          "fuel_emissions_original": 232.9,
          "energy_emissions_original": 0,
          "on_duration_ms": 60000,
          "idle_duration_ms": 0,
          "aux_during_idle_ms": 0,
          "electric_distance_traveled_m": 2000,
          "electric_distance_traveled_m_original": 2000,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "distance_traveled_m_gps": 500,
          "distance_traveled_m_gps_original": 500,
          "distance_traveled_m_odo": 500,
          "distance_traveled_m_odo_original": 500,
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    },
    {
      "label": "For a period before the cutover date, only draw from v3 data, ignore anything else. Ensure that historical driver rows default to Gasoline as they do on the read-path for V3.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "engine_type": 2,
            "fuel_cost": 12,
            "fuel_emissions": 324,
            "energy_cost": 46,
            "energy_emissions": 4000,
            "aux_during_idle_ms": 0,
            "distance_traveled_m": 8000.0,
            "electric_distance_traveled_m": 500.0,
            "energy_consumed_kwh": 5.0,
            "energy_regen_kwh": 5.0,
            "fuel_consumed_ml": 4000,
            "idle_duration_ms": 0,
            "on_duration_ms": 3600000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_maintenance.historical_fuel_energy_report_delta_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 8943895,
            "object_type": 5,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 100,
            "fuel_consumed_ml_original": 100,
            "energy_consumed_kwh": 2,
            "energy_consumed_kwh_original": 2,
            "distance_traveled_m": 100,
            "distance_traveled_m_original": 100,
            "custom_fuel_cost": 12,
            "dynamic_fuel_cost": 8,
            "custom_energy_cost": 0,
            "dynamic_energy_cost": 0,
            "on_duration_ms": 60000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "electric_distance_traveled_m": 2000,
            "electric_distance_traveled_m_original": 2000,
            "energy_regen_kwh": 0,
            "energy_regen_kwh_original": 0,
            "distance_traveled_m_gps": 500,
            "distance_traveled_m_gps_original": 500,
            "distance_traveled_m_odo": 500,
            "distance_traveled_m_odo_original": 500
          }
        ],
        "fueldb_shards.fuel_types": []
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "object_id": 8943895,
          "object_type": 5,
          "engine_type": 0,
          "configurable_fuel_id": 0,
          "interval_start": "2023-08-05 00:00:00",
          "fuel_consumed_ml": 100,
          "fuel_consumed_ml_original": 100,
          "energy_consumed_kwh": 2,
          "energy_consumed_kwh_original": 2,
          "distance_traveled_m": 100,
          "distance_traveled_m_original": 100,
          "fuel_cost": 12,
          "energy_cost": 0,
          "fuel_emissions": 232.9,
          "energy_emissions": 0,
          "fuel_cost_original": 12,
          "energy_cost_original": 0,
          "fuel_emissions_original": 232.9,
          "energy_emissions_original": 0,
          "on_duration_ms": 60000,
          "idle_duration_ms": 0,
          "aux_during_idle_ms": 0,
          "electric_distance_traveled_m": 2000,
          "electric_distance_traveled_m_original": 2000,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "distance_traveled_m_gps": 500,
          "distance_traveled_m_gps_original": 500,
          "distance_traveled_m_odo": 500,
          "distance_traveled_m_odo_original": 500
        }
      ]
    },
    {
      "label": "For a period before the cutover date, only draw from v3 data, ignore anything else. Ensure BEV vehicle is correctly identified by historical logic.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "engine_type": 2,
            "fuel_cost": 12,
            "fuel_emissions": 324,
            "energy_cost": 46,
            "energy_emissions": 4000,
            "aux_during_idle_ms": 0,
            "distance_traveled_m": 8000.0,
            "electric_distance_traveled_m": 500.0,
            "energy_consumed_kwh": 5.0,
            "energy_regen_kwh": 5.0,
            "fuel_consumed_ml": 4000,
            "idle_duration_ms": 0,
            "on_duration_ms": 3600000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_maintenance.historical_fuel_energy_report_delta_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "object_type": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 100,
            "fuel_consumed_ml_original": 100,
            "energy_consumed_kwh": 2,
            "energy_consumed_kwh_original": 2,
            "distance_traveled_m": 100,
            "distance_traveled_m_original": 100,
            "custom_fuel_cost": 12,
            "dynamic_fuel_cost": 8,
            "custom_energy_cost": 0,
            "dynamic_energy_cost": 0,
            "on_duration_ms": 60000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "electric_distance_traveled_m": 2000,
            "electric_distance_traveled_m_original": 2000,
            "energy_regen_kwh": 0,
            "energy_regen_kwh_original": 0,
            "distance_traveled_m_gps": 500,
            "distance_traveled_m_gps_original": 500,
            "distance_traveled_m_odo": 500,
            "distance_traveled_m_odo_original": 500
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 3,
            "configurable_fuel_id": 4,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "engine_type": 3,
          "configurable_fuel_id": 4,
          "interval_start": "2023-08-05 00:00:00",
          "fuel_consumed_ml": 100,
          "fuel_consumed_ml_original": 100,
          "energy_consumed_kwh": 2,
          "energy_consumed_kwh_original": 2,
          "distance_traveled_m": 100,
          "distance_traveled_m_original": 100,
          "fuel_cost": 12,
          "energy_cost": 0,
          "fuel_emissions": 232.9,
          "energy_emissions": 0,
          "fuel_cost_original": 12,
          "energy_cost_original": 0,
          "fuel_emissions_original": 232.9,
          "energy_emissions_original": 0,
          "on_duration_ms": 60000,
          "idle_duration_ms": 0,
          "aux_during_idle_ms": 0,
          "electric_distance_traveled_m": 2000,
          "electric_distance_traveled_m_original": 2000,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "distance_traveled_m_gps": 500,
          "distance_traveled_m_gps_original": 500,
          "distance_traveled_m_odo": 500,
          "distance_traveled_m_odo_original": 500,
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    },
    {
      "label": "For a period after the cutover date, only draw from v4 data, ignore anything else.",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "engine_type": 2,
            "configurable_fuel_id": 1,
            "fuel_cost": 40,
            "fuel_emissions": 8000,
            "energy_cost": 20,
            "energy_emissions": 4000,
            "aux_during_idle_ms": 0,
            "distance_traveled_m": 8000.0,
            "electric_distance_traveled_m": 500.0,
            "energy_consumed_kwh": 5.0,
            "energy_regen_kwh": 5.0,
            "fuel_consumed_ml": 4000,
            "idle_duration_ms": 0,
            "on_duration_ms": 3600000,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ],
        "fuel_maintenance.historical_fuel_energy_report_delta_v3": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "object_id": 1,
            "object_type": 1,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00",
            "fuel_consumed_ml": 100,
            "fuel_consumed_ml_original": 100,
            "energy_consumed_kwh": 2,
            "energy_consumed_kwh_original": 2,
            "distance_traveled_m": 100,
            "distance_traveled_m_original": 100,
            "custom_fuel_cost": 12,
            "dynamic_fuel_cost": 8,
            "custom_energy_cost": 0,
            "dynamic_energy_cost": 0,
            "on_duration_ms": 60000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "electric_distance_traveled_m": 2000,
            "electric_distance_traveled_m_original": 2000,
            "energy_regen_kwh": 0,
            "energy_regen_kwh_original": 0,
            "distance_traveled_m_gps": 500,
            "distance_traveled_m_gps_original": 500,
            "distance_traveled_m_odo": 500,
            "distance_traveled_m_odo_original": 500
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "engine_type": 2,
          "configurable_fuel_id": 1,
          "fuel_cost": 40,
          "energy_cost": 20,
          "fuel_emissions": 8000,
          "energy_emissions": 4000,
          "fuel_cost_original": 40,
          "energy_cost_original": 20,
          "fuel_emissions_original": 8000,
          "energy_emissions_original": 4000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 8000.0,
          "distance_traveled_m_original": 8000.0,
          "electric_distance_traveled_m": 500.0,
          "electric_distance_traveled_m_original": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_consumed_kwh_original": 5.0,
          "energy_regen_kwh": 5.0,
          "energy_regen_kwh_original": 5.0,
          "fuel_consumed_ml": 4000,
          "fuel_consumed_ml_original": 4000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "engine_type": 2,
          "configurable_fuel_id": 1,
          "fuel_cost": 40,
          "energy_cost": 20,
          "fuel_emissions": 8000,
          "energy_emissions": 4000,
          "fuel_cost_original": 40,
          "energy_cost_original": 20,
          "fuel_emissions_original": 8000,
          "energy_emissions_original": 4000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 8000.0,
          "distance_traveled_m_original": 8000.0,
          "electric_distance_traveled_m": 500.0,
          "electric_distance_traveled_m_original": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_consumed_kwh_original": 5.0,
          "energy_regen_kwh": 5.0,
          "energy_regen_kwh_original": 5.0,
          "fuel_consumed_ml": 4000,
          "fuel_consumed_ml_original": 4000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    },
    {
      "label": "When the calculated MPGE of a vehicle is > 200, filter out the fuel used, energy used, distance, emissions and cost rows.",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "fuel_cost": 100,
            "fuel_emissions": 100,
            "energy_cost": 100,
            "energy_emissions": 100,
            "distance_traveled_m": 987654321,
            "electric_distance_traveled_m": 100,
            "energy_consumed_kwh": 100,
            "fuel_consumed_ml": 100,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 100,
          "energy_cost_original": 100,
          "fuel_emissions_original": 100,
          "energy_emissions_original": 100,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 100,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 100,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 100,
          "energy_cost_original": 100,
          "fuel_emissions_original": 100,
          "energy_emissions_original": 100,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 100,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 100,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    },
    {
      "label": "When the calculated MPG of a gaseous fuel vehicle is > 65, filter out the distance, gaseous fuel used, emissions and cost rows.",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "fuel_cost": 0,
            "fuel_emissions": 0,
            "energy_cost": 0,
            "energy_emissions": 0,
            "distance_traveled_m": 987654321,
            "electric_distance_traveled_m": 0,
            "energy_consumed_kwh": 0,
            "fuel_consumed_ml": 0,
            "gaseous_fuel_consumed_grams": 100,
            "gaseous_fuel_cost": 100,
            "gaseous_fuel_emissions": 100,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 100,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 100.0,
          "gaseous_fuel_emissions_original": 100.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 100,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 100.0,
          "gaseous_fuel_emissions_original": 100.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    },
    {
      "label": "When the calculated MPG of a gaseous fuel vehicle is > 65 based on the fuel consumed ml as gasoeus vehicle, filter out the distance, gaseous fuel used, emissions and cost rows.",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "fuel_cost": 0,
            "fuel_emissions": 0,
            "fuel_ml_cost_as_gaseous_type": 100,
            "fuel_ml_emissions_as_gaseous_type": 100,
            "energy_cost": 0,
            "energy_emissions": 0,
            "distance_traveled_m": 987654321,
            "electric_distance_traveled_m": 0,
            "energy_consumed_kwh": 0,
            "fuel_consumed_ml": 0,
            "fuel_consumed_ml_as_gaseous_type": 100,
            "gaseous_fuel_consumed_grams": 0,
            "gaseous_fuel_cost": 0,
            "gaseous_fuel_emissions": 0,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_ml_cost_as_gaseous_type": 0,
          "fuel_ml_emissions_as_gaseous_type": 0,
          "fuel_ml_cost_as_gaseous_type_original": 100,
          "fuel_ml_emissions_as_gaseous_type_original": 100,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_ml_cost_as_gaseous_type": 0,
          "fuel_ml_emissions_as_gaseous_type": 0,
          "fuel_ml_cost_as_gaseous_type_original": 100,
          "fuel_ml_emissions_as_gaseous_type_original": 100,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0
        }
      ]
    },
    {
      "label": "When a row has MPG < 65 and contains fuel consumed ml while gaseous vehicle, it should be transformed into a driver and vehicle row and the values passed through",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "fuel_cost": 0,
            "fuel_emissions": 0,
            "fuel_ml_cost_as_gaseous_type": 100,
            "fuel_ml_emissions_as_gaseous_type": 100,
            "energy_cost": 0,
            "energy_emissions": 0,
            "distance_traveled_m": 100,
            "electric_distance_traveled_m": 0,
            "energy_consumed_kwh": 0,
            "fuel_consumed_ml": 0,
            "fuel_consumed_ml_as_gaseous_type": 100,
            "gaseous_fuel_consumed_grams": 0,
            "gaseous_fuel_cost": 0,
            "gaseous_fuel_emissions": 0,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_ml_cost_as_gaseous_type": 100.0,
          "fuel_ml_emissions_as_gaseous_type": 100.0,
          "fuel_ml_cost_as_gaseous_type_original": 100,
          "fuel_ml_emissions_as_gaseous_type_original": 100,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 100.0,
          "distance_traveled_m_original": 100.0,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "fuel_consumed_ml_as_gaseous_type": 100,
          "fuel_consumed_ml_as_gaseous_type_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_ml_cost_as_gaseous_type": 100.0,
          "fuel_ml_emissions_as_gaseous_type": 100.0,
          "fuel_ml_cost_as_gaseous_type_original": 100,
          "fuel_ml_emissions_as_gaseous_type_original": 100,
          "fuel_cost_original": 0.0,
          "energy_cost_original": 0.0,
          "fuel_emissions_original": 0.0,
          "energy_emissions_original": 0.0,
          "distance_traveled_m": 100.0,
          "distance_traveled_m_original": 100.0,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 0.0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0.0,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "fuel_consumed_ml_as_gaseous_type": 100,
          "fuel_consumed_ml_as_gaseous_type_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 0.0,
          "gaseous_fuel_emissions_original": 0.0
        }
      ]
    },
    {
      "label": "When no fuel/energy is reported, filter out the fuel used, energy used, emissions, distance, and cost rows.",
      "parameters": {
        "start_date": " '2024-04-01' ",
        "end_date": " '2024-04-02' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.combined_new_rows_v4": [
          {
            "date": "2024-04-01",
            "org_id": 1,
            "driver_id": 1,
            "object_id": 1,
            "fuel_cost": 100,
            "fuel_emissions": 100,
            "energy_cost": 100,
            "energy_emissions": 100,
            "gaseous_fuel_consumed_grams": 0,
            "gaseous_fuel_cost": 100,
            "gaseous_fuel_emissions": 100,
            "distance_traveled_m": 987654321,
            "electric_distance_traveled_m": 100,
            "energy_consumed_kwh": 0,
            "fuel_consumed_ml": 0,
            "interval_start": "2024-04-01 00:00:00",
            "interval_end": "2024-04-01 01:00:00"
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 1,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 100,
          "energy_cost_original": 100,
          "fuel_emissions_original": 100,
          "energy_emissions_original": 100,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 100.0,
          "gaseous_fuel_emissions_original": 100.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        },
        {
          "date": "2024-04-01",
          "org_id": 1,
          "object_id": 1,
          "object_type": 5,
          "fuel_cost": 0,
          "energy_cost": 0,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "fuel_cost_original": 100,
          "energy_cost_original": 100,
          "fuel_emissions_original": 100,
          "energy_emissions_original": 100,
          "energy_regen_kwh": 0,
          "energy_regen_kwh_original": 0,
          "energy_consumed_kwh": 0,
          "energy_consumed_kwh_original": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_original": 0,
          "distance_traveled_m": 0,
          "distance_traveled_m_original": 987654321,
          "electric_distance_traveled_m": 0,
          "electric_distance_traveled_m_original": 100,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-04-01 00:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_consumed_grams_original": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "gaseous_fuel_cost_original": 100.0,
          "gaseous_fuel_emissions_original": 100.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_consumed_ml_as_gaseous_type_original": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_ml_cost_as_gaseous_type_original": 0.0,
          "fuel_ml_emissions_as_gaseous_type_original": 0.0
        }
      ]
    }
  ]
}

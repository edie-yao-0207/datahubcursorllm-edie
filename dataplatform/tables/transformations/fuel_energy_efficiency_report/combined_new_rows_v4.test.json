{
  "test_cases": [
    {
      "label": "Energy cost/emission factor is applied and multiplied with energy consumed",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 10
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 100,
            "emissions_grams_per_wh": 200,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 1000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 0,
          "energy_cost": 1000,
          "fuel_emissions": 0,
          "energy_emissions": 2000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 10,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Fuel cost/emission factor is applied and multiplied with fuel consumed. Note the ml to conversion is applied. (3785ml ~ 1 gallon)",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 3785
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 200,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 1,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 99.989102,
          "energy_cost": 0,
          "fuel_emissions": 199.978204,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 3785,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Fuel cost/emission factor is applied and multiplied with gaseous fuel consumed. Note that the factors are per kg.",
      "parameters": {
        "start_date": " '2024-10-05' ",
        "end_date": " '2024-10-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2024-10-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2024-10-05 00:00:00",
            "interval_end": "2024-10-05 01:00:00",
            "fuel_consumed_ml": 0,
            "gaseous_fuel_consumed_grams": 1000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2024-10-05",
            "org_id": 1,
            "configurable_fuel_id": 8,
            "cost_per_kg": 100,
            "emissions_grams_per_kg": 200,
            "interval_start": "2024-10-05 00:00:00",
            "interval_end": "2024-10-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 8,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 1,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2024-10-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-10-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 8,
          "fuel_cost": null,
          "energy_cost": 0,
          "fuel_emissions": null,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-10-05 00:00:00",
          "interval_end": "2024-10-05 01:00:00",
          "gaseous_fuel_consumed_grams": 1000,
          "gaseous_fuel_cost": 100.0,
          "gaseous_fuel_emissions": 200.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When the row is an applicable gaseous fuel type, then fuel consumed ml value should be moved to the fuel_consumed_ml_as_gaseous column and costs/emissions calculated as before.",
      "parameters": {
        "start_date": " '2024-10-05' ",
        "end_date": " '2024-10-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2024-10-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2024-10-05 00:00:00",
            "interval_end": "2024-10-05 01:00:00",
            "fuel_consumed_ml": 1000,
            "gaseous_fuel_consumed_grams": 0
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2024-10-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 200,
            "interval_start": "2024-10-05 00:00:00",
            "interval_end": "2024-10-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 8,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 1,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2024-10-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-10-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 8,
          "fuel_cost": 0.0,
          "energy_cost": 0,
          "fuel_emissions": 0.0,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-10-05 00:00:00",
          "interval_end": "2024-10-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 1000,
          "fuel_ml_cost_as_gaseous_type": 26.4172,
          "fuel_ml_emissions_as_gaseous_type": 52.8344
        }
      ]
    },
    {
      "label": "When the row is an applicable gaseous fuel type but it is before the gaseous fuel ml move over date, then fuel consumed ml values should not be moved.",
      "parameters": {
        "start_date": " '2024-09-05' ",
        "end_date": " '2024-09-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2024-09-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2024-09-05 00:00:00",
            "interval_end": "2024-09-05 01:00:00",
            "fuel_consumed_ml": 1000,
            "gaseous_fuel_consumed_grams": 0
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2024-09-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 200,
            "interval_start": "2024-09-05 00:00:00",
            "interval_end": "2024-09-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 8,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 1,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2024-09-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-09-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 8,
          "fuel_cost": 26.4172,
          "energy_cost": 0,
          "fuel_emissions": 52.8344,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 1000,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2024-09-05 00:00:00",
          "interval_end": "2024-09-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0
        }
      ]
    },
    {
      "label": "When the row is not an applicable gaseous fuel type, then any gaseous fuel consumed grams value should be zeroed out.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 1000,
            "gaseous_fuel_consumed_grams": 1000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 200,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 1,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 1,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 26.4172,
          "energy_cost": 0,
          "fuel_emissions": 52.8344,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 1000,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When device has no canonical fuel type record, energy costs default to the fixed factor AND energy emissions are 0.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 10
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 1000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 6,
          "configurable_fuel_id": 99,
          "fuel_cost": 0,
          "energy_cost": 1.5,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 10,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When there is no energy fuel id factor for an org, energy costs default to the fixed factor AND energy emissions are 0.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 10
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 1000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 0,
          "energy_cost": 1.5,
          "fuel_emissions": 0,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 10,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When device has no canonical fuel type record, fuel costs and emissions default to the unknown configurable fuel id cost factor when it exists.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 3785
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 100,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 6,
          "configurable_fuel_id": 99,
          "fuel_cost": 99.989102,
          "energy_cost": 0,
          "fuel_emissions": 99.989102,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 3785,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When there is no fuel id factor for the device, fuel costs and emissions default to the gasoline configurable fuel id cost factor when it exists.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "fuel_consumed_ml": 3785
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 100,
            "emissions_grams_per_us_gal": 100,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 1,
            "gasoline_type": 0,
            "diesel_type": 1,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 99.989102,
          "energy_cost": 0,
          "fuel_emissions": 99.989102,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 3785,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for a single BEV vehicle. Sets electric distance traveled to distance traveled - See EVEC-1505 for more details.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 2000
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 3.75,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 2000.0,
          "electric_distance_traveled_m": 2000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for a single Hydrogen-FCEV vehicle. Sets electric distance traveled to distance traveled. Additionally energy regen is not subtracted from energy consumed.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 2000
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 4,
            "configurable_fuel_id": 12,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 4,
          "configurable_fuel_id": 12,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 7.5,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 2000.0,
          "electric_distance_traveled_m": 2000.0,
          "energy_consumed_kwh": 50.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for a single Hybrid vehicle. Leaves electric distance traveled as it is - See EVEC-1505 for more details.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 2000
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 3,
            "configurable_fuel_id": 0,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 3,
          "configurable_fuel_id": 0,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 3.75,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 2000.0,
          "electric_distance_traveled_m": 1000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for a single unknown vehicle (no engine type info). Leaves electric distance traveled as it is - See EVEC-1505 and EVEC-4603 for more details.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 2000
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 6,
          "configurable_fuel_id": 99,
          "energy_cost": 3.75,
          "energy_emissions": 0,
          "fuel_cost": 5.283440000000001,
          "fuel_emissions": 317.00640000000004,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 2000.0,
          "electric_distance_traveled_m": 1000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for a single vehicle from a single org, where the vehicle consumed energy, fuel, performed regen and drove some distance and some distance on electric.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 1000
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 3.5,
            "emissions_grams_per_us_gal": 2000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 10,
            "emissions_grams_per_wh": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 2,
            "configurable_fuel_id": 1,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 2,
          "configurable_fuel_id": 1,
          "fuel_cost": 1.849204,
          "energy_cost": 250,
          "fuel_emissions": 1056.688,
          "energy_emissions": 15000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 1000.0,
          "electric_distance_traveled_m": 1000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 2,
          "configurable_fuel_id": 1,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 01:00:00",
          "interval_end": "2023-08-05 02:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 2,
          "configurable_fuel_id": 1,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 02:00:00",
          "interval_end": "2023-08-05 03:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for multiple vehicles from a single org, where the vehicles consumed energy, fuel, performed regen and drove some distance and some distance on electric.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 500
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 4000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "energy_consumed_kwh": 45
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "energy_consumed_kwh": 5
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "energy_consumed_kwh": 10
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 1000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "distance_traveled_m": 3000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "distance_traveled_m": 5000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "distance_traveled_m": 8000
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "electric_distance_traveled_m_odo": 3000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "electric_distance_traveled_m_odo": 500
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "electric_distance_traveled_m_odo": 500
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "energy_regen_kwh": 0
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "energy_regen_kwh": 0
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "energy_regen_kwh": 5
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 3.5,
            "emissions_grams_per_us_gal": 2000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 10,
            "emissions_grams_per_wh": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 4,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          },
          {
            "org_id": 1,
            "device_id": 2,
            "uuid": 832489,
            "engine_type": 2,
            "configurable_fuel_id": 0,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 1.849204,
          "energy_cost": 250,
          "fuel_emissions": 1056.688,
          "energy_emissions": 15000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 1000.0,
          "electric_distance_traveled_m": 1000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 01:00:00",
          "interval_end": "2023-08-05 02:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 4,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 02:00:00",
          "interval_end": "2023-08-05 03:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 2,
          "configurable_fuel_id": 0,
          "fuel_cost": 0.6604300000000001,
          "energy_cost": 360,
          "fuel_emissions": 330.21500000000003,
          "energy_emissions": 18000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 3000.0,
          "electric_distance_traveled_m": 3000.0,
          "energy_consumed_kwh": 45.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 500,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 11:00:00",
          "interval_end": "2023-08-05 12:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 2,
          "configurable_fuel_id": 0,
          "fuel_cost": 2.6417200000000003,
          "energy_cost": 40,
          "fuel_emissions": 1320.8600000000001,
          "energy_emissions": 2000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 5000.0,
          "electric_distance_traveled_m": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 12:00:00",
          "interval_end": "2023-08-05 13:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 2,
          "configurable_fuel_id": 0,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 40,
          "fuel_emissions": 2641.7200000000003,
          "energy_emissions": 2000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 8000.0,
          "electric_distance_traveled_m": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_regen_kwh": 5.0,
          "fuel_consumed_ml": 4000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 13:00:00",
          "interval_end": "2023-08-05 14:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "Combine rows for multiple vehicles from multiple orgs, where the vehicles consumed energy, fuel, performed regen and drove some distance and some distance on electric.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 500
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 2000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "on_duration_ms": 3600000,
            "idle_duration_ms": 0,
            "aux_during_idle_ms": 0,
            "fuel_consumed_ml": 4000
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_consumed_kwh": 50
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "energy_consumed_kwh": 45
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "energy_consumed_kwh": 5
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "energy_consumed_kwh": 10
          }
        ],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "distance_traveled_m": 1000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "distance_traveled_m": 3000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "distance_traveled_m": 5000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "distance_traveled_m": 8000
          }
        ],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "electric_distance_traveled_m_odo": 1000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "electric_distance_traveled_m_odo": 3000
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "electric_distance_traveled_m_odo": 500
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "electric_distance_traveled_m_odo": 500
          }
        ],
        "fuel_energy_efficiency_report.regen_by_hour": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "driver_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00",
            "energy_regen_kwh": 25
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00",
            "energy_regen_kwh": 0
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00",
            "energy_regen_kwh": 0
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "object_id": 2,
            "driver_id": 2,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00",
            "energy_regen_kwh": 5
          }
        ],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 3.5,
            "emissions_grams_per_us_gal": 2000,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 10,
            "emissions_grams_per_wh": 600,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 01:00:00",
            "interval_end": "2023-08-05 02:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 1,
            "configurable_fuel_id": 0,
            "cost_per_us_gal": 10,
            "emissions_grams_per_us_gal": 600,
            "interval_start": "2023-08-05 02:00:00",
            "interval_end": "2023-08-05 03:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 11:00:00",
            "interval_end": "2023-08-05 12:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 12:00:00",
            "interval_end": "2023-08-05 13:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 1,
            "cost_per_us_gal": 5,
            "emissions_grams_per_us_gal": 2500,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00"
          },
          {
            "date": "2023-08-05",
            "org_id": 2,
            "configurable_fuel_id": 4,
            "cost_per_kwh": 8,
            "emissions_grams_per_wh": 400,
            "interval_start": "2023-08-05 13:00:00",
            "interval_end": "2023-08-05 14:00:00"
          }
        ],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 1,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          },
          {
            "org_id": 2,
            "device_id": 2,
            "uuid": 832489,
            "engine_type": 0,
            "configurable_fuel_id": 1,
            "gasoline_type": 8,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-01 15:30:45"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 1.849204,
          "energy_cost": 250,
          "fuel_emissions": 1056.688,
          "energy_emissions": 15000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 1000.0,
          "electric_distance_traveled_m": 1000.0,
          "energy_consumed_kwh": 25.0,
          "energy_regen_kwh": 25.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 01:00:00",
          "interval_end": "2023-08-05 02:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 1,
          "object_id": 1,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 0,
          "fuel_emissions": 317.00640000000004,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0.0,
          "electric_distance_traveled_m": 0.0,
          "energy_consumed_kwh": 0.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 02:00:00",
          "interval_end": "2023-08-05 03:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 2,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 0.6604300000000001,
          "energy_cost": 360,
          "fuel_emissions": 330.21500000000003,
          "energy_emissions": 18000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 3000.0,
          "electric_distance_traveled_m": 3000.0,
          "energy_consumed_kwh": 45.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 500,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 11:00:00",
          "interval_end": "2023-08-05 12:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 2,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 2.6417200000000003,
          "energy_cost": 40,
          "fuel_emissions": 1320.8600000000001,
          "energy_emissions": 2000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 5000.0,
          "electric_distance_traveled_m": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_regen_kwh": 0.0,
          "fuel_consumed_ml": 2000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 12:00:00",
          "interval_end": "2023-08-05 13:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        },
        {
          "date": "2023-08-05",
          "org_id": 2,
          "driver_id": 2,
          "object_id": 2,
          "engine_type": 0,
          "configurable_fuel_id": 1,
          "fuel_cost": 5.283440000000001,
          "energy_cost": 40,
          "fuel_emissions": 2641.7200000000003,
          "energy_emissions": 2000000,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 8000.0,
          "electric_distance_traveled_m": 500.0,
          "energy_consumed_kwh": 5.0,
          "energy_regen_kwh": 5.0,
          "fuel_consumed_ml": 4000,
          "idle_duration_ms": 0,
          "on_duration_ms": 3600000,
          "interval_start": "2023-08-05 13:00:00",
          "interval_end": "2023-08-05 14:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0,
          "fuel_ml_cost_as_gaseous_type": 0.0,
          "fuel_ml_emissions_as_gaseous_type": 0.0,
          "fuel_consumed_ml_as_gaseous_type": 0
        }
      ]
    },
    {
      "label": "When the fuel type changes in the final hour of the day before the execution window and then in the first hour of the first day in the execution window, then the query succeeds with no errors.",
      "parameters": {
        "start_date": " '2023-08-05' ",
        "end_date": " '2023-08-06' "
      },
      "input_data": {
        "fuel_energy_efficiency_report.engine_state_fuel_by_hour_v3": [
          {
            "date": "2023-08-05",
            "org_id": 1,
            "object_id": 1,
            "interval_start": "2023-08-05 00:00:00",
            "interval_end": "2023-08-05 01:00:00"
          }
        ],
        "fuel_energy_efficiency_report.energy_consumption_by_hour": [],
        "fuel_energy_efficiency_report.distance_by_hour_v3": [],
        "fuel_energy_efficiency_report.regen_by_hour": [],
        "fuel_energy_efficiency_report.electric_distance_by_hour": [],
        "fuel_energy_efficiency_report.org_fuel_energy_cost_and_emissions_hour_intervals": [],
        "fueldb_shards.fuel_types": [
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 1,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-04 23:30:00"
          },
          {
            "org_id": 1,
            "device_id": 1,
            "uuid": 832489,
            "engine_type": 1,
            "configurable_fuel_id": 1,
            "gasoline_type": 0,
            "diesel_type": 0,
            "gaseous_type": 0,
            "hydrogen_type": 0,
            "battery_charge_type": 0,
            "source": 0,
            "created_at": "2023-08-05 00:30:00"
          }
        ],
        "helpers.unit_conversion": [
          {
            "gallon_per_ml": 0.000264172,
            "cost_per_kwh": 0.15
          }
        ]
      },
      "expected_data": [
        {
          "date": "2023-08-05",
          "org_id": 1,
          "driver_id": 0,
          "object_id": 1,
          "engine_type": 1,
          "configurable_fuel_id": 1,
          "energy_cost": 0,
          "energy_emissions": 0,
          "aux_during_idle_ms": 0,
          "distance_traveled_m": 0,
          "electric_distance_traveled_m": 0,
          "energy_consumed_kwh": 0,
          "energy_regen_kwh": 0,
          "fuel_consumed_ml": 0,
          "fuel_consumed_ml_as_gaseous_type": 0,
          "idle_duration_ms": 0,
          "on_duration_ms": 0,
          "interval_start": "2023-08-05 00:00:00",
          "interval_end": "2023-08-05 01:00:00",
          "gaseous_fuel_consumed_grams": 0,
          "gaseous_fuel_cost": 0.0,
          "gaseous_fuel_emissions": 0.0
        }
      ]
    }
  ]
}

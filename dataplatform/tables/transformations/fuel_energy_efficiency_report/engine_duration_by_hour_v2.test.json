{
  "test_cases": [
    {
      "label": "Map intervals to durations without matching driver assignments",
      "parameters": {
        "start_date": " '2022-01-25' ",
        "end_date": " '2022-01-26' "
      },
      "input_data": {
        "engine_state.intervals_by_hour": [
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643131800000,
            "end_ms": 1643133600000,
            "state": "ON"
          },
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643133600000,
            "end_ms": 1643135400000,
            "state": "OFF"
          },
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643135400000,
            "end_ms": 1643137200000,
            "state": "IDLE"
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": []
      },
      "expected_data": [
        {
          "date": "2022-01-25",
          "org_id": 100,
          "object_id": 200,
          "driver_id": 0,
          "interval_start": "2022-01-25 17:00:00",
          "interval_end": "2022-01-25 18:00:00",
          "on_duration_ms": 1800000,
          "idle_duration_ms": 0
        },
        {
          "date": "2022-01-25",
          "org_id": 100,
          "object_id": 200,
          "driver_id": 0,
          "interval_start": "2022-01-25 18:00:00",
          "interval_end": "2022-01-25 19:00:00",
          "on_duration_ms": 1800000,
          "idle_duration_ms": 1800000
        }
      ]
    },
    {
      "label": "Map intervals to durations with matching driver assignments",
      "parameters": {
        "start_date": " '2022-01-25' ",
        "end_date": " '2022-01-26' "
      },
      "input_data": {
        "engine_state.intervals_by_hour": [
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643131800000,
            "end_ms": 1643133600000,
            "state": "ON"
          },
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643133600000,
            "end_ms": 1643135400000,
            "state": "OFF"
          },
          {
            "date": "2022-01-25",
            "org_id": 100,
            "object_id": 200,
            "start_ms": 1643135400000,
            "end_ms": 1643137200000,
            "state": "IDLE"
          }
        ],
        "fuel_energy_efficiency_report.driver_assignments": [
          {
            "date": "2022-01-25",
            "org_id": 100,
            "device_id": 200,
            "driver_id": 300,
            "start_time": 1643131800000,
            "end_time": 1643133600000
          },
          {
            "date": "2022-01-25",
            "org_id": 100,
            "device_id": 200,
            "driver_id": 300,
            "start_time": 1643133600000,
            "end_time": 1643137200000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2022-01-25",
          "org_id": 100,
          "object_id": 200,
          "driver_id": 300,
          "interval_start": "2022-01-25 17:00:00",
          "interval_end": "2022-01-25 18:00:00",
          "on_duration_ms": 1800000,
          "idle_duration_ms": 0
        },
        {
          "date": "2022-01-25",
          "org_id": 100,
          "object_id": 200,
          "driver_id": 300,
          "interval_start": "2022-01-25 18:00:00",
          "interval_end": "2022-01-25 19:00:00",
          "on_duration_ms": 1800000,
          "idle_duration_ms": 1800000
        }
      ]
    }
  ]
}

{
  "test_cases": [
    {
      "label": "negative fuel consumption intervals are not persisted",
      "parameters": {
        "start_date": "'2022-07-28'",
        "end_date": "'2022-07-29'"
      },
      "input_data": {
        "kinesisstats.osdderivedfuelconsumed": [
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1010,
            "value": {
              "int_value": -10
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1020,
            "value": {
              "int_value": -20
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1030,
            "value": {
              "int_value": -40
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1040,
            "value": {
              "int_value": -60
            }
          }
        ]
      },
      "expected_data": []
    },
    {
      "label": "postive fuel consumption intervals are persisted",
      "parameters": {
        "start_date": "'2022-07-28'",
        "end_date": "'2022-07-29'"
      },
      "input_data": {
        "kinesisstats.osdderivedfuelconsumed": [
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1010,
            "value": {
              "int_value": 10
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1020,
            "value": {
              "int_value": 20
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1030,
            "value": {
              "int_value": 40
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 1040,
            "value": {
              "int_value": 60
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2022-07-28",
          "org_id": 100,
          "object_id": 100,
          "start_ms": 1010,
          "end_ms": 1020,
          "fuel_consumed_ml": 10,
          "original_interval_duration_ms": 10
        },
        {
          "date": "2022-07-28",
          "org_id": 100,
          "object_id": 100,
          "start_ms": 1020,
          "end_ms": 1030,
          "fuel_consumed_ml": 20,
          "original_interval_duration_ms": 10
        },
        {
          "date": "2022-07-28",
          "org_id": 100,
          "object_id": 100,
          "start_ms": 1030,
          "end_ms": 1040,
          "fuel_consumed_ml": 20,
          "original_interval_duration_ms": 10
        }
      ]
    },
    {
      "label": "When intervals span multiple days, then intervals are capped to at most a day in length.",
      "parameters": {
        "start_date": "'2022-07-27'",
        "end_date": "'2022-07-29'"
      },
      "input_data": {
        "kinesisstats.osdderivedfuelconsumed": [
          {
            "date": "2022-07-27",
            "org_id": 100,
            "object_id": 100,
            "time": 1000,
            "value": {
              "int_value": 10
            }
          },
          {
            "date": "2022-07-28",
            "org_id": 100,
            "object_id": 100,
            "time": 176800000,
            "value": {
              "int_value": 10
            }
          }
        ]
      },
      "expected_data": [
        {
          "date": "2022-07-28",
          "end_ms": 176800000,
          "fuel_consumed_ml": 0,
          "object_id": 100,
          "org_id": 100,
          "original_interval_duration_ms": 176799000,
          "start_ms": 90400000
        }
      ]
    }
  ]
}

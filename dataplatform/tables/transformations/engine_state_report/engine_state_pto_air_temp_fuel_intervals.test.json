{
  "test_cases": [
    {
      "label": "when temperature values consists of known and unknown values, then determine an average of the first 5 temperature values in the interval.",
      "parameters": {
        "start_date": " '2024-10-20' ",
        "end_date": " '2024-10-24' "
      },
      "input_data": {
        "kinesisstats.osdenginegauge": [
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151380012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 15000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151382012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": -25000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151383012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": null
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151384012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 55000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 2,
            "object_id": 202,
            "time": 1713151390012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 22000
                }
              }
            },
            "date": "2024-10-21"
          },
          {
            "org_id": 2,
            "object_id": 202,
            "time": 1713151391012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 24000
                }
              }
            },
            "date": "2024-10-21"
          },
          {
            "org_id": 2,
            "object_id": 202,
            "time": 1713151392012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 26000
                }
              }
            },
            "date": "2024-10-21"
          },
          {
            "org_id": 3,
            "object_id": 303,
            "time": 1713151400012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 51000
                }
              }
            },
            "date": "2024-10-22"
          },
          {
            "org_id": 3,
            "object_id": 303,
            "time": 1713151405012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 1000
                }
              }
            },
            "date": "2024-10-22"
          },
          {
            "org_id": 4,
            "object_id": 404,
            "time": 1713151410012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": -30000
                }
              }
            },
            "date": "2024-10-23"
          },
          {
            "org_id": 4,
            "object_id": 404,
            "time": 1713151411012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": -60000
                }
              }
            },
            "date": "2024-10-23"
          },
          {
            "org_id": 4,
            "object_id": 404,
            "time": 1713151412012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": -45000
                }
              }
            },
            "date": "2024-10-23"
          },
          {
            "org_id": 5,
            "object_id": 505,
            "time": 1713151413012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": null
                }
              }
            },
            "date": "2024-10-23"
          }
        ],
        "engine_state_report.engine_state_pto_fuel_intervals": [
          {
            "date": "2024-10-20",
            "org_id": 1,
            "object_id": 101,
            "start_ms": 1713151380000,
            "end_ms": 1713151385000,
            "engine_state": "ON",
            "productive_pto_state": 1,
            "fuel_consumed_ml": 100,
            "gaseous_fuel_consumed_grams": 200,
            "original_engine_state_interval_duration_ms": 2500,
            "original_fuel_interval_duration_ms": 2500,
            "original_gaseous_consumption_interval_duration_ms": 2500
          },
          {
            "date": "2024-10-21",
            "org_id": 2,
            "object_id": 202,
            "start_ms": 1713151390000,
            "end_ms": 1713151393000,
            "engine_state": "IDLE",
            "productive_pto_state": 0,
            "fuel_consumed_ml": 50,
            "gaseous_fuel_consumed_grams": 100,
            "original_engine_state_interval_duration_ms": 1000,
            "original_fuel_interval_duration_ms": 2000,
            "original_gaseous_consumption_interval_duration_ms": 2500
          },
          {
            "date": "2024-10-22",
            "org_id": 3,
            "object_id": 303,
            "start_ms": 1713151400000,
            "end_ms": 1713151406000,
            "engine_state": "IDLE",
            "productive_pto_state": 0,
            "fuel_consumed_ml": 0,
            "gaseous_fuel_consumed_grams": 0,
            "original_fuel_interval_duration_ms": 120000,
            "original_engine_state_interval_duration_ms": 120000,
            "original_gaseous_fuel_interval_duration_ms": 120000
          },
          {
            "date": "2024-10-23",
            "org_id": 4,
            "object_id": 404,
            "start_ms": 1713151410000,
            "end_ms": 1713151413000,
            "engine_state": "ON",
            "productive_pto_state": 1,
            "fuel_consumed_ml": 100,
            "gaseous_fuel_consumed_grams": 200,
            "original_engine_state_interval_duration_ms": 2000,
            "original_fuel_interval_duration_ms": 2000,
            "original_gaseous_consumption_interval_duration_ms": 2000
          },
          {
            "date": "2024-10-23",
            "org_id": 4,
            "object_id": 404,
            "start_ms": 1713151410000,
            "end_ms": 1713151413000,
            "engine_state": "ON",
            "productive_pto_state": 1,
            "fuel_consumed_ml": 100,
            "gaseous_fuel_consumed_grams": 200,
            "original_engine_state_interval_duration_ms": 2000,
            "original_fuel_interval_duration_ms": 2000,
            "original_gaseous_consumption_interval_duration_ms": 2000
          },
          {
            "date": "2024-10-23",
            "org_id": 5,
            "object_id": 505,
            "start_ms": 1713151413000,
            "end_ms": 1713151413012,
            "engine_state": "ON",
            "productive_pto_state": 1,
            "fuel_consumed_ml": 100,
            "gaseous_fuel_consumed_grams": 200,
            "original_engine_state_interval_duration_ms": 2000,
            "original_fuel_interval_duration_ms": 2000,
            "original_gaseous_consumption_interval_duration_ms": 2000
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-10-20",
          "org_id": 1,
          "object_id": 101,
          "engine_state": "ON",
          "productive_pto_state": 1,
          "fuel_consumed_ml": 100,
          "gaseous_fuel_consumed_grams": 200,
          "start_ms": 1713151380000,
          "end_ms": 1713151385000,
          "avg_air_temp_c": 15,
          "original_engine_state_interval_duration_ms": 2500,
          "original_fuel_interval_duration_ms": 2500,
          "original_gaseous_consumption_interval_duration_ms": 2500
        },
        {
          "date": "2024-10-21",
          "org_id": 2,
          "object_id": 202,
          "engine_state": "IDLE",
          "productive_pto_state": 0,
          "fuel_consumed_ml": 50,
          "gaseous_fuel_consumed_grams": 100,
          "start_ms": 1713151390000,
          "end_ms": 1713151393000,
          "avg_air_temp_c": 24,
          "original_engine_state_interval_duration_ms": 1000,
          "original_fuel_interval_duration_ms": 2000,
          "original_gaseous_consumption_interval_duration_ms": 2500
        },
        {
          "date": "2024-10-22",
          "org_id": 3,
          "object_id": 303,
          "engine_state": "IDLE",
          "productive_pto_state": 0,
          "fuel_consumed_ml": 0,
          "gaseous_fuel_consumed_grams": 0,
          "start_ms": 1713151400000,
          "end_ms": 1713151406000,
          "avg_air_temp_c": 26,
          "original_fuel_interval_duration_ms": 120000,
          "original_engine_state_interval_duration_ms": 120000,
          "original_gaseous_fuel_interval_duration_ms": 120000
        },
        {
          "date": "2024-10-23",
          "org_id": 4,
          "object_id": 404,
          "engine_state": "ON",
          "productive_pto_state": 1,
          "fuel_consumed_ml": 100,
          "gaseous_fuel_consumed_grams": 200,
          "start_ms": 1713151410000,
          "end_ms": 1713151413000,
          "avg_air_temp_c": 9999,
          "original_engine_state_interval_duration_ms": 2000,
          "original_fuel_interval_duration_ms": 2000,
          "original_gaseous_consumption_interval_duration_ms": 2000
        },
        {
          "date": "2024-10-23",
          "org_id": 5,
          "object_id": 505,
          "start_ms": 1713151413000,
          "end_ms": 1713151413012,
          "engine_state": "ON",
          "productive_pto_state": 1,
          "fuel_consumed_ml": 100,
          "gaseous_fuel_consumed_grams": 200,
          "avg_air_temp_c": 9999,
          "original_engine_state_interval_duration_ms": 2000,
          "original_fuel_interval_duration_ms": 2000,
          "original_gaseous_consumption_interval_duration_ms": 2000
        }
      ]
    },
    {
      "label": "when there multiple temperatures in an interval, average of first 5 temperature is used for the interval.",
      "parameters": {
        "start_date": " '2024-10-20' ",
        "end_date": " '2024-10-24' "
      },
      "input_data": {
        "kinesisstats.osdenginegauge": [
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151380012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 15000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151382012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 20000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151383012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 30000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151384012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 45000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151385012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 40000
                }
              }
            },
            "date": "2024-10-20"
          },
          {
            "org_id": 1,
            "object_id": 101,
            "time": 1713151386012,
            "value": {
              "is_databreak": false,
              "is_end": false,
              "proto_value": {
                "engine_gauge_event": {
                  "air_temp_milli_c": 50000
                }
              }
            },
            "date": "2024-10-20"
          }
        ],
        "engine_state_report.engine_state_pto_fuel_intervals": [
          {
            "date": "2024-10-20",
            "org_id": 1,
            "object_id": 101,
            "start_ms": 1713151380000,
            "end_ms": 1713151387000,
            "engine_state": "ON",
            "productive_pto_state": 1,
            "fuel_consumed_ml": 100,
            "gaseous_fuel_consumed_grams": 200,
            "original_engine_state_interval_duration_ms": 2500,
            "original_fuel_interval_duration_ms": 2500,
            "original_gaseous_consumption_interval_duration_ms": 2500
          }
        ]
      },
      "expected_data": [
        {
          "date": "2024-10-20",
          "org_id": 1,
          "object_id": 101,
          "engine_state": "ON",
          "productive_pto_state": 1,
          "fuel_consumed_ml": 100,
          "gaseous_fuel_consumed_grams": 200,
          "start_ms": 1713151380000,
          "end_ms": 1713151387000,
          "avg_air_temp_c": 30,
          "original_engine_state_interval_duration_ms": 2500,
          "original_fuel_interval_duration_ms": 2500,
          "original_gaseous_consumption_interval_duration_ms": 2500
        }
      ]
    }
  ]
}

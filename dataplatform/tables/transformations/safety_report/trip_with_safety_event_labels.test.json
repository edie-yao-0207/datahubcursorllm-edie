{
  "test_cases": [
    {
      "label": "given duplicate labels in a trip, selects the earliest safety event label_type for a trip",
      "parameters": {
        "start_date": " '2022-01-04' ",
        "end_date": " '2022-01-07' "
      },
      "input_data": {
        "safety_report.safety_event_labels": [
          {
            "org_id": 123,
            "device_id": 1,
            "driver_id": 1,
            "trip_start_ms": 1641343592000,
            "trip_end_ms": 1641361592000,
            "trip_version": 101,
            "accel_type": 19,
            "event_ms": 1641344400000,
            "release_stage": 100,
            "date": "2022-01-05",
            "label_type": 10,
            "label_source": 1,
            "in_dismissed_states": 0,
            "in_recognition_states": 0,
            "in_coaching_states": 0,
            "in_triage_states": 1
          },
          {
            "org_id": 123,
            "device_id": 1,
            "driver_id": 1,
            "trip_start_ms": 1641343592000,
            "trip_end_ms": 1641361592000,
            "trip_version": 101,
            "accel_type": 19,
            "event_ms": 1641344460000,
            "release_stage": 100,
            "date": "2022-01-05",
            "label_type": 10,
            "label_source": 1,
            "in_dismissed_states": 0,
            "in_recognition_states": 0,
            "in_coaching_states": 0,
            "in_triage_states": 1
          },
          {
            "org_id": 123,
            "device_id": 1,
            "driver_id": 1,
            "trip_start_ms": 1641343592000,
            "trip_end_ms": 1641361592000,
            "trip_version": 101,
            "accel_type": 2,
            "event_ms": 1641344460000,
            "release_stage": 100,
            "date": "2022-01-05",
            "label_type": 17,
            "label_source": 1,
            "in_dismissed_states": 0,
            "in_recognition_states": 0,
            "in_coaching_states": 1,
            "in_triage_states": 0
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 123,
          "device_id": 1,
          "driver_id": 1,
          "event_ms": 1641344400000,
          "trip_start_ms": 1641343592000,
          "trip_end_ms": 1641361592000,
          "trip_version": 101,
          "label_type": 10,
          "label_source": 1,
          "in_dismissed_states": 0,
          "in_recognition_states": 0,
          "in_coaching_states": 0,
          "in_triage_states": 1,
          "release_stage": 100,
          "date": "2022-01-05"
        },
        {
          "org_id": 123,
          "device_id": 1,
          "driver_id": 1,
          "event_ms": 1641344460000,
          "trip_start_ms": 1641343592000,
          "trip_end_ms": 1641361592000,
          "trip_version": 101,
          "label_type": 17,
          "label_source": 1,
          "in_dismissed_states": 0,
          "in_recognition_states": 0,
          "in_coaching_states": 1,
          "in_triage_states": 0,
          "release_stage": 100,
          "date": "2022-01-05"
        }
      ]
    }
  ]
}

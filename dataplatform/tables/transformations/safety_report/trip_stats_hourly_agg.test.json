{
  "test_cases": [
    {
      "label": "[See Commit Msg for Full Details] Scenario 1: Two trips within the same hour and the same driver but two different vehicles; expect 2 vehicle rows and 1 aggregated driver row.",
      "parameters": {
        "start_date": " '2022-01-04' ",
        "end_date": " '2022-01-07' "
      },
      "input_data": {
        "safety_report.trip_speeding": [
          {
            "org_id": 123,
            "device_id": 10,
            "driver_id": 20,
            "start_ms": 1641390000000,
            "end_ms": 1641391100000,
            "version": 101,
            "date": "2022-01-05",

            "not_speeding_count": 10,
            "light_speeding_count": 1,
            "moderate_speeding_count": 2,
            "heavy_speeding_count": 3,
            "severe_speeding_count": 4,
            "not_speeding_ms": 100,
            "light_speeding_ms": 200,
            "moderate_speeding_ms": 300,
            "heavy_speeding_ms": 400,
            "severe_speeding_ms": 500,
            "engine_idle_ms": 500,
            "distance_meters": 500,
            "driving_time_ms": 1000,
            "seatbelt_reporting_present_ms": 1000,
            "seatbelt_unbuckled_ms": 1000
          },
          {
            "org_id": 123,
            "device_id": 11,
            "driver_id": 20,
            "start_ms": 1641389000000,
            "end_ms": 1641390000000,
            "version": 101,
            "date": "2022-01-05",

            "not_speeding_count": 100,
            "light_speeding_count": 10,
            "moderate_speeding_count": 20,
            "heavy_speeding_count": 30,
            "severe_speeding_count": 40,
            "not_speeding_ms": 1000,
            "light_speeding_ms": 2000,
            "moderate_speeding_ms": 3000,
            "heavy_speeding_ms": 4000,
            "severe_speeding_ms": 5000,
            "engine_idle_ms": 5000,
            "distance_meters": 5000,
            "driving_time_ms": 10000,
            "seatbelt_reporting_present_ms": 10000,
            "seatbelt_unbuckled_ms": 10000
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 123,
          "object_id": 10,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 10,
          "light_speeding_count": 1,
          "moderate_speeding_count": 2,
          "heavy_speeding_count": 3,
          "severe_speeding_count": 4,
          "not_speeding_ms": 100,
          "light_speeding_ms": 200,
          "moderate_speeding_ms": 300,
          "heavy_speeding_ms": 400,
          "severe_speeding_ms": 500,
          "engine_idle_ms": 500,
          "distance_meters": 500,
          "driving_time_ms": 1000,
          "seatbelt_reporting_present_ms": 1000,
          "seatbelt_unbuckled_ms": 1000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 11,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 100,
          "light_speeding_count": 10,
          "moderate_speeding_count": 20,
          "heavy_speeding_count": 30,
          "severe_speeding_count": 40,
          "not_speeding_ms": 1000,
          "light_speeding_ms": 2000,
          "moderate_speeding_ms": 3000,
          "heavy_speeding_ms": 4000,
          "severe_speeding_ms": 5000,
          "engine_idle_ms": 5000,
          "distance_meters": 5000,
          "driving_time_ms": 10000,
          "seatbelt_reporting_present_ms": 10000,
          "seatbelt_unbuckled_ms": 10000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 20,
          "object_type": 5,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 2,
          "not_speeding_count": 110,
          "light_speeding_count": 11,
          "moderate_speeding_count": 22,
          "heavy_speeding_count": 33,
          "severe_speeding_count": 44,
          "not_speeding_ms": 1100,
          "light_speeding_ms": 2200,
          "moderate_speeding_ms": 3300,
          "heavy_speeding_ms": 4400,
          "severe_speeding_ms": 5500,
          "engine_idle_ms": 5500,
          "distance_meters": 5500,
          "driving_time_ms": 11000,
          "seatbelt_reporting_present_ms": 11000,
          "seatbelt_unbuckled_ms": 11000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        }
      ]
    },
    {
      "label": "[See Commit Msg for Full Details] Scenario 2: A driver who has three trips in the same day (first two trips ended at 1pm and the third trip ended at 2pm).",
      "parameters": {
        "start_date": " '2022-01-04' ",
        "end_date": " '2022-01-07' "
      },
      "input_data": {
        "safety_report.trip_speeding": [
          {
            "org_id": 123,
            "device_id": 10,
            "driver_id": 20,
            "start_ms": 1641388800000,
            "end_ms": 1641389400000,
            "version": 101,
            "date": "2022-01-05",

            "not_speeding_count": 10,
            "light_speeding_count": 1,
            "moderate_speeding_count": 2,
            "heavy_speeding_count": 3,
            "severe_speeding_count": 4,
            "not_speeding_ms": 100,
            "light_speeding_ms": 200,
            "moderate_speeding_ms": 300,
            "heavy_speeding_ms": 400,
            "severe_speeding_ms": 500,
            "engine_idle_ms": 500,
            "distance_meters": 500,
            "driving_time_ms": 1000,
            "seatbelt_reporting_present_ms": 1000,
            "seatbelt_unbuckled_ms": 1000
          },
          {
            "org_id": 123,
            "device_id": 10,
            "driver_id": 20,
            "start_ms": 1641389400000,
            "end_ms": 1641390600000,
            "version": 101,
            "date": "2022-01-05",

            "not_speeding_count": 100,
            "light_speeding_count": 10,
            "moderate_speeding_count": 20,
            "heavy_speeding_count": 30,
            "severe_speeding_count": 40,
            "not_speeding_ms": 1000,
            "light_speeding_ms": 2000,
            "moderate_speeding_ms": 3000,
            "heavy_speeding_ms": 4000,
            "severe_speeding_ms": 5000,
            "engine_idle_ms": 5000,
            "distance_meters": 5000,
            "driving_time_ms": 10000,
            "seatbelt_reporting_present_ms": 10000,
            "seatbelt_unbuckled_ms": 10000
          },
          {
            "org_id": 123,
            "device_id": 10,
            "driver_id": 20,
            "start_ms": 1641390600000,
            "end_ms": 1641391200000,
            "version": 101,
            "date": "2022-01-05",

            "not_speeding_count": 50,
            "light_speeding_count": 5,
            "moderate_speeding_count": 10,
            "heavy_speeding_count": 15,
            "severe_speeding_count": 20,
            "not_speeding_ms": 500,
            "light_speeding_ms": 1000,
            "moderate_speeding_ms": 1500,
            "heavy_speeding_ms": 2000,
            "severe_speeding_ms": 2500,
            "engine_idle_ms": 2500,
            "distance_meters": 2500,
            "driving_time_ms": 5000,
            "seatbelt_reporting_present_ms": 5000,
            "seatbelt_unbuckled_ms": 5000
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 123,
          "object_id": 10,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 2,
          "not_speeding_count": 110,
          "light_speeding_count": 11,
          "moderate_speeding_count": 22,
          "heavy_speeding_count": 33,
          "severe_speeding_count": 44,
          "not_speeding_ms": 1100,
          "light_speeding_ms": 2200,
          "moderate_speeding_ms": 3300,
          "heavy_speeding_ms": 4400,
          "severe_speeding_ms": 5500,
          "engine_idle_ms": 5500,
          "distance_meters": 5500,
          "driving_time_ms": 11000,
          "seatbelt_reporting_present_ms": 11000,
          "seatbelt_unbuckled_ms": 11000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 20,
          "object_type": 5,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 2,
          "not_speeding_count": 110,
          "light_speeding_count": 11,
          "moderate_speeding_count": 22,
          "heavy_speeding_count": 33,
          "severe_speeding_count": 44,
          "not_speeding_ms": 1100,
          "light_speeding_ms": 2200,
          "moderate_speeding_ms": 3300,
          "heavy_speeding_ms": 4400,
          "severe_speeding_ms": 5500,
          "engine_idle_ms": 5500,
          "distance_meters": 5500,
          "driving_time_ms": 11000,
          "seatbelt_reporting_present_ms": 11000,
          "seatbelt_unbuckled_ms": 11000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 10,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 14:00:00",

          "trip_count": 1,
          "not_speeding_count": 50,
          "light_speeding_count": 5,
          "moderate_speeding_count": 10,
          "heavy_speeding_count": 15,
          "severe_speeding_count": 20,
          "not_speeding_ms": 500,
          "light_speeding_ms": 1000,
          "moderate_speeding_ms": 1500,
          "heavy_speeding_ms": 2000,
          "severe_speeding_ms": 2500,
          "engine_idle_ms": 2500,
          "distance_meters": 2500,
          "driving_time_ms": 5000,
          "seatbelt_reporting_present_ms": 5000,
          "seatbelt_unbuckled_ms": 5000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 20,
          "object_type": 5,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 14:00:00",

          "trip_count": 1,
          "not_speeding_count": 50,
          "light_speeding_count": 5,
          "moderate_speeding_count": 10,
          "heavy_speeding_count": 15,
          "severe_speeding_count": 20,
          "not_speeding_ms": 500,
          "light_speeding_ms": 1000,
          "moderate_speeding_ms": 1500,
          "heavy_speeding_ms": 2000,
          "severe_speeding_ms": 2500,
          "engine_idle_ms": 2500,
          "distance_meters": 2500,
          "driving_time_ms": 5000,
          "seatbelt_reporting_present_ms": 5000,
          "seatbelt_unbuckled_ms": 5000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        }
      ]
    },
    {
      "label": "Scenario 3: Outward-only cameras and inward-outward cameras have correct distance and driving time metrics",
      "parameters": {
        "start_date": " '2022-01-04' ",
        "end_date": " '2022-01-07' "
      },
      "input_data": {
        "safety_report.trip_speeding": [
          {
            "org_id": 123,
            "device_id": 10,
            "driver_id": 20,
            "start_ms": 1641390000000,
            "end_ms": 1641391100000,
            "version": 101,
            "date": "2022-01-05",
            "has_outward_camera": 1,
            "has_inward_outward_camera": 0,

            "not_speeding_count": 10,
            "light_speeding_count": 1,
            "moderate_speeding_count": 2,
            "heavy_speeding_count": 3,
            "severe_speeding_count": 4,
            "not_speeding_ms": 100,
            "light_speeding_ms": 200,
            "moderate_speeding_ms": 300,
            "heavy_speeding_ms": 400,
            "severe_speeding_ms": 500,
            "engine_idle_ms": 500,
            "distance_meters": 500,
            "driving_time_ms": 1000,
            "seatbelt_reporting_present_ms": 1000,
            "seatbelt_unbuckled_ms": 1000
          },
          {
            "org_id": 123,
            "device_id": 11,
            "driver_id": 20,
            "start_ms": 1641389000000,
            "end_ms": 1641390000000,
            "version": 101,
            "date": "2022-01-05",
            "has_outward_camera": 0,
            "has_inward_outward_camera": 1,

            "not_speeding_count": 100,
            "light_speeding_count": 10,
            "moderate_speeding_count": 20,
            "heavy_speeding_count": 30,
            "severe_speeding_count": 40,
            "not_speeding_ms": 1000,
            "light_speeding_ms": 2000,
            "moderate_speeding_ms": 3000,
            "heavy_speeding_ms": 4000,
            "severe_speeding_ms": 5000,
            "engine_idle_ms": 5000,
            "distance_meters": 5000,
            "driving_time_ms": 10000,
            "seatbelt_reporting_present_ms": 10000,
            "seatbelt_unbuckled_ms": 10000
          },
          {
            "org_id": 123,
            "device_id": 12,
            "driver_id": 21,
            "start_ms": 1641390000000,
            "end_ms": 1641391100000,
            "version": 101,
            "date": "2022-01-05",
            "has_outward_camera": 0,
            "has_inward_outward_camera": 0,

            "not_speeding_count": 20,
            "light_speeding_count": 2,
            "moderate_speeding_count": 4,
            "heavy_speeding_count": 6,
            "severe_speeding_count": 8,
            "not_speeding_ms": 200,
            "light_speeding_ms": 400,
            "moderate_speeding_ms": 600,
            "heavy_speeding_ms": 800,
            "severe_speeding_ms": 1000,
            "engine_idle_ms": 1000,
            "distance_meters": 1000,
            "driving_time_ms": 2000,
            "seatbelt_reporting_present_ms": 2000,
            "seatbelt_unbuckled_ms": 2000
          }
        ]
      },
      "expected_data": [
        {
          "org_id": 123,
          "object_id": 10,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 10,
          "light_speeding_count": 1,
          "moderate_speeding_count": 2,
          "heavy_speeding_count": 3,
          "severe_speeding_count": 4,
          "not_speeding_ms": 100,
          "light_speeding_ms": 200,
          "moderate_speeding_ms": 300,
          "heavy_speeding_ms": 400,
          "severe_speeding_ms": 500,
          "engine_idle_ms": 500,
          "distance_meters": 500,
          "driving_time_ms": 1000,
          "seatbelt_reporting_present_ms": 1000,
          "seatbelt_unbuckled_ms": 1000,
          "outward_camera_distance_meters": 500,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 1000,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 11,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 100,
          "light_speeding_count": 10,
          "moderate_speeding_count": 20,
          "heavy_speeding_count": 30,
          "severe_speeding_count": 40,
          "not_speeding_ms": 1000,
          "light_speeding_ms": 2000,
          "moderate_speeding_ms": 3000,
          "heavy_speeding_ms": 4000,
          "severe_speeding_ms": 5000,
          "engine_idle_ms": 5000,
          "distance_meters": 5000,
          "driving_time_ms": 10000,
          "seatbelt_reporting_present_ms": 10000,
          "seatbelt_unbuckled_ms": 10000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 5000,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 10000
        },
        {
          "org_id": 123,
          "object_id": 12,
          "object_type": 1,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 20,
          "light_speeding_count": 2,
          "moderate_speeding_count": 4,
          "heavy_speeding_count": 6,
          "severe_speeding_count": 8,
          "not_speeding_ms": 200,
          "light_speeding_ms": 400,
          "moderate_speeding_ms": 600,
          "heavy_speeding_ms": 800,
          "severe_speeding_ms": 1000,
          "engine_idle_ms": 1000,
          "distance_meters": 1000,
          "driving_time_ms": 2000,
          "seatbelt_reporting_present_ms": 2000,
          "seatbelt_unbuckled_ms": 2000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        },
        {
          "org_id": 123,
          "object_id": 20,
          "object_type": 5,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 2,
          "not_speeding_count": 110,
          "light_speeding_count": 11,
          "moderate_speeding_count": 22,
          "heavy_speeding_count": 33,
          "severe_speeding_count": 44,
          "not_speeding_ms": 1100,
          "light_speeding_ms": 2200,
          "moderate_speeding_ms": 3300,
          "heavy_speeding_ms": 4400,
          "severe_speeding_ms": 5500,
          "engine_idle_ms": 5500,
          "distance_meters": 5500,
          "driving_time_ms": 11000,
          "seatbelt_reporting_present_ms": 11000,
          "seatbelt_unbuckled_ms": 11000,
          "outward_camera_distance_meters": 500,
          "inward_outward_camera_distance_meters": 5000,
          "outward_camera_driving_time_ms": 1000,
          "inward_outward_camera_driving_time_ms": 10000
        },
        {
          "org_id": 123,
          "object_id": 21,
          "object_type": 5,
          "version": 101,
          "date": "2022-01-05",
          "interval_start": "2022-01-05 13:00:00",

          "trip_count": 1,
          "not_speeding_count": 20,
          "light_speeding_count": 2,
          "moderate_speeding_count": 4,
          "heavy_speeding_count": 6,
          "severe_speeding_count": 8,
          "not_speeding_ms": 200,
          "light_speeding_ms": 400,
          "moderate_speeding_ms": 600,
          "heavy_speeding_ms": 800,
          "severe_speeding_ms": 1000,
          "engine_idle_ms": 1000,
          "distance_meters": 1000,
          "driving_time_ms": 2000,
          "seatbelt_reporting_present_ms": 2000,
          "seatbelt_unbuckled_ms": 2000,
          "outward_camera_distance_meters": 0,
          "inward_outward_camera_distance_meters": 0,
          "outward_camera_driving_time_ms": 0,
          "inward_outward_camera_driving_time_ms": 0
        }
      ]
    }
  ]
}

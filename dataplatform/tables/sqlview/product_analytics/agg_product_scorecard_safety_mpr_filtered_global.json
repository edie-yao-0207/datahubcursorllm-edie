{
  "view": "agg_product_scorecard_safety_mpr_filtered_global",
  "owner": "DataEngineering",
  "description": "This view contains the latest safety MPR metrics data",
  "database": "product_analytics",
  "regions": ["us-west-2"],
  "schema": [
    { "name": "date", "type": "string", "description": "Date partition" },
    { "name": "period_start", "type": "string", "description": "Start of period" },
    { "name": "period_end", "type": "string", "description": "End of period" },
    { "name": "sam_number", "type": "string", "description": "SAM number for set of orgs" },
    { "name": "account_size_segment", "type": "string", "description": "Account size segment of grouping" },
    { "name": "account_arr_segment", "type": "string", "description": "Account ARR segment of grouping" },
    { "name": "account_billing_country", "type": "string", "description": "Billing country of the account" },
    { "name": "account_industry", "type": "string", "description": "Account industry of grouping" },
    { "name": "industry_vertical", "type": "string", "description": "Industry vertical of grouping" },
    {
      "name": "is_paid_safety_customer",
      "type": "boolean",
      "description": "Whether the SAM has Safety licenses or not"
    },
    {
      "name": "is_paid_telematics_customer",
      "type": "boolean",
      "description": "Whether the SAM has Telematics licenses or not"
    },
    { "name": "is_paid_stce_customer", "type": "boolean", "description": "Whether the SAM has STCE licenses or not" },
    { "name": "account_csm_email", "type": "string", "description": "CSM email of the account" },
    { "name": "account_name", "type": "string", "description": "Name of the account" },
    { "name": "account_id", "type": "string", "description": "ID of the account" },
    { "name": "account_created_date", "type": "string", "description": "Creation date of the account" },
    {
      "name": "dual_facing_cam",
      "type": "boolean",
      "description": "Whether account has at least one dual-facing cam or not"
    },
    {
      "name": "account_renewal_12mo",
      "type": "boolean",
      "description": "Whether account has 50% of their licenses up for renewal within the next 12 months or not"
    },
    {
      "name": "total_drivers",
      "type": "long",
      "description": "Total number of drivers in the account"
    },
    {
      "name": "total_drivers_using_app_month",
      "type": "long",
      "description": "Total number of drivers who have used the Mobile App in the last month"
    },
    {
      "name": "total_drivers_using_app",
      "type": "long",
      "description": "Total number of drivers who have used the Mobile App"
    },
    {
      "name": "assigned_trainings",
      "type": "long",
      "description": "Total number of assigned trainings in the account that were initiated in the month"
    },
    {
      "name": "total_drivers_assigned_training",
      "type": "long",
      "description": "Total number of drivers who were assigned to training events in the account that were initiated in the month"
    },
    {
      "name": "total_drivers_completing_training_on_time",
      "type": "long",
      "description": "Total number of drivers who completed training events in the account that were initiated in the month"
    },
    {
      "name": "drivers_completing_manager_led_coaching",
      "type": "long",
      "description": "Total number of drivers who completed coaching sessions connected to a manager-led coaching event in the account that were initiated in the month"
    },
    {
      "name": "drivers_completing_self_coaching",
      "type": "long",
      "description": "Total number of drivers who completed coaching sessions connected to a self coaching event in the account that were initiated in the month"
    },
    {
      "name": "drivers_completing_coaching",
      "type": "long",
      "description": "Total number of drivers who completed coaching sessions in the account that were initiated in the month"
    },
    {
      "name": "miles",
      "type": "double",
      "description": "Total number of miles covered by trips for devices enabled for at least one event type in the account for the month"
    }
  ],
  "dependencies": [
    {
      "external": true,
      "dbname": "product_analytics",
      "tablename": "agg_product_scorecard_safety_mpr_global_revised_monthly",
      "type": "table"
    }
  ]
}

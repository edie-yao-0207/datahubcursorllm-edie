{
  "view": "driver_risk_factors",
  "owner": "DataEngineering",
  "description": "This view contains the latest driver risk classification per day including all features and their contributions to the risk score as SHAP values.",
  "database": "product_analytics",
  "regions": ["us-west-2"],
  "schema": [
    {
      "name": "date",
      "type": "string",
      "description": "The date of the driver risk assessment"
    },
    {
      "name": "org_id",
      "type": "long",
      "description": "Driver's organization ID"
    },
    {
      "name": "driver_id",
      "type": "long",
      "description": "Driver's ID"
    },
    {
      "name": "risk_classification",
      "type": "integer",
      "description": "Risk classification bucket id (1-3) where 1 is low and 3 is high."
    },
    {
      "name": "risk_score",
      "type": "double",
      "description": "Risk score between 0 and 1 determined by driver risk model."
    },
    {
      "name": "overall_risk_level",
      "type": "string",
      "description": "Overall risk level (Low, Medium, High) corresponding to risk_classification"
    },
    {
      "name": "risk_factor_name",
      "type": "string",
      "description": "Name of the risk factor ex: driver_tenure_days, trip_duration_weighted."
    },
    {
      "name": "risk_factor_type_id",
      "type": "integer",
      "description": "Risk factor type id enum, name is sourced from definitions.driver_risk_factor_map."
    },
    {
      "name": "risk_factor_severity",
      "type": "string",
      "description": "Severity of the risk factor (Protective, Low, Medium, High), where Low, Medium, and High denote increased risk and Protective denotes decreased risk."
    },
    {
      "name": "risk_factor_contribution",
      "type": "double",
      "description": "Contribution of the risk factor to the risk score determined by the SHAP value and base value. Range between 0 and 100."
    },
    {
      "name": "factor_rank_overall",
      "type": "integer",
      "nullable": false,
      "description": "Rank of the risk factor overall across protective and non-protective factors."
    },
    {
      "name": "risk_factor_rank",
      "type": "integer",
      "nullable": true,
      "description": "Rank of the risk factor only for non protective factors (severity of Low, Medium, High)."
    },
    {
      "name": "protective_factor_rank",
      "type": "integer",
      "nullable": true,
      "description": "Rank of the protective factor only. Protective factors are factors with severity of Protective."
    }
  ],
  "dependencies": [
    {
      "external": true,
      "dbname": "safetyriskdb_shards",
      "tablename": "driver_risk_v2",
      "type": "table"
    },
    {
      "dbname": "definitions",
      "tablename": "driver_risk_factor_map",
      "type": "table"
    }
  ]
}

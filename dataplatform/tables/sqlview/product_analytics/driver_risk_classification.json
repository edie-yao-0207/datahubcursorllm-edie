{
  "view": "driver_risk_classification",
  "owner": "DataEngineering",
  "description": "This view contains the latest driver risk classification per day including all features and their contributions to the risk score as SHAP values.",
  "database": "product_analytics",
  "regions": ["us-west-2"],
  "schema": [
    {
      "name": "date",
      "type": "date",
      "description": "The date of the driver risk assessment"
    },
    {
      "name": "org_id",
      "type": "long",
      "description": "Driver's organization ID"
    },
    {
      "name": "driver_id",
      "type": "long",
      "description": "Driver's ID"
    },
    {
      "name": "pipeline_version",
      "type": "string",
      "description": "Version of the ML pipeline used for risk classification"
    },
    {
      "name": "process_uuid",
      "type": "string",
      "description": "Unique identifier for the processing job that generated this result"
    },
    {
      "name": "risk_score",
      "type": "double",
      "description": "Numerical risk score assigned to the driver from the risk model between 0 and 1"
    },
    {
      "name": "classification",
      "type": "string",
      "description": "Risk classification category (e.g., Low, Medium, High)"
    },
    {
      "name": "origin_service",
      "type": "string",
      "description": "The service that originated the risk assessment"
    },
    {
      "name": "timestamp",
      "type": "timestamp",
      "description": "Timestamp when the risk assessment was created"
    },
    {
      "name": "trip_date",
      "type": "string",
      "description": "The date of the trip"
    },
    {
      "name": "base_value",
      "type": "double",
      "description": "The base value (average model output from the explainer module) to support SHAP value interpretation"
    },
    {
      "name": "record_hash_key",
      "type": "string",
      "description": "Hash key for record deduplication"
    },
    {
      "name": "trip_duration_weighted",
      "type": "string",
      "description": "Trip duration weighted over 1d, 30d, 60d."
    },
    {
      "name": "n_org_vg_devices",
      "type": "string",
      "description": "Number of organization vehicle gateway devices active in past 28 days."
    },
    {
      "name": "over_speed_limit_mins_60d",
      "type": "string",
      "description": "Minutes over speed limit in last 60 days."
    },
    {
      "name": "driver_tenure_days",
      "type": "string",
      "description": "Driver tenure in days."
    },
    {
      "name": "distracted_driving_60d",
      "type": "string",
      "description": "Distracted driving events in last 60 days."
    },
    {
      "name": "trip_count_below_freezing_60d",
      "type": "string",
      "description": "Number of trips below freezing in last 60 days."
    },
    {
      "name": "trip_count_over_35_60d",
      "type": "string",
      "description": "Number of trips over 35Â°C in last 60 days."
    },
    {
      "name": "proportion_urban_driving_environment_locations_60d",
      "type": "string",
      "description": "Proportion of urban driving environment locations in last 60 days."
    },
    {
      "name": "primary_max_weight_lbs",
      "type": "string",
      "description": "Primary vehicle maximum weight in pounds or -1 if not available."
    },
    {
      "name": "hos_violation_count_60d",
      "type": "string",
      "description": "Hours of service violation count in last 60 days."
    },
    {
      "name": "moderate_speeding_mins_60d",
      "type": "string",
      "description": "Minutes of moderate speeding in last 60 days."
    },
    {
      "name": "mobile_usage_violations_60d",
      "type": "string",
      "description": "Mobile device usage violations in last 60 days."
    },
    {
      "name": "max_speed_weighted",
      "type": "string",
      "description": "Weighted maximum speed over 1d, 30d, 60d."
    },
    {
      "name": "proportion_rural_driving_environment_locations_60d",
      "type": "string",
      "description": "Proportion of rural driving environment locations in last 60 days."
    },
    {
      "name": "proportion_roadway_service_60d",
      "type": "string",
      "description": "Proportion of service roadway driving in last 60 days."
    },
    {
      "name": "harsh_braking_60d",
      "type": "string",
      "description": "Harsh braking events in last 60 days."
    },
    {
      "name": "proportion_mixed_driving_environment_locations_60d",
      "type": "string",
      "description": "Proportion of mixed driving environment locations in last 60 days."
    },
    {
      "name": "proportion_roadway_residential_60d",
      "type": "string",
      "description": "Proportion of residential roadway driving in last 60 days."
    },
    {
      "name": "light_speeding_mins_60d",
      "type": "string",
      "description": "Minutes of light speeding in last 60 days."
    },
    {
      "name": "proportion_roadway_motorway_60d",
      "type": "string",
      "description": "Proportion of motorway/highway driving in last 60 days."
    },
    {
      "name": "trip_ended_at_night_weighted",
      "type": "string",
      "description": "Weighted proportion of trips ending at night over 1d, 30d, 60d."
    },
    {
      "name": "is_eld_relevant_device",
      "type": "string",
      "description": "Whether device is ELD-relevant."
    },
    {
      "name": "trip_count_60d",
      "type": "string",
      "description": "Total trip count in last 60 days feature contribution"
    },
    {
      "name": "proportion_roadway_trunk_60d",
      "type": "string",
      "description": "Proportion of trunk road driving in last 60 days."
    },
    {
      "name": "proportion_roadway_secondary_60d",
      "type": "string",
      "description": "Proportion of secondary road driving in last 60 days."
    },
    {
      "name": "proportion_roadway_null_60d",
      "type": "string",
      "description": "Proportion of unclassified roadway driving in last 60 days."
    },
    {
      "name": "trip_ended_in_morning_60d",
      "type": "string",
      "description": "Number of trips ending in morning in last 60 days."
    },
    {
      "name": "severe_speeding_mins_60d",
      "type": "string",
      "description": "Minutes of severe speeding in last 60 days."
    },
    {
      "name": "coached_events_60d",
      "type": "string",
      "description": "Coached safety events in last 60 days."
    },
    {
      "name": "total_events_weighted",
      "type": "string",
      "description": "Weighted total safety events over 1d, 30d, 60d."
    },
    {
      "name": "speeding_60d",
      "type": "string",
      "description": "Total speeding events in last 60 days."
    },
    {
      "name": "labelled_crash_count_prev_1_year",
      "type": "string",
      "description": "Labeled crash count in last year."
    },
    {
      "name": "proportion_roadway_tertiary_60d",
      "type": "string",
      "description": "Proportion of tertiary road driving in last 60 days."
    },
    {
      "name": "proportion_roadway_unclassified_60d",
      "type": "string",
      "description": "Proportion of unclassified road driving in last 60 days."
    },
    {
      "name": "rolling_stop_60d",
      "type": "string",
      "description": "Rolling stop violations in last 60 days."
    },
    {
      "name": "proportion_roadway_primary_60d",
      "type": "string",
      "description": "Proportion of primary road driving in last 60 days."
    },
    {
      "name": "drowsiness_60d",
      "type": "string",
      "description": "Drowsiness detection events in last 60 days."
    },
    {
      "name": "harsh_turns_60d",
      "type": "string",
      "description": "Harsh turning events in last 60 days."
    },
    {
      "name": "proportion_roadway_living_street_60d",
      "type": "string",
      "description": "Proportion of living street driving in last 60 days."
    },
    {
      "name": "following_distance_60d",
      "type": "string",
      "description": "Following distance violations in last 60 days."
    },
    {
      "name": "speeding_ratio_weighted",
      "type": "string",
      "description": "Weighted speeding ratio over 1d, 30d, 60d."
    },
    {
      "name": "heavy_speeding_mins_60d",
      "type": "string",
      "description": "Minutes of heavy speeding in last 60 days."
    },
    {
      "name": "crashes_60d",
      "type": "string",
      "description": "Crash events in last 60 days."
    },
    {
      "name": "trip_distance_miles_60d",
      "type": "string",
      "description": "Total trip distance in miles for last 60 days."
    },
    {
      "name": "lane_departure_60d",
      "type": "string",
      "description": "Lane departure events in last 60 days."
    },
    {
      "name": "virtual_coaching_60d",
      "type": "string",
      "description": "Virtual coaching events in last 60 days."
    },
    {
      "name": "harsh_accelerations_60d",
      "type": "string",
      "description": "Harsh acceleration events in last 60 days."
    }
  ],
  "dependencies": [
    {
      "external": true,
      "dbname": "datastreams",
      "tablename": "driver_trip_risk_score_v2_inference_results",
      "type": "table"
    }
  ]
}

{
  "name": "vg_device_health_tables-na",
  "email_notifications": {
    "on_failure": ["vg-release-metrics-pi-aaaalc4nyooyfyfswpeimh7nme@samsara.org.slack.com"],
    "no_alert_for_skipped_runs": false
  },
  "timeout_seconds": 0,
  "max_concurrent_runs": 1,
  "tasks": [
    {
      "task_key": "health_metrics_vg_gps_uptime",
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/health_metrics_vg_gps_uptime",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg_modi_days",
      "depends_on": [
        {
          "task_key": "vg_modi_attached_ranges"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg_modi_days",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg3x_daily_summary",
      "depends_on": [
        {
          "task_key": "dataprep_vg_modi_days"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg3x_daily_summary",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_trip_diag_resets",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_trip_diag_resets",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_cpu_usage",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_cpu_usage",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_memory_usage",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_memory_usage",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg3x_gps_fix_times",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg3x_gps_fix_times",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg_daily_compromised_batts",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg_daily_compromised_batts",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "spi_uptime",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/spi_uptime",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_daily_health_metrics",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        },
        {
          "task_key": "vg3x_gps_fix_times"
        },
        {
          "task_key": "spi_uptime"
        },
        {
          "task_key": "vg_memory_usage"
        },
        {
          "task_key": "dataprep_vg_daily_compromised_batts"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_daily_health_metrics",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "chrisfiore_3dpowerstate-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/chrisfiore_3dpowerstate-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_daily_anomalies-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_daily_anomalies-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg3x_network_operator_time-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg3x_network_operator_time-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_harsh_events-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_harsh_events-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "fleetfwhealth_vg34_flash_devices-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/fleetfwhealth_vg34_flash_devices-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_daily_mcu_events-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_daily_mcu_events-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "cumulative_disconnectivity_by_device_vg3x-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/cumulative_disconnectivity_by_device_vg3x-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_trip_distances",
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_trip_distances",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_daily_health_metrics_extended",
      "depends_on": [
        {
          "task_key": "vg_trip_diag_resets"
        },
        {
          "task_key": "vg3x_daily_summary"
        },
        {
          "task_key": "health_metrics_vg_gps_uptime"
        },
        {
          "task_key": "dataprep_trip_distances"
        },
        {
          "task_key": "vg_cpu_usage"
        },
        {
          "task_key": "vg_tacho_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_daily_health_metrics_extended",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_tacho_metrics",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_tacho_metrics",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_cable_id_cache_metrics-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vgapps/vg_cable_id_cache_metrics",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_low_battery_and_wake_reasons-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vgapps/vg_low_battery_and_wake_reasons",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_release_metrics",
      "depends_on": [
        {
          "task_key": "vg_modi_attached_ranges"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_firmware.vg_release_metrics",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_modi_attached_ranges",
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_modi_attached_ranges",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg_daily_internal_batteries-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg_daily_internal_batteries-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg3x_att_daily_data_usage-na",
      "depends_on": [
        {
          "task_key": "vg3x_daily_summary"
        },
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg3x_att_daily_data_usage-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_mcuevents_by_day-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_mcu_events-na"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_mcuevents_by_day-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg3x_harsh_events_by_day-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_harsh_events-na"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg3x_harsh_events_by_day-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_health_metrics_by_day-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_health_metrics_by_day-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {},
      "description": ""
    },
    {
      "task_key": "dataprep_vg3x_anomaly_events_by_day-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_anomalies-na"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_anomaly_events_by_day-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_health_metrics_by_day_extended-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics_extended"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_health_metrics_by_day_extended-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_flash_reset_by_day-na",
      "depends_on": [
        {
          "task_key": "fleetfwhealth_vg34_flash_devices-na"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_flash_reset_by_day-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "dataprep_vg3x_avg_sim_switches-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/dataprep_vg3x_avg_sim_switches-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    },
    {
      "task_key": "vg_wake_reason_distributions-na",
      "depends_on": [
        {
          "task_key": "dataprep_vg3x_daily_health_metrics"
        }
      ],
      "run_if": "ALL_SUCCESS",
      "notebook_task": {
        "notebook_path": "/backend/firmware/vg/vg_wake_reason_distributions-na",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "timeout_seconds": 0,
      "email_notifications": {}
    }
  ],
  "job_clusters": [
    {
      "job_cluster_key": "vg_device_health_tables-na_job_cluster",
      "new_cluster": {
        "cluster_name": "",
        "spark_version": "15.4.x-scala2.12",
        "spark_conf": {
          "spark.databricks.sql.initial.catalog.name": "default",
          "databricks.loki.fileStatusCache.enabled": "false",
          "spark.hadoop.databricks.loki.fileStatusCache.enabled": "false",
          "spark.databricks.scan.modTimeCheck.enabled": "false",
          "spark.samsara.partitionFilterRule.enabled": "false",
          "spark.sql.warehouse.dir": "s3://samsara-databricks-playground/warehouse/",
          "spark.databricks.service.server.enabled": "true",
          "spark.hadoop.google.cloud.auth.service.account.enable": "true",
          "spark.driver.maxResultSize": "8000000000",
          "spark.hadoop.google.cloud.auth.service.account.json.keyfile": "/databricks/samsara-data-5142c7cd3ba2.json",
          "spark.databricks.delta.optimizeWrite.enabled": "true",
          "spark.databricks.delta.autoCompact.enabled": "true",
          "spark.databricks.delta.properties.defaults.logRetentionDuration": "INTERVAL 30 DAYS",
          "spark.hadoop.fs.s3a.canned.acl": "BucketOwnerFullControl",
          "spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes": "64MB",
          "viewsEnabled": "true",
          "credentialsFile": "/databricks/samsara-data-5142c7cd3ba2.json",
          "spark.sql.adaptive.skewJoin.skewedPartitionFactor": "2",
          "spark.hadoop.fs.s3a.acl.default": "BucketOwnerFullControl",
          "spark.hadoop.fs.gs.project.id": "samsara-data",
          "spark.databricks.delta.properties.defaults.checkpointRetentionDuration": "INTERVAL 30 DAYS",
          "viewMaterializationDataset": "spark_view_materialization",
          "spark.databricks.delta.stalenessLimit": "15m",
          "spark.databricks.delta.history.metricsEnabled": "true",
          "spark.sql.extensions": "com.samsara.dataplatform.sparkrules.Extension",
          "spark.sql.sources.default": "delta",
          "temporaryGcsBucket": "samsara-bigquery-spark-connector"
        },
        "aws_attributes": {
          "first_on_demand": 1,
          "availability": "SPOT_WITH_FALLBACK",
          "zone_id": "us-west-2b",
          "instance_profile_arn": "arn:aws:iam::492164655156:instance-profile/dataanalytics-cluster",
          "spot_bid_price_percent": 100,
          "ebs_volume_count": 0
        },
        "node_type_id": "rd-fleet.4xlarge",
        "driver_node_type_id": "rd-fleet.4xlarge",
        "custom_tags": {
          "samsara:product-group": "AIAndData",
          "samsara:team": "dataanalytics",
          "samsara:service": "databricksjobcluster-dataanalytics",
          "samsara:rnd-allocation": "1"
        },
        "cluster_log_conf": {
          "s3": {
            "destination": "s3://samsara-databricks-cluster-logs/dataanalytics",
            "region": "us-west-2",
            "enable_encryption": true,
            "canned_acl": "bucket-owner-full-control"
          }
        },
        "spark_env_vars": {
          "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
        },
        "enable_elastic_disk": false,
        "policy_id": "E063D86F5F000153",
        "runtime_engine": "STANDARD",
        "num_workers": 8
      }
    }
  ]
}
